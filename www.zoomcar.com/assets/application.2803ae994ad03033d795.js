webpackJsonp([26],{297:function(t,e,n){n(14)(n(700))},298:function(t,e,n){n(14)(n(701))},303:function(t,e,n){n(14)(n(706))},304:function(t,e,n){n(14)(n(707))},700:function(t,e){t.exports="/*!\n * Bootstrap-select v1.6.3 (http://silviomoreto.github.io/bootstrap-select/)\n *\n * Copyright 2013-2014 bootstrap-select\n * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)\n */\n(function ($) {\n  'use strict';\n\n  // Case insensitive search\n  $.expr[':'].icontains = function (obj, index, meta) {\n    return icontains($(obj).text(), meta[3]);\n  };\n\n  // Case and accent insensitive search\n  $.expr[':'].aicontains = function (obj, index, meta) {\n    return icontains($(obj).data('normalizedText') || $(obj).text(), meta[3]);\n  };\n\n  /**\n   * Actual implementation of the case insensitive search.\n   * @access private\n   * @param {String} haystack\n   * @param {String} needle\n   * @returns {boolean}\n   */\n  function icontains(haystack, needle) {\n    return haystack.toUpperCase().indexOf(needle.toUpperCase()) > -1;\n  }\n\n  /**\n   * Remove all diatrics from the given text.\n   * @access private\n   * @param {String} text\n   * @returns {String}\n   */\n  function normalizeToBase(text) {\n    var rExps = [\n      {re: /[\\xC0-\\xC6]/g, ch: \"A\"},\n      {re: /[\\xE0-\\xE6]/g, ch: \"a\"},\n      {re: /[\\xC8-\\xCB]/g, ch: \"E\"},\n      {re: /[\\xE8-\\xEB]/g, ch: \"e\"},\n      {re: /[\\xCC-\\xCF]/g, ch: \"I\"},\n      {re: /[\\xEC-\\xEF]/g, ch: \"i\"},\n      {re: /[\\xD2-\\xD6]/g, ch: \"O\"},\n      {re: /[\\xF2-\\xF6]/g, ch: \"o\"},\n      {re: /[\\xD9-\\xDC]/g, ch: \"U\"},\n      {re: /[\\xF9-\\xFC]/g, ch: \"u\"},\n      {re: /[\\xC7-\\xE7]/g, ch: \"c\"},\n      {re: /[\\xD1]/g, ch: \"N\"},\n      {re: /[\\xF1]/g, ch: \"n\"}\n    ];\n    $.each(rExps, function () {\n      text = text.replace(this.re, this.ch);\n    });\n    return text;\n  }\n\n\n  function htmlEscape(html) {\n    var escapeMap = {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;',\n      '`': '&#x60;'\n    };\n    var source = '(?:' + Object.keys(escapeMap).join('|') + ')',\n        testRegexp = new RegExp(source),\n        replaceRegexp = new RegExp(source, 'g'),\n        string = html == null ? '' : '' + html;\n    return testRegexp.test(string) ? string.replace(replaceRegexp, function (match) {\n      return escapeMap[match];\n    }) : string;\n  }\n\n  var Selectpicker = function (element, options, e) {\n    if (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n\n    this.$element = $(element);\n    this.$newElement = null;\n    this.$button = null;\n    this.$menu = null;\n    this.$lis = null;\n    this.options = options;\n\n    // If we have no title yet, try to pull it from the html title attribute (jQuery doesnt' pick it up as it's not a\n    // data-attribute)\n    if (this.options.title === null) {\n      this.options.title = this.$element.attr('title');\n    }\n\n    //Expose public methods\n    this.val = Selectpicker.prototype.val;\n    this.render = Selectpicker.prototype.render;\n    this.refresh = Selectpicker.prototype.refresh;\n    this.setStyle = Selectpicker.prototype.setStyle;\n    this.selectAll = Selectpicker.prototype.selectAll;\n    this.deselectAll = Selectpicker.prototype.deselectAll;\n    this.destroy = Selectpicker.prototype.remove;\n    this.remove = Selectpicker.prototype.remove;\n    this.show = Selectpicker.prototype.show;\n    this.hide = Selectpicker.prototype.hide;\n\n    this.init();\n  };\n\n  Selectpicker.VERSION = '1.6.3';\n\n  // part of this is duplicated in i18n/defaults-en_US.js. Make sure to update both.\n  Selectpicker.DEFAULTS = {\n    noneSelectedText: 'Nothing selected',\n    noneResultsText: 'No results match',\n    countSelectedText: function (numSelected, numTotal) {\n      return (numSelected == 1) ? \"{0} item selected\" : \"{0} items selected\";\n    },\n    maxOptionsText: function (numAll, numGroup) {\n      var arr = [];\n\n      arr[0] = (numAll == 1) ? 'Limit reached ({n} item max)' : 'Limit reached ({n} items max)';\n      arr[1] = (numGroup == 1) ? 'Group limit reached ({n} item max)' : 'Group limit reached ({n} items max)';\n\n      return arr;\n    },\n    selectAllText: 'Select All',\n    deselectAllText: 'Deselect All',\n    multipleSeparator: ', ',\n    style: 'btn-default',\n    size: 'auto',\n    title: null,\n    selectedTextFormat: 'values',\n    width: false,\n    container: false,\n    hideDisabled: false,\n    showSubtext: false,\n    showIcon: true,\n    showContent: true,\n    dropupAuto: true,\n    header: false,\n    liveSearch: false,\n    actionsBox: false,\n    iconBase: 'glyphicon',\n    tickIcon: 'glyphicon-ok',\n    maxOptions: false,\n    mobile: false,\n    selectOnTab: false,\n    dropdownAlignRight: false,\n    searchAccentInsensitive: false\n  };\n\n  Selectpicker.prototype = {\n\n    constructor: Selectpicker,\n\n    init: function () {\n      var that = this,\n          id = this.$element.attr('id');\n\n      this.$element.hide();\n      this.multiple = this.$element.prop('multiple');\n      this.autofocus = this.$element.prop('autofocus');\n      this.$newElement = this.createView();\n      this.$element.after(this.$newElement);\n      this.$menu = this.$newElement.find('> .dropdown-menu');\n      this.$button = this.$newElement.find('> button');\n      this.$searchbox = this.$newElement.find('input');\n\n      if (this.options.dropdownAlignRight)\n        this.$menu.addClass('dropdown-menu-right');\n\n      if (typeof id !== 'undefined') {\n        this.$button.attr('data-id', id);\n        $('label[for=\"' + id + '\"]').click(function (e) {\n          e.preventDefault();\n          that.$button.focus();\n        });\n      }\n\n      this.checkDisabled();\n      this.clickListener();\n      if (this.options.liveSearch) this.liveSearchListener();\n      this.render();\n      this.liHeight();\n      this.setStyle();\n      this.setWidth();\n      if (this.options.container) this.selectPosition();\n      this.$menu.data('this', this);\n      this.$newElement.data('this', this);\n      if (this.options.mobile) this.mobile();\n    },\n\n    createDropdown: function () {\n      // Options\n      // If we are multiple, then add the show-tick class by default\n      var multiple = this.multiple ? ' show-tick' : '',\n          inputGroup = this.$element.parent().hasClass('input-group') ? ' input-group-btn' : '',\n          autofocus = this.autofocus ? ' autofocus' : '',\n          btnSize = this.$element.parents().hasClass('form-group-lg') ? ' btn-lg' : (this.$element.parents().hasClass('form-group-sm') ? ' btn-sm' : '');\n      // Elements\n      var header = this.options.header ? '<div class=\"popover-title\"><button type=\"button\" class=\"close\" aria-hidden=\"true\">&times;</button>' + this.options.header + '</div>' : '';\n      var searchbox = this.options.liveSearch ? '<div class=\"bs-searchbox\"><input type=\"text\" class=\"input-block-level form-control\" autocomplete=\"off\" /></div>' : '';\n      var actionsbox = this.options.actionsBox ? '<div class=\"bs-actionsbox\">' +\n      '<div class=\"btn-group btn-block\">' +\n      '<button class=\"actions-btn bs-select-all btn btn-sm btn-default\">' +\n      this.options.selectAllText +\n      '</button>' +\n      '<button class=\"actions-btn bs-deselect-all btn btn-sm btn-default\">' +\n      this.options.deselectAllText +\n      '</button>' +\n      '</div>' +\n      '</div>' : '';\n      var drop =\n          '<div class=\"btn-group bootstrap-select' + multiple + inputGroup + '\">' +\n          '<button type=\"button\" class=\"btn dropdown-toggle selectpicker' + btnSize + '\" data-toggle=\"dropdown\"' + autofocus + '>' +\n          '<span class=\"filter-option pull-left\"></span>&nbsp;' +\n          '<span class=\"caret\"></span>' +\n          '</button>' +\n          '<div class=\"dropdown-menu open\">' +\n          header +\n          searchbox +\n          actionsbox +\n          '<ul class=\"dropdown-menu inner selectpicker\" role=\"menu\">' +\n          '</ul>' +\n          '</div>' +\n          '</div>';\n\n      return $(drop);\n    },\n\n    createView: function () {\n      var $drop = this.createDropdown();\n      var $li = this.createLi();\n      $drop.find('ul').append($li);\n      return $drop;\n    },\n\n    reloadLi: function () {\n      //Remove all children.\n      this.destroyLi();\n      //Re build\n      var $li = this.createLi();\n      this.$menu.find('ul').append($li);\n    },\n\n    destroyLi: function () {\n      this.$menu.find('li').remove();\n    },\n\n    createLi: function () {\n      var that = this,\n          _li = [],\n          optID = 0;\n\n      // Helper functions\n      /**\n       * @param content\n       * @param [index]\n       * @param [classes]\n       * @returns {string}\n       */\n      var generateLI = function (content, index, classes) {\n        return '<li' +\n        (typeof classes !== 'undefined' ? ' class=\"' + classes + '\"' : '') +\n        (typeof index !== 'undefined' | null === index ? ' data-original-index=\"' + index + '\"' : '') +\n        '>' + content + '</li>';\n      };\n\n      /**\n       * @param text\n       * @param [classes]\n       * @param [inline]\n       * @param [optgroup]\n       * @returns {string}\n       */\n      var generateA = function (text, classes, inline, optgroup) {\n        var normText = normalizeToBase(htmlEscape(text));\n        return '<a tabindex=\"0\"' +\n        (typeof classes !== 'undefined' ? ' class=\"' + classes + '\"' : '') +\n        (typeof inline !== 'undefined' ? ' style=\"' + inline + '\"' : '') +\n        (typeof optgroup !== 'undefined' ? 'data-optgroup=\"' + optgroup + '\"' : '') +\n        ' data-normalized-text=\"' + normText + '\"' +\n        '>' + text +\n        '<span class=\"' + that.options.iconBase + ' ' + that.options.tickIcon + ' check-mark\"></span>' +\n        '</a>';\n      };\n\n      this.$element.find('option').each(function () {\n        var $this = $(this);\n\n        // Get the class and text for the option\n        var optionClass = $this.attr('class') || '',\n            inline = $this.attr('style'),\n            text = $this.data('content') ? $this.data('content') : $this.html(),\n            subtext = typeof $this.data('subtext') !== 'undefined' ? '<small class=\"muted text-muted\">' + $this.data('subtext') + '</small>' : '',\n            icon = typeof $this.data('icon') !== 'undefined' ? '<span class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></span> ' : '',\n            isDisabled = $this.is(':disabled') || $this.parent().is(':disabled'),\n            index = $this[0].index;\n        if (icon !== '' && isDisabled) {\n          icon = '<span>' + icon + '</span>';\n        }\n\n        if (!$this.data('content')) {\n          // Prepend any icon and append any subtext to the main text.\n          text = icon + '<span class=\"text\">' + text + subtext + '</span>';\n        }\n\n        if (that.options.hideDisabled && isDisabled) {\n          return;\n        }\n\n        if ($this.parent().is('optgroup') && $this.data('divider') !== true) {\n          if ($this.index() === 0) { // Is it the first option of the optgroup?\n            optID += 1;\n\n            // Get the opt group label\n            var label = $this.parent().attr('label');\n            var labelSubtext = typeof $this.parent().data('subtext') !== 'undefined' ? '<small class=\"muted text-muted\">' + $this.parent().data('subtext') + '</small>' : '';\n            var labelIcon = $this.parent().data('icon') ? '<span class=\"' + that.options.iconBase + ' ' + $this.parent().data('icon') + '\"></span> ' : '';\n            label = labelIcon + '<span class=\"text\">' + label + labelSubtext + '</span>';\n\n            if (index !== 0 && _li.length > 0) { // Is it NOT the first option of the select && are there elements in the dropdown?\n              _li.push(generateLI('', null, 'divider'));\n            }\n\n            _li.push(generateLI(label, null, 'dropdown-header'));\n          }\n\n          _li.push(generateLI(generateA(text, 'opt ' + optionClass, inline, optID), index));\n        } else if ($this.data('divider') === true) {\n          _li.push(generateLI('', index, 'divider'));\n        } else if ($this.data('hidden') === true) {\n          _li.push(generateLI(generateA(text, optionClass, inline), index, 'hide is-hidden'));\n        } else {\n          _li.push(generateLI(generateA(text, optionClass, inline), index));\n        }\n      });\n\n      //If we are not multiple, we don't have a selected item, and we don't have a title, select the first element so something is set in the button\n      if (!this.multiple && this.$element.find('option:selected').length === 0 && !this.options.title) {\n        this.$element.find('option').eq(0).prop('selected', true).attr('selected', 'selected');\n      }\n\n      return $(_li.join(''));\n    },\n\n    findLis: function () {\n      if (this.$lis == null) this.$lis = this.$menu.find('li');\n      return this.$lis;\n    },\n\n    /**\n     * @param [updateLi] defaults to true\n     */\n    render: function (updateLi) {\n      var that = this;\n\n      //Update the LI to match the SELECT\n      if (updateLi !== false) {\n        this.$element.find('option').each(function (index) {\n          that.setDisabled(index, $(this).is(':disabled') || $(this).parent().is(':disabled'));\n          that.setSelected(index, $(this).is(':selected'));\n        });\n      }\n\n      this.tabIndex();\n      var notDisabled = this.options.hideDisabled ? ':not([disabled])' : '';\n      var selectedItems = this.$element.find('option:selected' + notDisabled).map(function () {\n        var $this = $(this);\n        var icon = $this.data('icon') && that.options.showIcon ? '<i class=\"' + that.options.iconBase + ' ' + $this.data('icon') + '\"></i> ' : '';\n        var subtext;\n        if (that.options.showSubtext && $this.attr('data-subtext') && !that.multiple) {\n          subtext = ' <small class=\"muted text-muted\">' + $this.data('subtext') + '</small>';\n        } else {\n          subtext = '';\n        }\n        if ($this.data('content') && that.options.showContent) {\n          return $this.data('content');\n        } else if (typeof $this.attr('title') !== 'undefined') {\n          return $this.attr('title');\n        } else {\n          return icon + $this.html() + subtext;\n        }\n      }).toArray();\n\n      //Fixes issue in IE10 occurring when no default option is selected and at least one option is disabled\n      //Convert all the values into a comma delimited string\n      var title = !this.multiple ? selectedItems[0] : selectedItems.join(this.options.multipleSeparator);\n\n      //If this is multi select, and the selectText type is count, the show 1 of 2 selected etc..\n      if (this.multiple && this.options.selectedTextFormat.indexOf('count') > -1) {\n        var max = this.options.selectedTextFormat.split('>');\n        if ((max.length > 1 && selectedItems.length > max[1]) || (max.length == 1 && selectedItems.length >= 2)) {\n          notDisabled = this.options.hideDisabled ? ', [disabled]' : '';\n          var totalCount = this.$element.find('option').not('[data-divider=\"true\"], [data-hidden=\"true\"]' + notDisabled).length,\n              tr8nText = (typeof this.options.countSelectedText === 'function') ? this.options.countSelectedText(selectedItems.length, totalCount) : this.options.countSelectedText;\n          title = tr8nText.replace('{0}', selectedItems.length.toString()).replace('{1}', totalCount.toString());\n        }\n      }\n\n      this.options.title = this.$element.attr('title');\n\n      if (this.options.selectedTextFormat == 'static') {\n        title = this.options.title;\n      }\n\n      //If we dont have a title, then use the default, or if nothing is set at all, use the not selected text\n      if (!title) {\n        title = typeof this.options.title !== 'undefined' ? this.options.title : this.options.noneSelectedText;\n      }\n\n      this.$button.attr('title', htmlEscape(title));\n      this.$newElement.find('.filter-option').html(title);\n    },\n\n    /**\n     * @param [style]\n     * @param [status]\n     */\n    setStyle: function (style, status) {\n      if (this.$element.attr('class')) {\n        this.$newElement.addClass(this.$element.attr('class').replace(/selectpicker|mobile-device|validate\\[.*\\]/gi, ''));\n      }\n\n      var buttonClass = style ? style : this.options.style;\n\n      if (status == 'add') {\n        this.$button.addClass(buttonClass);\n      } else if (status == 'remove') {\n        this.$button.removeClass(buttonClass);\n      } else {\n        this.$button.removeClass(this.options.style);\n        this.$button.addClass(buttonClass);\n      }\n    },\n\n    liHeight: function () {\n      if (this.options.size === false) return;\n\n      var $selectClone = this.$menu.parent().clone().find('> .dropdown-toggle').prop('autofocus', false).end().appendTo('body'),\n          $menuClone = $selectClone.addClass('open').find('> .dropdown-menu'),\n          liHeight = $menuClone.find('li').not('.divider').not('.dropdown-header').filter(':visible').children('a').outerHeight(),\n          headerHeight = this.options.header ? $menuClone.find('.popover-title').outerHeight() : 0,\n          searchHeight = this.options.liveSearch ? $menuClone.find('.bs-searchbox').outerHeight() : 0,\n          actionsHeight = this.options.actionsBox ? $menuClone.find('.bs-actionsbox').outerHeight() : 0;\n\n      $selectClone.remove();\n\n      this.$newElement\n          .data('liHeight', liHeight)\n          .data('headerHeight', headerHeight)\n          .data('searchHeight', searchHeight)\n          .data('actionsHeight', actionsHeight);\n    },\n\n    setSize: function () {\n      this.findLis();\n      var that = this,\n          menu = this.$menu,\n          menuInner = menu.find('.inner'),\n          selectHeight = this.$newElement.outerHeight(),\n          liHeight = this.$newElement.data('liHeight'),\n          headerHeight = this.$newElement.data('headerHeight'),\n          searchHeight = this.$newElement.data('searchHeight'),\n          actionsHeight = this.$newElement.data('actionsHeight'),\n          divHeight = this.$lis.filter('.divider').outerHeight(true),\n          menuPadding = parseInt(menu.css('padding-top')) +\n              parseInt(menu.css('padding-bottom')) +\n              parseInt(menu.css('border-top-width')) +\n              parseInt(menu.css('border-bottom-width')),\n          notDisabled = this.options.hideDisabled ? ', .disabled' : '',\n          $window = $(window),\n          menuExtras = menuPadding + parseInt(menu.css('margin-top')) + parseInt(menu.css('margin-bottom')) + 2,\n          menuHeight,\n          selectOffsetTop,\n          selectOffsetBot,\n          posVert = function () {\n            // JQuery defines a scrollTop function, but in pure JS it's a property\n            //noinspection JSValidateTypes\n            selectOffsetTop = that.$newElement.offset().top - $window.scrollTop();\n            selectOffsetBot = $window.height() - selectOffsetTop - selectHeight;\n          };\n      posVert();\n      if (this.options.header) menu.css('padding-top', 0);\n\n      if (this.options.size == 'auto') {\n        var getSize = function () {\n          var minHeight,\n              lisVis = that.$lis.not('.hide');\n\n          posVert();\n          menuHeight = selectOffsetBot - menuExtras;\n\n          if (that.options.dropupAuto) {\n            that.$newElement.toggleClass('dropup', (selectOffsetTop > selectOffsetBot) && ((menuHeight - menuExtras) < menu.height()));\n          }\n          if (that.$newElement.hasClass('dropup')) {\n            menuHeight = selectOffsetTop - menuExtras;\n          }\n\n          if ((lisVis.length + lisVis.filter('.dropdown-header').length) > 3) {\n            minHeight = liHeight * 3 + menuExtras - 2;\n          } else {\n            minHeight = 0;\n          }\n\n          menu.css({\n            'max-height': menuHeight + 'px',\n            'overflow': 'hidden',\n            'min-height': minHeight + headerHeight + searchHeight + actionsHeight + 'px'\n          });\n          menuInner.css({\n            'max-height': menuHeight - headerHeight - searchHeight - actionsHeight - menuPadding + 'px',\n            'overflow-y': 'auto',\n            'min-height': Math.max(minHeight - menuPadding, 0) + 'px'\n          });\n        };\n        getSize();\n        this.$searchbox.off('input.getSize propertychange.getSize').on('input.getSize propertychange.getSize', getSize);\n        $(window).off('resize.getSize').on('resize.getSize', getSize);\n        $(window).off('scroll.getSize').on('scroll.getSize', getSize);\n      } else if (this.options.size && this.options.size != 'auto' && menu.find('li' + notDisabled).length > this.options.size) {\n        var optIndex = this.$lis.not('.divider' + notDisabled).find(' > *').slice(0, this.options.size).last().parent().index();\n        var divLength = this.$lis.slice(0, optIndex + 1).filter('.divider').length;\n        menuHeight = liHeight * this.options.size + divLength * divHeight + menuPadding;\n        if (that.options.dropupAuto) {\n          //noinspection JSUnusedAssignment\n          this.$newElement.toggleClass('dropup', (selectOffsetTop > selectOffsetBot) && (menuHeight < menu.height()));\n        }\n        menu.css({'max-height': menuHeight + headerHeight + searchHeight + actionsHeight + 'px', 'overflow': 'hidden'});\n        menuInner.css({'max-height': menuHeight - menuPadding + 'px', 'overflow-y': 'auto'});\n      }\n    },\n\n    setWidth: function () {\n      if (this.options.width == 'auto') {\n        this.$menu.css('min-width', '0');\n\n        // Get correct width if element hidden\n        var selectClone = this.$newElement.clone().appendTo('body');\n        var ulWidth = selectClone.find('> .dropdown-menu').css('width');\n        var btnWidth = selectClone.css('width', 'auto').find('> button').css('width');\n        selectClone.remove();\n\n        // Set width to whatever's larger, button title or longest option\n        this.$newElement.css('width', Math.max(parseInt(ulWidth), parseInt(btnWidth)) + 'px');\n      } else if (this.options.width == 'fit') {\n        // Remove inline min-width so width can be changed from 'auto'\n        this.$menu.css('min-width', '');\n        this.$newElement.css('width', '').addClass('fit-width');\n      } else if (this.options.width) {\n        // Remove inline min-width so width can be changed from 'auto'\n        this.$menu.css('min-width', '');\n        this.$newElement.css('width', this.options.width);\n      } else {\n        // Remove inline min-width/width so width can be changed\n        this.$menu.css('min-width', '');\n        this.$newElement.css('width', '');\n      }\n      // Remove fit-width class if width is changed programmatically\n      if (this.$newElement.hasClass('fit-width') && this.options.width !== 'fit') {\n        this.$newElement.removeClass('fit-width');\n      }\n    },\n\n    selectPosition: function () {\n      var that = this,\n          drop = '<div />',\n          $drop = $(drop),\n          pos,\n          actualHeight,\n          getPlacement = function ($element) {\n            $drop.addClass($element.attr('class').replace(/form-control/gi, '')).toggleClass('dropup', $element.hasClass('dropup'));\n            pos = $element.offset();\n            actualHeight = $element.hasClass('dropup') ? 0 : $element[0].offsetHeight;\n            $drop.css({\n              'top': pos.top + actualHeight,\n              'left': pos.left,\n              'width': $element[0].offsetWidth,\n              'position': 'absolute'\n            });\n          };\n      this.$newElement.on('click', function () {\n        if (that.isDisabled()) {\n          return;\n        }\n        getPlacement($(this));\n        $drop.appendTo(that.options.container);\n        $drop.toggleClass('open', !$(this).hasClass('open'));\n        $drop.append(that.$menu);\n      });\n      $(window).resize(function () {\n        getPlacement(that.$newElement);\n      });\n      $(window).on('scroll', function () {\n        getPlacement(that.$newElement);\n      });\n      $('html').on('click', function (e) {\n        if ($(e.target).closest(that.$newElement).length < 1) {\n          $drop.removeClass('open');\n        }\n      });\n    },\n\n    setSelected: function (index, selected) {\n      this.findLis();\n      this.$lis.filter('[data-original-index=\"' + index + '\"]').toggleClass('selected', selected);\n    },\n\n    setDisabled: function (index, disabled) {\n      this.findLis();\n      if (disabled) {\n        this.$lis.filter('[data-original-index=\"' + index + '\"]').addClass('disabled').find('a').attr('href', '#').attr('tabindex', -1);\n      } else {\n        this.$lis.filter('[data-original-index=\"' + index + '\"]').removeClass('disabled').find('a').removeAttr('href').attr('tabindex', 0);\n      }\n    },\n\n    isDisabled: function () {\n      return this.$element.is(':disabled');\n    },\n\n    checkDisabled: function () {\n      var that = this;\n\n      if (this.isDisabled()) {\n        this.$button.addClass('disabled').attr('tabindex', -1);\n      } else {\n        if (this.$button.hasClass('disabled')) {\n          this.$button.removeClass('disabled');\n        }\n\n        if (this.$button.attr('tabindex') == -1) {\n          if (!this.$element.data('tabindex')) this.$button.removeAttr('tabindex');\n        }\n      }\n\n      this.$button.click(function () {\n        return !that.isDisabled();\n      });\n    },\n\n    tabIndex: function () {\n      if (this.$element.is('[tabindex]')) {\n        this.$element.data('tabindex', this.$element.attr('tabindex'));\n        this.$button.attr('tabindex', this.$element.data('tabindex'));\n      }\n    },\n\n    clickListener: function () {\n      var that = this;\n\n      this.$newElement.on('touchstart.dropdown', '.dropdown-menu', function (e) {\n        e.stopPropagation();\n      });\n\n      this.$newElement.on('click', function () {\n        that.setSize();\n        if (!that.options.liveSearch && !that.multiple) {\n          setTimeout(function () {\n            that.$menu.find('.selected a').focus();\n          }, 10);\n        }\n      });\n\n      this.$menu.on('click', 'li a', function (e) {\n        var $this = $(this),\n            clickedIndex = $this.parent().data('originalIndex'),\n            prevValue = that.$element.val(),\n            prevIndex = that.$element.prop('selectedIndex');\n\n        // Don't close on multi choice menu\n        if (that.multiple) {\n          e.stopPropagation();\n        }\n\n        e.preventDefault();\n\n        //Don't run if we have been disabled\n        if (!that.isDisabled() && !$this.parent().hasClass('disabled')) {\n          var $options = that.$element.find('option'),\n              $option = $options.eq(clickedIndex),\n              state = $option.prop('selected'),\n              $optgroup = $option.parent('optgroup'),\n              maxOptions = that.options.maxOptions,\n              maxOptionsGrp = $optgroup.data('maxOptions') || false;\n\n          if (!that.multiple) { // Deselect all others if not multi select box\n            $options.prop('selected', false);\n            $option.prop('selected', true);\n            that.$menu.find('.selected').removeClass('selected');\n            that.setSelected(clickedIndex, true);\n          } else { // Toggle the one we have chosen if we are multi select.\n            $option.prop('selected', !state);\n            that.setSelected(clickedIndex, !state);\n            $this.blur();\n\n            if ((maxOptions !== false) || (maxOptionsGrp !== false)) {\n              var maxReached = maxOptions < $options.filter(':selected').length,\n                  maxReachedGrp = maxOptionsGrp < $optgroup.find('option:selected').length;\n\n              if ((maxOptions && maxReached) || (maxOptionsGrp && maxReachedGrp)) {\n                if (maxOptions && maxOptions == 1) {\n                  $options.prop('selected', false);\n                  $option.prop('selected', true);\n                  that.$menu.find('.selected').removeClass('selected');\n                  that.setSelected(clickedIndex, true);\n                } else if (maxOptionsGrp && maxOptionsGrp == 1) {\n                  $optgroup.find('option:selected').prop('selected', false);\n                  $option.prop('selected', true);\n                  var optgroupID = $this.data('optgroup');\n\n                  that.$menu.find('.selected').has('a[data-optgroup=\"' + optgroupID + '\"]').removeClass('selected');\n\n                  that.setSelected(clickedIndex, true);\n                } else {\n                  var maxOptionsArr = (typeof that.options.maxOptionsText === 'function') ?\n                          that.options.maxOptionsText(maxOptions, maxOptionsGrp) : that.options.maxOptionsText,\n                      maxTxt = maxOptionsArr[0].replace('{n}', maxOptions),\n                      maxTxtGrp = maxOptionsArr[1].replace('{n}', maxOptionsGrp),\n                      $notify = $('<div class=\"notify\"></div>');\n                  // If {var} is set in array, replace it\n                  /** @deprecated */\n                  if (maxOptionsArr[2]) {\n                    maxTxt = maxTxt.replace('{var}', maxOptionsArr[2][maxOptions > 1 ? 0 : 1]);\n                    maxTxtGrp = maxTxtGrp.replace('{var}', maxOptionsArr[2][maxOptionsGrp > 1 ? 0 : 1]);\n                  }\n\n                  $option.prop('selected', false);\n\n                  that.$menu.append($notify);\n\n                  if (maxOptions && maxReached) {\n                    $notify.append($('<div>' + maxTxt + '</div>'));\n                    that.$element.trigger('maxReached.bs.select');\n                  }\n\n                  if (maxOptionsGrp && maxReachedGrp) {\n                    $notify.append($('<div>' + maxTxtGrp + '</div>'));\n                    that.$element.trigger('maxReachedGrp.bs.select');\n                  }\n\n                  setTimeout(function () {\n                    that.setSelected(clickedIndex, false);\n                  }, 10);\n\n                  $notify.delay(750).fadeOut(300, function () {\n                    $(this).remove();\n                  });\n                }\n              }\n            }\n          }\n\n          if (!that.multiple) {\n            that.$button.focus();\n          } else if (that.options.liveSearch) {\n            that.$searchbox.focus();\n          }\n\n          // Trigger select 'change'\n          if ((prevValue != that.$element.val() && that.multiple) || (prevIndex != that.$element.prop('selectedIndex') && !that.multiple)) {\n            that.$element.change();\n          }\n        }\n      });\n\n      this.$menu.on('click', 'li.disabled a, .popover-title, .popover-title :not(.close)', function (e) {\n        if (e.target == this) {\n          e.preventDefault();\n          e.stopPropagation();\n          if (!that.options.liveSearch) {\n            that.$button.focus();\n          } else {\n            that.$searchbox.focus();\n          }\n        }\n      });\n\n      this.$menu.on('click', 'li.divider, li.dropdown-header', function (e) {\n        e.preventDefault();\n        e.stopPropagation();\n        if (!that.options.liveSearch) {\n          that.$button.focus();\n        } else {\n          that.$searchbox.focus();\n        }\n      });\n\n      this.$menu.on('click', '.popover-title .close', function () {\n        that.$button.focus();\n      });\n\n      this.$searchbox.on('click', function (e) {\n        e.stopPropagation();\n      });\n\n\n      this.$menu.on('click', '.actions-btn', function (e) {\n        if (that.options.liveSearch) {\n          that.$searchbox.focus();\n        } else {\n          that.$button.focus();\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        if ($(this).is('.bs-select-all')) {\n          that.selectAll();\n        } else {\n          that.deselectAll();\n        }\n        that.$element.change();\n      });\n\n      this.$element.change(function () {\n        that.render(false);\n      });\n    },\n\n    liveSearchListener: function () {\n      var that = this,\n          no_results = $('<li class=\"no-results\"></li>');\n\n      this.$newElement.on('click.dropdown.data-api touchstart.dropdown.data-api', function () {\n        that.$menu.find('.active').removeClass('active');\n        if (!!that.$searchbox.val()) {\n          that.$searchbox.val('');\n          that.$lis.not('.is-hidden').removeClass('hide');\n          if (!!no_results.parent().length) no_results.remove();\n        }\n        if (!that.multiple) that.$menu.find('.selected').addClass('active');\n        setTimeout(function () {\n          that.$searchbox.focus();\n        }, 10);\n      });\n\n      this.$searchbox.on('click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api', function (e) {\n        e.stopPropagation();\n      });\n\n      this.$searchbox.on('input propertychange', function () {\n        if (that.$searchbox.val()) {\n\n          if (that.options.searchAccentInsensitive) {\n            that.$lis.not('.is-hidden').removeClass('hide').find('a').not(':aicontains(' + normalizeToBase(that.$searchbox.val()) + ')').parent().addClass('hide');\n          } else {\n            that.$lis.not('.is-hidden').removeClass('hide').find('a').not(':icontains(' + that.$searchbox.val() + ')').parent().addClass('hide');\n          }\n\n          if (!that.$menu.find('li').filter(':visible:not(.no-results)').length) {\n            if (!!no_results.parent().length) no_results.remove();\n            no_results.html(that.options.noneResultsText + ' \"' + htmlEscape(that.$searchbox.val()) + '\"').show();\n            that.$menu.find('li').last().after(no_results);\n          } else if (!!no_results.parent().length) {\n            no_results.remove();\n          }\n\n        } else {\n          that.$lis.not('.is-hidden').removeClass('hide');\n          if (!!no_results.parent().length) no_results.remove();\n        }\n\n        that.$menu.find('li.active').removeClass('active');\n        that.$menu.find('li').filter(':visible:not(.divider)').eq(0).addClass('active').find('a').focus();\n        $(this).focus();\n      });\n    },\n\n    val: function (value) {\n      if (typeof value !== 'undefined') {\n        this.$element.val(value);\n        this.render();\n\n        return this.$element;\n      } else {\n        return this.$element.val();\n      }\n    },\n\n    selectAll: function () {\n      this.findLis();\n      this.$lis.not('.divider').not('.disabled').not('.selected').filter(':visible').find('a').click();\n    },\n\n    deselectAll: function () {\n      this.findLis();\n      this.$lis.not('.divider').not('.disabled').filter('.selected').filter(':visible').find('a').click();\n    },\n\n    keydown: function (e) {\n      var $this = $(this),\n          $parent = ($this.is('input')) ? $this.parent().parent() : $this.parent(),\n          $items,\n          that = $parent.data('this'),\n          index,\n          next,\n          first,\n          last,\n          prev,\n          nextPrev,\n          prevIndex,\n          isActive,\n          keyCodeMap = {\n            32: ' ',\n            48: '0',\n            49: '1',\n            50: '2',\n            51: '3',\n            52: '4',\n            53: '5',\n            54: '6',\n            55: '7',\n            56: '8',\n            57: '9',\n            59: ';',\n            65: 'a',\n            66: 'b',\n            67: 'c',\n            68: 'd',\n            69: 'e',\n            70: 'f',\n            71: 'g',\n            72: 'h',\n            73: 'i',\n            74: 'j',\n            75: 'k',\n            76: 'l',\n            77: 'm',\n            78: 'n',\n            79: 'o',\n            80: 'p',\n            81: 'q',\n            82: 'r',\n            83: 's',\n            84: 't',\n            85: 'u',\n            86: 'v',\n            87: 'w',\n            88: 'x',\n            89: 'y',\n            90: 'z',\n            96: '0',\n            97: '1',\n            98: '2',\n            99: '3',\n            100: '4',\n            101: '5',\n            102: '6',\n            103: '7',\n            104: '8',\n            105: '9'\n          };\n\n      if (that.options.liveSearch) $parent = $this.parent().parent();\n\n      if (that.options.container) $parent = that.$menu;\n\n      $items = $('[role=menu] li a', $parent);\n\n      isActive = that.$menu.parent().hasClass('open');\n\n      if (!isActive && /([0-9]|[A-z])/.test(String.fromCharCode(e.keyCode))) {\n        if (!that.options.container) {\n          that.setSize();\n          that.$menu.parent().addClass('open');\n          isActive = true;\n        } else {\n          that.$newElement.trigger('click');\n        }\n        that.$searchbox.focus();\n      }\n\n      if (that.options.liveSearch) {\n        if (/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && that.$menu.find('.active').length === 0) {\n          e.preventDefault();\n          that.$menu.parent().removeClass('open');\n          that.$button.focus();\n        }\n        $items = $('[role=menu] li:not(.divider):not(.dropdown-header):visible', $parent);\n        if (!$this.val() && !/(38|40)/.test(e.keyCode.toString(10))) {\n          if ($items.filter('.active').length === 0) {\n            if (that.options.searchAccentInsensitive) {\n              $items = that.$newElement.find('li').filter(':aicontains(' + normalizeToBase(keyCodeMap[e.keyCode]) + ')');\n            } else {\n              $items = that.$newElement.find('li').filter(':icontains(' + keyCodeMap[e.keyCode] + ')');\n            }\n          }\n        }\n      }\n\n      if (!$items.length) return;\n\n      if (/(38|40)/.test(e.keyCode.toString(10))) {\n        index = $items.index($items.filter(':focus'));\n        first = $items.parent(':not(.disabled):visible').first().index();\n        last = $items.parent(':not(.disabled):visible').last().index();\n        next = $items.eq(index).parent().nextAll(':not(.disabled):visible').eq(0).index();\n        prev = $items.eq(index).parent().prevAll(':not(.disabled):visible').eq(0).index();\n        nextPrev = $items.eq(next).parent().prevAll(':not(.disabled):visible').eq(0).index();\n\n        if (that.options.liveSearch) {\n          $items.each(function (i) {\n            if ($(this).is(':not(.disabled)')) {\n              $(this).data('index', i);\n            }\n          });\n          index = $items.index($items.filter('.active'));\n          first = $items.filter(':not(.disabled):visible').first().data('index');\n          last = $items.filter(':not(.disabled):visible').last().data('index');\n          next = $items.eq(index).nextAll(':not(.disabled):visible').eq(0).data('index');\n          prev = $items.eq(index).prevAll(':not(.disabled):visible').eq(0).data('index');\n          nextPrev = $items.eq(next).prevAll(':not(.disabled):visible').eq(0).data('index');\n        }\n\n        prevIndex = $this.data('prevIndex');\n\n        if (e.keyCode == 38) {\n          if (that.options.liveSearch) index -= 1;\n          if (index != nextPrev && index > prev) index = prev;\n          if (index < first) index = first;\n          if (index == prevIndex) index = last;\n        }\n\n        if (e.keyCode == 40) {\n          if (that.options.liveSearch) index += 1;\n          if (index == -1) index = 0;\n          if (index != nextPrev && index < next) index = next;\n          if (index > last) index = last;\n          if (index == prevIndex) index = first;\n        }\n\n        $this.data('prevIndex', index);\n\n        if (!that.options.liveSearch) {\n          $items.eq(index).focus();\n        } else {\n          e.preventDefault();\n          if (!$this.is('.dropdown-toggle')) {\n            $items.removeClass('active');\n            $items.eq(index).addClass('active').find('a').focus();\n            $this.focus();\n          }\n        }\n\n      } else if (!$this.is('input')) {\n        var keyIndex = [],\n            count,\n            prevKey;\n\n        $items.each(function () {\n          if ($(this).parent().is(':not(.disabled)')) {\n            if ($.trim($(this).text().toLowerCase()).substring(0, 1) == keyCodeMap[e.keyCode]) {\n              keyIndex.push($(this).parent().index());\n            }\n          }\n        });\n\n        count = $(document).data('keycount');\n        count++;\n        $(document).data('keycount', count);\n\n        prevKey = $.trim($(':focus').text().toLowerCase()).substring(0, 1);\n\n        if (prevKey != keyCodeMap[e.keyCode]) {\n          count = 1;\n          $(document).data('keycount', count);\n        } else if (count >= keyIndex.length) {\n          $(document).data('keycount', 0);\n          if (count > keyIndex.length) count = 1;\n        }\n\n        $items.eq(keyIndex[count - 1]).focus();\n      }\n\n      // Select focused option if \"Enter\", \"Spacebar\" or \"Tab\" (when selectOnTab is true) are pressed inside the menu.\n      if ((/(13|32)/.test(e.keyCode.toString(10)) || (/(^9$)/.test(e.keyCode.toString(10)) && that.options.selectOnTab)) && isActive) {\n        if (!/(32)/.test(e.keyCode.toString(10))) e.preventDefault();\n        if (!that.options.liveSearch) {\n          $(':focus').click();\n        } else if (!/(32)/.test(e.keyCode.toString(10))) {\n          that.$menu.find('.active a').click();\n          $this.focus();\n        }\n        $(document).data('keycount', 0);\n      }\n\n      if ((/(^9$|27)/.test(e.keyCode.toString(10)) && isActive && (that.multiple || that.options.liveSearch)) || (/(27)/.test(e.keyCode.toString(10)) && !isActive)) {\n        that.$menu.parent().removeClass('open');\n        that.$button.focus();\n      }\n    },\n\n    mobile: function () {\n      this.$element.addClass('mobile-device').appendTo(this.$newElement);\n      if (this.options.container) this.$menu.hide();\n    },\n\n    refresh: function () {\n      this.$lis = null;\n      this.reloadLi();\n      this.render();\n      this.setWidth();\n      this.setStyle();\n      this.checkDisabled();\n      this.liHeight();\n    },\n\n    update: function () {\n      this.reloadLi();\n      this.setWidth();\n      this.setStyle();\n      this.checkDisabled();\n      this.liHeight();\n    },\n\n    hide: function () {\n      this.$newElement.hide();\n    },\n\n    show: function () {\n      this.$newElement.show();\n    },\n\n    remove: function () {\n      this.$newElement.remove();\n      this.$element.remove();\n    }\n  };\n\n  // SELECTPICKER PLUGIN DEFINITION\n  // ==============================\n  function Plugin(option, event) {\n    // get the args of the outer function..\n    var args = arguments;\n    // The arguments of the function are explicitly re-defined from the argument list, because the shift causes them\n    // to get lost\n    //noinspection JSDuplicatedDeclaration\n    var _option = option,\n        option = args[0],\n        event = args[1];\n    [].shift.apply(args);\n\n    // This fixes a bug in the js implementation on android 2.3 #715\n    if (typeof option == 'undefined') {\n      option = _option;\n    }\n\n    var value;\n    var chain = this.each(function () {\n      var $this = $(this);\n      if ($this.is('select')) {\n        var data = $this.data('selectpicker'),\n            options = typeof option == 'object' && option;\n\n        if (!data) {\n          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\n          $this.data('selectpicker', (data = new Selectpicker(this, config, event)));\n        } else if (options) {\n          for (var i in options) {\n            if (options.hasOwnProperty(i)) {\n              data.options[i] = options[i];\n            }\n          }\n        }\n\n        if (typeof option == 'string') {\n          if (data[option] instanceof Function) {\n            value = data[option].apply(data, args);\n          } else {\n            value = data.options[option];\n          }\n        }\n      }\n    });\n\n    if (typeof value !== 'undefined') {\n      //noinspection JSUnusedAssignment\n      return value;\n    } else {\n      return chain;\n    }\n  }\n\n  var old = $.fn.selectpicker;\n  $.fn.selectpicker = Plugin;\n  $.fn.selectpicker.Constructor = Selectpicker;\n\n  // SELECTPICKER NO CONFLICT\n  // ========================\n  $.fn.selectpicker.noConflict = function () {\n    $.fn.selectpicker = old;\n    return this;\n  };\n\n  $(document)\n      .data('keycount', 0)\n      .on('keydown', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input', Selectpicker.prototype.keydown)\n      .on('focusin.modal', '.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bs-searchbox input', function (e) {\n        e.stopPropagation();\n      });\n\n  // SELECTPICKER DATA-API\n  // =====================\n  $(window).on('load.bs.select.data-api', function () {\n    $('.selectpicker').each(function () {\n      var $selectpicker = $(this);\n      Plugin.call($selectpicker, $selectpicker.data());\n    })\n  });\n})(jQuery);\n"},701:function(t,e){t.exports="$('.verticals_wrapper').addClass('video_cover');\n\n//Money format\n//To Use: (123456789.12345).formatMoney(2, '.', ',');\n\nNumber.prototype.formatMoney = function(c, d, t){\n\tvar n = this,\n\t\tc = isNaN(c = Math.abs(c)) ? 2 : c,\n\t\td = d == undefined ? \".\" : d,\n\t\tt = t == undefined ? \",\" : t,\n\t\ts = n < 0 ? \"-\" : \"\",\n\t\ti = String(parseInt(n = Math.abs(Number(n) || 0).toFixed(c))),\n\t\tj = (j = i.length) > 3 ? j % 3 : 0;\n\treturn s + (j ? i.substr(0, j) + t : \"\") + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : \"\");\n};\n\nvar contactFlag = 0;\nvar cityName='';\nvar contactLogin,issueID,subissueID,booking_id_required;\n$(function() { checkUser(); });\njQuery.fn.center = function() {\n\t\tif (window.fixedSupported) {\n\t\t\t\tthis.css(\"position\", \"fixed\");\n\t\t\t\tthis.css(\"top\", (($(window).height() - this.outerHeight()) / 2) + \"px\");\n\t\t\t\tthis.css(\"left\", (($(window).width() - this.outerWidth()) / 2) + \"px\");\n\t\t} else {\n\t\t\t\tthis.css(\"position\", \"absolute\");\n\t\t\t\tthis.css(\"top\", (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop() + \"px\");\n\t\t\t\tthis.css(\"left\", (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft() + \"px\");\n\t\t}\n\t\treturn this;\n}\n\njQuery.fn.jail = function() {\n\t\tvar cacheSrc = this.attr(\"data-background\");\n\t\tif (cacheSrc && cacheSrc != '') {\n\t\t\t\tthis.removeAttr('data-src');\n\t\t\t\tthis.css(\"background\", \"url(\" + cacheSrc + \") no-repeat center top;\");\n\t\t}\n\t\treturn this;\n}\n\nfunction autoResize(id, count) {\n\t\t$(\"#Wait\").hide();\n\t\t$(\"#IframeBox\").fadeIn();\n}\n\nfunction formCredits(frm,url,divId,params) {\n\tresponse = null;\n\t$(document).ready(function(){\n\t\tvar apply_credits = jQuery.trim($(\"#applyCredits\").val());\n\t\tvar remove_credits = jQuery.trim($(\"#removeCredits\").val());\n\t\tvar credits_old = $(\"#creditsUsed\").text();\n\t\tvar promo_old = $(\"#promoAmount\").text();\n\t\tcredits_old = getValue(credits_old);\n\t\tpromo_old = getValue(promo_old);\n\t\t$('.cancelCreditsBtn:submit').click(function(){\n\t\t\t$('.cancelCreditsBtn:submit').attr(\"disabled\", true);\n\t\t});\n\t\t$('#use_credit:submit').click(function(){\n\t\t\t$('#use_credit:submit').attr(\"disabled\", true);\n\t\t});\n\t\t\t$.ajax({\n\t\t\t\ttype:\"POST\",\n\t\t\t\turl: url,\n\t\t\t\tdata: {apply_credits: apply_credits,\n\t\t\t\t\t\t\tremove_credits: remove_credits,\n\t\t\t\t\t\t\trequest_from: 'payment_options'\n\t\t\t\t\t\t},\n\t\t\t\tdataType: \"json\"\n\t\t\t})\n\t\t\t.done(function(json){\n\t\t\t\t$(\"#PromoDiv\").empty().append(json.promo);\n\t\t\t\t$(\"#CreditDiv\").empty().append(json.credit);\n\t\t\t\tappendOffersData();\n\t\t\t\tvar credits_new = $(\"#creditsUsed\").text();\n\t\t\t\tvar promo_new = $(\"#promoAmount\").text();\n\t\t\t\tcredits_new = getValue(credits_new);\n\t\t\t\tpromo_new = getValue(promo_new);\n\t\t\t\tupdateCheckoutAmount(credits_new, credits_old, promo_new, promo_old);\n\t\t\t})\n\t});\n}\n\nfunction updateOnFbShare(discount, shared_flag) {\n\t\tif (shared_flag !== 1) {\n\t\t\t\tvar discount_old = $('#deal_discount').text();\n\t\t\t\tvar discounted_fare_old = $('#deal_discounted_fare').text();\n\t\t\t\tvar payable_amount_old = $('#final_amount_to_pay').text();\n\t\t\t\tvar apply_credits = jQuery.trim($(\"#applyCredits\").val());\n\t\t\t\tvar remove_credits = jQuery.trim($(\"#removeCredits\").val());\n\n\t\t\t\tdiscount_old = parseInt(discount_old.replace(/[, ]+/g, \"\").trim());\n\t\t\t\tdiscounted_fare_old = parseInt(discounted_fare_old.replace(/[, ]+/g, \"\").trim());\n\t\t\t\tpayable_amount_old = parseInt(payable_amount_old.replace(/[, ]+/g, \"\").trim());\n\n\t\t\t\tvar discount_new = discount_old + discount;\n\t\t\t\tvar discounted_fare_new = discounted_fare_old - discount;\n\t\t\t\tvar payable_amount_new = payable_amount_old - discount;\n\n\t\t\t\t$('#deal_discount').text(commaSeparateNumber(discount_new));\n\t\t\t\t$('#deal_discounted_fare').text(commaSeparateNumber(discounted_fare_new));\n\t\t\t\t$('#sidebar_deal_discount').text(commaSeparateNumber(discount_new));\n\t\t\t\t// $.ajax({\n\t\t\t\t//                  type:\"POST\",\n\t\t\t\t//                  url: \"/bookings/deal_fb_share\",\n\t\t\t\t//                      dataType: \"json\"\n\t\t\t\t//                });\n\t\t\t\t$.ajax({\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\turl: \"/bookings/exclusive_member\"\n\t\t\t\t})\n\t\t\t\tif (remove_credits == 1) {\n\t\t\t\t\t\tvar credits_old = getValue($('#creditsUsed').text());\n\t\t\t\t\t\tpayable_amount_new += credits_old;\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\t\t\turl: \"/bookings/promo\",\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\tapply_credits: apply_credits,\n\t\t\t\t\t\t\t\t\t\t\t\tremove_credits: remove_credits\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.done(function(json) {\n\t\t\t\t\t\t\t\t\t\t$(\"#CreditDiv\").empty().append(json.credit);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t$('#final_amount_to_pay').text(commaSeparateNumber(payable_amount_new));\n\t\t\t\tdocument.getElementById(\"sidebarAmount\").innerHTML = commaSeparateNumber(payable_amount_new);\n\t}\n}\n\nfunction applyPromoCode(frm, url, divId) {\n\t\tresponse = null;\n\t\t$(document).ready(function() {\n\t\t\t\tvar promo = jQuery.trim($(\"#DetailsName\").val());\n\t\t\t\tvar starts = jQuery.trim($(\"#DetailsStarts\").val());\n\t\t\t\tvar ends = jQuery.trim($(\"#DetailsEnds\").val());\n\t\t\t\tvar loc = jQuery.trim($(\"#DetailsLocation\").val());\n\t\t\t\tvar car = jQuery.trim($(\"#DetailsCargroup\").val());\n\t\t\t\tvar clear = jQuery.trim($(\"#clearPromo\").val());\n\n\t\t\t\tvar credits_old = $(\"#creditsUsed\").text();\n\t\t\t\tvar promo_old = $(\"#promoAmount\").text();\n\t\t\t\tcredits_old = getValue(credits_old);\n\t\t\t\tpromo_old = getValue(promo_old);\n\t\t\t\t$('.promoCodeCancelBtn:submit').click(function() {\n\t\t\t\t\t\t$('.promoCodeCancelBtn:submit').attr(\"disabled\", true);\n\t\t\t\t});\n\t\t\t\t$('.use_tariff:submit').click(function() {\n\t\t\t\t\t\t$('.use_tariff:submit').attr(\"disabled\", true);\n\t\t\t\t});\n\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\turl: \"/bookings/promo\",\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tpromo: promo,\n\t\t\t\t\t\t\t\t\t\tstarts: starts,\n\t\t\t\t\t\t\t\t\t\tends: ends,\n\t\t\t\t\t\t\t\t\t\tloc: loc,\n\t\t\t\t\t\t\t\t\t\tcar: car,\n\t\t\t\t\t\t\t\t\t\tclear: clear\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(json) {\n\t\t\t\t\t\t\t\t$(\"#PromoDiv\").empty().append(json.promo);\n\t\t\t\t\t\t\t\t$(\"#CreditDiv\").empty().append(json.credit);\n\t\t\t\t\t\t\t\tappendOffersData();\n\t\t\t\t\t\t\t\tvar credits_new = $(\"#creditsUsed\").text();\n\t\t\t\t\t\t\t\tvar promo_new = $(\"#promoAmount\").text();\n\t\t\t\t\t\t\t\tcredits_new = getValue(credits_new);\n\t\t\t\t\t\t\t\tpromo_new = getValue(promo_new);\n\t\t\t\t\t\t\t\tupdateCheckoutAmount(credits_new, credits_old, promo_new, promo_old);\n\t\t\t\t\t\t})\n\t\t});\n}\n\nfunction getValue(rawValue) {\n\t\tif (rawValue == \"\") {\n\t\t\t\treturn 0;\n\t\t} else {\n\t\t\t\treturn parseInt(rawValue);\n\t\t}\n}\n\nfunction commaSeparateNumber(val) {\n\t\twhile (/(\\d+)(\\d{3})/.test(val.toString())) {\n\t\t\t\tval = val.toString().replace(/(\\d+)(\\d{3})/, '$1' + ',' + '$2');\n\t\t}\n\t\treturn val;\n}\n\nfunction fillPayableOnPaymentPage(booking_amount,security_deposit,wallet_amount,credit_amount, el){\n\tvar final_amount_to_pay = getCheckoutAmountOnApplyingCreditOrWallet(el,booking_amount,security_deposit, wallet_amount,credit_amount);\n\tupdateFinalAmountOnPaymentPage(final_amount_to_pay);\n}\n\nfunction getCheckoutAmountOnApplyingCreditOrWallet(el,booking_amount,security_deposit,wallet_amount, credits){\n\tamount_after_credits = getCheckoutAmountOnApplyingCredits(booking_amount, credits);\n\tamount_after_credits += security_deposit;\n\tamount_after_credits_and_wallet = getCheckoutAmountOnApplyingWallet(el,amount_after_credits, wallet_amount);\n\treturn amount_after_credits_and_wallet;\n}\n\nfunction getCheckoutAmountOnApplyingCredits(booking_amount, credits){\n\tvar amount_after_credits = booking_amount;\n\tvar $useCredits = $('#useCredits');\n\n\tif ($useCredits.is(':checked') && amount_after_credits > 0){\n\t\t// if credits are used\n\n\t\tif (credits && booking_amount > 0){\n\n\t\t\tvar credits_left = Math.max(credits - booking_amount, 0);\n\t\t\tvar credits_applied = credits - credits_left;\n\t\t\tamount_after_credits = amount_after_credits - credits_applied;\n\t\t\t$('#credit_rem').html( commaSeparateNumber(credits_left) );\n\t\t\t$('#creditsUsed').html( commaSeparateNumber(credits_applied));\n\t\t}\n\t\t$('#CreditsText').html(credits_applied + \" credits have been applied.\");\n\t\t$('.appliedCredits').val(\"1\");\n\t}\n\telse\n\t{\n\t\t$('.appliedCredits').val(\"0\");\n\n\t\t$('#credit_rem').html( commaSeparateNumber(credits) );\n\t\tif (amount_after_credits > 0){\n\t\t\t$('#CreditsDiv').show()\n\t\t} else {\n\t\t\t$('#CreditsDiv').hide();\n\t\t\t$useCredits.prop('checked', false);\n\t\t\t$useCredits.val(0);\n\t\t}\n\t\t$('#creditBox').hide();\n\n\t\t$('#CreditsText').html(\"Max \" + Math.min(booking_amount, credits) + \" credits can be applied to this booking.\");\n\n\t}\n\treturn amount_after_credits;\n}\n\n\nfunction getCheckoutAmountOnApplyingWallet(el,amount_after_credits, wallet_amount) {\n\tvar total_amount = amount_after_credits;\n\tvar amount_after_credits_and_wallet = amount_after_credits;\n\tif(el) {\n\t\tif (el.is(':checked') ) {\n\t\t\tif (wallet_amount && total_amount > 0) {\n\t\t\t\tvar wallet_amount_left = Math.max(wallet_amount - total_amount, 0);\n\t\t\t\tvar wallet_amount_applied = wallet_amount - wallet_amount_left;\n\n\t\t\t\tamount_after_credits_and_wallet = amount_after_credits_and_wallet - wallet_amount_applied;\n\t\t\t\tif(el.attr('id') == 'useCitrusExtWallet') {\n\t\t\t\t\t$('#wallet_rem').html( commaSeparateNumber(wallet_amount_left) );\n\t\t\t\t}\n\t\t\t\t$('#walletRemAmount').html( commaSeparateNumber(wallet_amount_applied));\n\t\t\t\t$('.walletDiv').show();\n\t\t\t\t$('#CitrusDiv').show();\n\t\t\t}\n\t\t\t$('input.appliedExtWallet').val(\"1\");\n\t\t\tif(el.attr('id') == 'useCitrusExtWallet' && total_amount == 0 ) {\n\t\t\t\tel.prop('checked', false);\n\t\t\t\t$('input.appliedExtWallet').val(\"0\");\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif(el.attr('id') == 'useCitrusExtWallet') {\n\t\t\t\t(amount_after_credits == 0 ) ? $('#CitrusDiv').hide() : $('#CitrusDiv').show();\n\n\t\t\t\t$('#wallet_rem').html( commaSeparateNumber(wallet_amount) );\n\t\t\t\t$('.appliedExtWallet').val(\"0\");\n\t\t\t\t$('.walletDiv').hide();\n\t\t\t} else {\n\t\t\t\t$('.appliedExtWallet').val(\"0\");\n\t\t\t\t$('.walletDiv').hide();\n\t\t\t}\n\t\t}\n\t}\n\n  return amount_after_credits_and_wallet;\n}\n\nfunction updateFinalAmountOnPaymentPage(final_amount_to_pay){\n\tdocument.getElementById(\"final_amount_to_pay\").innerHTML = commaSeparateNumber(final_amount_to_pay);\n  document.getElementById(\"sidebarAmount\").innerHTML = commaSeparateNumber(final_amount_to_pay);\n\n  toggle_visibility_payment_block(final_amount_to_pay);\n}\n\n\nfunction toggle_visibility_payment_block (final_amount_to_pay) {\n  // hide payment options when payable amount is 0 //\n  if (final_amount_to_pay == 0) {\n  \t$('.payment-block').hide();\n  \t$('#payableNullBlock').show();\n  \t//$('#citrusAmount').val(wallet_amount);\n  }\n  else {\n  \t$('.payment-block').show();\n  \t$('#payableNullBlock').hide();\n  \t//$('#appliedExtWallet').val(wallet_amount);\n  }\n}\n\nfunction updateCheckoutAmount(credits_new, credits_old, promo_new, promo_old){\n\t//var total_amount_raw = $(\"#final_amount_to_pay\").html();\n\t//var total_amount = parseInt(total_amount_raw.replace(/[, ]+/g, \"\").trim());\n\tvar total_amount = total_payable_amount;\n\t/*if (credits_new != credits_old){\n\t\ttotal_amount = total_amount - (credits_new - credits_old);\n\t}\n\tif (promo_new != promo_old){\n\t\t total_amount = total_amount - (promo_new - promo_old);\n\t}*/\n\ttotal_amount -= credits_new;\n\ttotal_amount -= promo_new;\n\n\t// wallet_amount is accessible\n\tvar promo_value = credits_new+promo_new;\n\tif(promo_value) {\n\t\t$('.promoDiv').html(\"- \");\n\t\t$('#promo_val').html(promo_value);\n\t}\n\telse {\n\t\t$('.promoDiv').html(\"\");\n\t\t$('#promo_val').html(\"\");\n\t}\n\n\tif ($('#useExtWallet').is(':checked')) {\n\t\tif (wallet_amount && total_amount > 0) {\n\t\t\tvar deducted_wallet_amount = Math.max(wallet_amount - total_amount, 0);\n\t\t\t$('#walletSpan').show();\n\t\t\t$('#walletLabel').show();\n\t\t\t$('#wallet_rem').html( commaSeparateNumber(deducted_wallet_amount) );\n\t\t\tif(total_amount >= wallet_amount){\n\t\t\t\t$('#walletRemDiv').show();\n\t\t\t\t$('#walletRemAmount').html(commaSeparateNumber(wallet_amount));\n        pushEvent('External Wallet','Apply Wallet Success',commaSeparateNumber(wallet_amount));\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$('#walletRemDiv').show();\n\t\t\t\t$('#walletRemAmount').html(commaSeparateNumber(total_amount));\n        pushEvent('External Wallet','Apply Wallet Success',commaSeparateNumber(total_amount));\n\t\t\t}\n\t\t\ttotal_amount = Math.max(total_amount - wallet_amount, 0);\n\t\t}\n\t}\n\telse {\n\t\t$('#wallet_rem').html( commaSeparateNumber(wallet_amount) );\n\t\t$('#walletRemDiv').hide();\n\t}\n  updateFinalAmountOnPaymentPage(total_amount);\n}\n\nfunction bindCountry() {\n\t\t$('.bind-country').bind(\"change\", function() {\n\t\t\t\tif ($(this).val() == 'IN') {\n\t\t\t\t\t\t$('.bind-to-country').show();\n\t\t\t\t} else {\n\t\t\t\t\t\t$('.bind-to-country').hide();\n\t\t\t\t}\n\t\t});\n}\n\nfunction carouselPause() {\n\t\t$('.carousel-indicators').find('li').bind(\"click\", function() {\n\t\t\t\t$('.carousel').carousel('pause');\n\t\t});\n}\n\nfunction changeCar(id,name,dom,action) {\n  $('#'+dom+'Val').val(id);\n  $('#'+dom+'Html').html(name);\n  $('#'+dom+'Menu').find('li').removeClass('active');\n  $('#'+dom+id).addClass('active');\n  if(action == 'home') {\n    pushEvent('Homepage Search', 'Car', name);\n  } else if(action == 'nav') {\n    if(window.location.pathname.search('search') != -1) {\n      pushEvent('Search', 'Car', name );\n    } else if(window.location.pathname.search('login') != -1) {\n      pushEvent('Login', 'Car', name );\n    } else if(window.location.pathname.search('checkout') != -1) {\n      pushEvent('Checkout', 'Car', name );\n    } else {\n      pushEvent('Book Cars', 'Car', name);\n    }\n  } else if(action == 'cal') {\n    pushEvent('Tariff Calculator', 'Car', name)\n  } else if(action == 'recal') {\n    pushEvent('Trip Modification Estimator', 'Car', name);\n  }\n}\n\nfunction changeLocation(id,name,action) {\n  $('#LocationVal').val(id);\n  $('#LocationHtml').html(name);\n  $('.LocationsMenu').find('li').removeClass('active');\n  $('#Location'+id).addClass('active');\n  if(action == 'home') {\n    pushEvent('Homepage Search', 'Location', name);\n  } else if(action == 'nav') {\n    if(window.location.pathname.search('search') != -1){\n      pushEvent('Search', 'Location', name);\n    } else if(window.location.pathname.search('login') != -1) {\n      pushEvent('Login', 'Location', name);\n    } else if(window.location.pathname.search('checkout') != -1) {\n      pushEvent('Checkout', 'Location', name);\n    } else {\n      pushEvent('Book Cars','Location', name);\n    }\n\n  }\n}\n\nfunction changeLocation1(id, name, action) {\n    $('#LocationVal1').val(id);\n    $('#LocationHtml1').html(name);\n    $('#LocationsMenu1').find('li').removeClass('active');\n    $('#Location' + id + '1').addClass('active');\n    if (action == 'nav') {\n        pushEvent('Rescheduler', 'Location', name);\n    }\n}\n\nfunction lazyLoadOnScroll() {\n\n\t// image array\n\tthis.lazyImages = [];\n\n\t// fetches the elements with lazy class and filters the one that are not to be displayed on mobile\n\tvar query = document.querySelectorAll('.lazy');\n\tfor( var i=0; i< query.length; i++) {\n\t\tif (!($(query[i]).hasClass('mobile_lazy') && isMobile()) && query[i].getAttribute('data-background')) {\n\t\t\tlazyImages.push(query[i]);\n\t\t}\n\t}\n\n\t// checks if the image exists inside the viewport and is visible\n\tthis.isElementInViewport = function(el) {\n\t\tvar rect = el.getBoundingClientRect();\n\t\treturn (\n\t\t\trect.top >= 0 &&\n\t\t\trect.left >= 0 &&\n\t\t\trect.top <= (window.innerHeight || document.documentElement.clientHeight) &&\n\t\t\t$(el).is(':visible')\n\t\t)\n\t}\n\n\t// sets background images of div or src of image tag\n\tthis.loadImage = function(el, callback) {\n\t\tvar imgSrc = (isMobile() && el.getAttribute('data-background_mobile') ? el.getAttribute('data-background_mobile') : el.getAttribute('data-background'));\n\t\tif (imgSrc) {\n\t\t\tif ($(el).hasClass('lazy_parent')) {\n\t\t\t\tvar imageTag = el.querySelector('img');\n\t\t\t\tif (imageTag.getAttribute('src') !== imgSrc) {\n\t\t\t\t\timageTag.setAttribute('src', imgSrc);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tel.style.backgroundImage = 'url(' + imgSrc + ')';\n\t\t\t}\n\t\t}\n\t\t$(el).removeAttr('data-background');\n\t\tcallback ? callback() : null\n\t}\n\n\t// initializes the lazy load\n\tthis.lazyInit = function() {\n\t\tfor (var i = lazyImages.length-1; i>=0 ; i--) {\n\t\t\tif (isElementInViewport(lazyImages[i])) {\n\t\t\t\tloadImage(lazyImages[i], function() {\n\t\t\t\t\tlazyImages.splice(i,1);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tif (lazyImages.length > 0) {\n\t\tlazyInit();\n\t}\n\n\t// touchmove for mobile devices and executes lazy load on scroll for other devices\n\tscrollEvent = $(window).on('scroll touchmove', function(event) {\n\t\tlazyInit();\n\t\tif (lazyImages.length == 0) {\n\t\t\t$(this).unbind(event);\n\t\t}\n\t});\n}\n\nfunction checkout(data) {\n\t\t$(\"#CheckoutWait\").show();\n\t\tif (typeof(data) === 'undefined') {\n\t\t\t\twindow.location = \"/#{@city.link_name.downcase}/bookings/docreate\";\n\t\t} else {\n\t\t\t\twindow.location = '/#{@city.link_name.downcase}/bookings/docreate?starts=' + data.starts + '&ends=' + data.ends + '&loc=' + data.loc + '&car=' + data.car;\n\t\t}\n}\n\nfunction checkUser() {\n\tif ($('#UserBar').length || $('#mobile_user_status').length) {\n\t\tvar social_error = '';\n\t\tif ($('.social_login_error').text().trim() !== '') {\n\t\t\tsocial_error = $('.social_login_error').text().trim();\n\t\t\t$.ajax({\n\t\t\t\turl: 'users/status',\n\t\t\t\ttype: 'GET',\n\t\t\t\tdataType: 'JSON',\n\t\t\t\tdata : {social_error: social_error}\n\t\t\t}).done(function(data) {\n\t\t\t\t$(\"#UserBar\").html(data[\"html\"]);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tif (isMobile()) {\n\t\t\t\tgetData(\"/users/mobile_status\", \"mobile_user_info\", \"replace\", null, function () {\n\t\t\t\t\tif ($('.user_name').length) {\n\t\t\t\t\t\t$('#mobile_user_status #logout').removeClass('hide');\n\t\t\t\t\t\t$('#mobile_user_status #login').addClass('hide');\n\t\t\t\t\t\t$('.mobile_login_block').addClass('hide');\n\t\t\t\t\t\tif(typeof(AppBuddy) != 'undefined'){\n\t\t\t\t\t\t\tAppBuddy.checkForUpcomingBooking();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse getData(\"/users/status\", 'UserBar', 'replace', null);\n\t\t}\n\t}\n}\n\nfunction clearLogin() {\n\t\t$('#UserBar').popover('destroy');\n}\n\nfunction getWalletStatus () {\n\tvar auth_token = getCookie('authToken');\n\n\treturn $.ajax({\n\t\ttype: 'POST',\n\t\turl: window.globals.apiHostName + '/v4/users/wallet_status',\n\t\tdata: {\n\t\t\tauth_token: auth_token,\n\t\t\tplatform: 'web'\n\t\t}\n\t})\n\t.done(function (response) {\n\t})\n\t.fail(function (jqXHR) {\n\t\tif (jqXHR.responseJSON && jqXHR.responseJSON.error_code === 1018) {\n\t\t\tdelCookie('authToken');\n\t\t\talert(jqXHR.responseJSON.msg);\n\t\t\twindow.location = \"/\";\n\t\t}\n\t});\n}\n\nfunction doBooking(carId, locId, pId, startTime, endTime, el, segmentProps) {\n  segmentProps.id = segmentProps.form_id = 'BookNow';\n  var formGroupName = Segment.getFormGroupName(segmentProps.id);\n  Segment.trackEvent(formGroupName, segmentProps);\n\n\t// call the function that updates the sessionstorage with the selected location's radius and text for use in checkout and payment\n\tupdateZapSession(el);\n\n\t// get uptodate radius from book now button\n\tvar radius = parseFloat($(el).attr('data-radius'));\n\tvar offer_id = $(el).data('offer') || '0';\n\tvar discounted_price = $(el).data('discounted_price') || '0';\n\n\tSegment.trackEvent('Link_Clicked', {\n\t\tis_autoapply: parseInt(discounted_price) > 0 ? true : false,\n\t\tstart_time: segmentProps.starts,\n\t\tend_time: segmentProps.ends,\n\t\tlocation: locId,\n\t\tid: 'AutoApply_Home_BookNow',\n\t\tuser_id: (typeof userEmail !== 'undefined') ? userEmail : null,\n\t})\n\t// get uptodate radius from book now button\n\tif (!getCookie('authToken')) {\n\t\tdoLogin(function () {\n\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t}, true);\n\t}\n\telse {\n\t\tgetWalletStatus()\n\t\t\t.done(function (response) {\n\n\t\t\t\tif (response.status) {\n\t\t\t\t\tif (response.is_wallet_enabled && !response.is_wallet_connected) {\n\n\t\t\t\t\t\tdoLogin(function () {\n\t\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t\t}, true, true);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t}\n}\n\nfunction doBookingNew(carId, locId, pId, startTime, endTime, el, segmentProps) {\n  segmentProps.id = segmentProps.form_id = 'BookNow';\n  var formGroupName = Segment.getFormGroupName(segmentProps.id);\n  Segment.trackEvent(formGroupName, segmentProps);\n\n\t// call the function that updates the sessionstorage with the selected location's radius and text for use in checkout and payment\n\tupdateZapSession(el);\n\n\t// get uptodate radius from book now button\n\tvar radius = parseFloat($(el).attr('data-radius'));\n\tvar offer_id = $(el).data('offer') || '0';\n\tvar discounted_price = $(el).data('discounted_price') || '0';\n\n\tSegment.trackEvent('Link_Clicked', {\n\t\tis_autoapply: parseInt(discounted_price) > 0 ? true : false,\n\t\tstart_time: segmentProps.starts,\n\t\tend_time: segmentProps.ends,\n\t\tlocation: locId,\n\t\tid: 'AutoApply_Home_BookNow',\n\t\tuser_id: (typeof userEmail !== 'undefined') ? userEmail : null,\n\t})\n\t// passing radius for use in the backend\n\n\tif (!getCookie('authToken')) {\n\t\tdoLogin(function () {\n\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t}, true);\n\t}\n\telse {\n\t\tgetWalletStatus()\n\t\t\t.done(function (response) {\n\n\t\t\t\tif (response.status) {\n\t\t\t\t\tif (response.is_wallet_enabled && !response.is_wallet_connected) {\n\n\t\t\t\t\t\tdoLogin(function () {\n\t\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t\t}, true, true, response.is_wallet_tried);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId + \"&radius=\" + radius + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t}\n}\n\nfunction doBookingNewHD(carId, locId, pId, startTime, endTime, el, pincode,isHD, segmentProps) {\n  segmentProps.id = segmentProps.form_id = 'BookNow';\n  var formGroupName = Segment.getFormGroupName(segmentProps.id);\n\tvar offer_id = $(el).data('offer') || '0';\n\tvar discounted_price = $(el).data('discounted_price') || '0';\n  Segment.trackEvent(formGroupName, segmentProps);\n\n\tif (!getCookie('authToken')) {\n\t\tdoLogin(function () {\n\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId +\"&postalcode=\" + pincode + \"&hd=\" + isHD + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t}, true);\n\t}\n\telse {\n\t\tgetWalletStatus()\n\t\t\t.done(function (response) {\n\n\t\t\t\tif (response.status) {\n\t\t\t\t\tif (response.is_wallet_enabled && !response.is_wallet_connected) {\n\n\t\t\t\t\t\tdoLogin(function () {\n\t\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId +\"&postalcode=\" + pincode + \"&hd=\" + isHD + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t\t}, true, true, response.is_wallet_tried);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\twindow.location = \"bookings/do?car=\" + carId + \"&loc=\" + locId + \"&starts=\" + startTime + \"&ends=\" + endTime + \"&pId=\" + pId +\"&postalcode=\" + pincode + \"&hd=\" + isHD + \"&offer_id=\" + offer_id + \"&discounted_price=\" + discounted_price;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t}\n\n\tSegment.trackEvent('Link_Clicked', {\n\t\tis_autoapply: parseInt(discounted_price) > 0 ? true : false,\n\t\tstart_time: segmentProps.starts,\n\t\tend_time: segmentProps.ends,\n\t\tlocation: locId,\n\t\tid: 'AutoApply_Home_BookNow',\n\t\tuser_id: (typeof userEmail !== 'undefined') ? userEmail : null,\n\t})\n}\n\n\nfunction doBookingNotify(carId, locId) {\n\t\twindow.location = \"/#{@city.link_name.downcase}/bookings/do?car=\" + carId + \"&loc=\" + locId + \"&notify=true\";\n}\n\nfunction getCookie(cname) {\n\t\tvar name = cname + \"=\";\n\t\tvar ca = document.cookie.split(';');\n\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == ' ') c = c.substring(1);\n\t\t\t\tif (c.indexOf(name) != -1) return c.substring(name.length, c.length);\n\t\t}\n}\n\nfunction delCookie(name,path='/') {\n  \tdocument.cookie = name +'=; Path=' + path + '; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n}\n\nfunction getData(complete_url, divId, divAction, divWait, callback, currElement) {\n\t\tif (divWait) {\n\t\t\t\t$(\"#\" + divWait).show();\n\t\t}\n\t\tif(document.URL.search('login') != -1) {\n\t\t\tif(complete_url.search('signup') != -1){\n\t\t\t\tpushEvent('Login','Sign Up', 'Y')\n\t\t\t} else if(complete_url.search('forgot') != -1){\n\t\t\t\tpushEvent('Login','Forgot Password', 'Y')\n\t\t\t} else if(complete_url.search('signin') != -1){\n\t\t\t\tpushEvent('Login','Sign In', 'Y')\n\t\t\t}\n\t\t}\n\t\tvar resp = $.ajax({\n\t\t\t\turl: complete_url,\n\t\t\t\tdataType: \"json\"\n\t\t});\n\t\tresp.done(\n\t\t\t\tfunction(data) {\n\t\t\t\t\t\tif (data[\"alert\"]) {\n\t\t\t\t\t\t\t\talert(data[\"alert\"]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (divId) {\n\t\t\t\t\t\t\t\t\t\tif (divAction) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (divAction == 'append') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).append(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('.arrw-d').show();\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (divAction == 'prepend') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).prepend(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('.arrw-u').show();\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (divAction.indexOf('We were not able to') !== -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$('.fix_error_msg').html(divAction.fontcolor(\"red\"));\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tcallback(currElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$('.help').tooltip();\n\t\t\t\t}\n\t\t);\n\t\tresp.fail(\n\t\t\t\tfunction(jqXHR, textStatus) {\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (jqXHR.getAllResponseHeaders()) {\n\t\t\t\t\t\t\t\talert(\"Request failed, please try again later.\");\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t);\n\t\tif (\"undefined\" != typeof(event)) event.returnValue = false;\n\t\treturn false;\n}\n\nfunction getDataLogin(complete_url, divId, divAction, divWait) {\n\t\tif (divWait) {\n\t\t\t\t$(\"#\" + divWait).show();\n\t\t}\n\t\tif(document.URL.search('login') != -1) {\n\t\t\tif(complete_url.search('signup') != -1){\n\t\t\t\tpushEvent('Login','Sign Up', 'Y')\n\t\t\t} else if(complete_url.search('forgot') != -1){\n\t\t\t\tpushEvent('Login','Forgot Password', 'Y')\n\t\t\t} else if(complete_url.search('signin') != -1){\n\t\t\t\tpushEvent('Login','Sign In', 'Y')\n\t\t\t}\n\t\t}\n\t\tvar resp = $.ajax({\n\t\t\t\turl: complete_url,\n\t\t\t\tdataType: \"json\"\n\t\t});\n\t\tresp.done(\n\t\t\t\tfunction(data) {\n\t\t\t\t\t\tif (data[\"alert\"]) {\n\t\t\t\t\t\t\t\talert(data[\"alert\"]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (divId) {\n\t\t\t\t\t\t\t\t\t\tif (divAction) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (divAction == 'append') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).append(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('.arrw-d').show();\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (divAction == 'prepend') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).prepend(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('.arrw-u').show();\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).fadeOut(\"fast\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).fadeIn(\"fast\");\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$('.help').tooltip();\n\t\t\t\t\t\t// var newsletter = sessionStorage.getItem(\"Newsletter\");\n\t\t\t\t\t\t// if(newsletter) {\n\t\t\t\t\t\t// \tnewsletter_ajax(newsletter);\n\t\t\t\t\t\t// }\n\t\t\t\t}\n\t\t);\n\t\tresp.fail(\n\t\t\t\tfunction(jqXHR, textStatus) {\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (jqXHR.getAllResponseHeaders()) {\n\t\t\t\t\t\t\t\talert(\"Request failed, please try again later.\");\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t);\n\t\tif (\"undefined\" != typeof(event)) event.returnValue = false;\n\t\treturn false;\n}\n\nfunction hideCalculator() {\n\t\t$('#Overlay').toggle('explode');\n}\n\nfunction hideMobile() {\n\t\t$('#MobileRedirect').toggle('explode');\n\t\tgetData('/device?web=1', null, null, null);\n}\n\nfunction formattedDate(date, type) {\n  if (type === \"standard\") {\n    return date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate() + \" \" + date.getHours() + \":\" + date.getMinutes();\n  }\n  else {\n    return (date.getDate() < 10 ? ('0' + date.getDate()) : date.getDate()) + '/' + (date.getMonth() < 9 ? ('0' + (date.getMonth() + 1)) : (date.getMonth() + 1)) + '/' + date.getFullYear() + ' ' + (date.getHours() < 10 ? ('0' + date.getHours()) : date.getHours()) + ':' + (date.getMinutes() < 10 ? ('0' + date.getMinutes()) : date.getMinutes());\n  }\n}\n\nfunction initializeDatePicker() {\n    var d = new Date(jQuery.now());\n    var nd = new Date();\n    if ((d.getHours() >= 0 && d.getHours() < 6) && (enable_full_hours == \"false\")) {\n    \t// sets the starting time from 6:00 clock when the current time is in between 12Am to 6 Am.\n    \t// should set the hours as 5(compulsory) and minutes can be in between 30 to 60 .Using mint formula which is below will make the minutes as 60 i.e One hour will be aded and minutes will be 0 .so ,the time will be 06:00Am\n      d.setHours(5);\n      d.setMinutes(45);\n      nd.setHours(5);\n      nd.setMinutes(45);\n    }\n    nd.setDate(nd.getDate() + 180);\n    var mint = d.getMinutes();\n    mint = (parseInt((mint / 30)) * 30) + 30;\n\n\t\t// Removes the 30 minute selection in case of mobile device\n    if (isMobile()) {\n      if (mint == 30) {\n        mint = 0;\n        var hour = d.getHours() + 1;\n        if (hour >= 24)\n          d.setHours(30);\n        else\n          d.setHours(hour);\n      }\n    }\n    $(\".datetime\").datetimepicker({\n        format: \"dd/mm/yyyy hh:ii\",\n        startDate: d.getFullYear() + \"-\" + (d.getMonth() + 1) + \"-\" + d.getDate() + \" \" + d.getHours() + \":\" + mint,\n        endDate: nd.getFullYear() + \"-\" + (nd.getMonth() + 1) + \"-\" + nd.getDate() + \" \" + nd.getHours() + \":\" + mint,\n        startView: 2,\n        minView: (isMobile() ? 1 : 0),\n        autoclose: true,\n        minuteStep: 30,\n        todayHighlight: true\n    });\n    $(\".datetime#StartAirDateVal\").datetimepicker('setStartDate', d.getFullYear() + \"-\" + (d.getMonth()+1) + \"-\" + (d.getDate()+1) + \" \" + d.getHours() + \":\" + mint);\n    $(\".dob\").datetimepicker({\n        format: \"dd/mm/yyyy\",\n        endDate: d.getDate() + \"/\" + (d.getMonth() + 1) + \"/\" + (d.getFullYear() - window.globals.min_age ),\n        startView: 4,\n        minView: 2,\n        autoclose: true\n    });\n\n\t\t// Auto populate the duration in case of mobile device\n\t\tif (isMobile() && !$('#StartDateResVal').val()) {\n\t\t\td = new Date();\n\t\t\tvar hour = d.getHours() + 6;\n\t\t\tvar minute = '00';\n\t\t\tif (hour == 24) {\n\t\t\t\thour = 23;\n\t\t\t\tminute = '30';\n\t\t\t}\n\t\t\tif (hour > 24 && hour < 30) {\n\t\t\t\thour = 30;\n\t\t\t}\n\t\t\td.setHours(hour);\n      d.setMinutes(minute);\n\t\t\tvar endDate = new Date();\n\t\t\tendDate.setHours(hour + 24);\n      endDate.setMinutes(0);\n\t\t\t$('.datetime').each(function() {\n\t\t\t\t//Below auto populate is not applicable to the airport one way\n\t\t\t\tif ($(this).attr('id').indexOf('Start') !== -1 && $(this).attr('id') != \"StartAirDateVal\") {\n\t\t\t\t\t$(this).val(formattedDate(d, \"custom\"));\n\t\t\t\t}\n\t\t\t\telse if ($(this).attr('id').indexOf('End') !== -1) {\n\t\t\t\t\t$(this).val(formattedDate(endDate, \"custom\"));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n    // Sets the starting date of drop time calendar to 60 minutes more than the pick up time if the pick up time is already set by the user.\n    if ($('#StartDateVal').val() != $('#StartDateVal').attr('dummy-title')) {\n    \t// gets the value of pickup time -- format (12/04/2015 12:00) --\n    \tvar startdate = $('#StartDateVal').val();\n\t\t\tnd = getDateObject(startdate);\n\n    \t// var dtArr = d.split(' ');\n    \t// var dateArr = dtArr[0].split(/\\//g); //splits the first half of time separated by slash character\n    \t// var timeArr = dtArr[1].split(':');\n    \t// Uses the Javascript Date format of Date(year,month,date,hour,minute,second,microsecond);\n    \t// var nd = new Date(parseInt(dateArr[2]),parseInt(dateArr[1])-1,parseInt(dateArr[0]),parseInt(timeArr[0]),parseInt(timeArr[1]),0,0);\n\n\t\t\tnd = nd.getTime()+60*60000; //Adds 60 minutes to pickup time.\n    \tnd = new Date(nd);\n    \t// Sets the minimum value of drop time to 60 minutes + pickup time.\n    \t$('#EndDateVal').datetimepicker('setStartDate', nd.getFullYear() + \"-\" + (nd.getMonth()+1) + \"-\" + nd.getDate() + \" \" + nd.getHours() + \":\" + nd.getMinutes());\n    }\n\n   //  // initializing the start and end date with a time period of 24 hours automatically and start date is 4hrs+current date;\n   //  var prefillDate = new Date();\n   //  prefillDate.setHours(prefillDate.getHours() + 4);\n   //  if(enable_full_hours == \"true\") {\n   //  \tif (prefillDate.getMinutes()<30) {\n\t\t\t//   prefillDate.setMinutes(30);\n\t\t\t// }\n\t\t\t// else{\n\t\t\t// \tprefillDate.setHours(prefillDate.getHours()+1);\n\t\t\t// \tprefillDate.setMinutes(0);\n\t\t\t// }\n   //    $('.box #StartDateVal').val(formattedDate(prefillDate, \"custom\"));\n   //    var preEnd = new Date(prefillDate);\n   //    preEnd.setHours(preEnd.getHours() + 1);\n   //    $('.box #EndDateVal').datetimepicker('setStartDate', formattedDate(preEnd, \"standard\"));\n\t\t\t// prefillDate.setHours(prefillDate.getHours() + 24);\n\t\t\t// $('.box #EndDateVal').val(formattedDate(prefillDate, \"custom\"));\n   //  }\n   //  else {\n\t  //   if(prefillDate.getHours() >=0 && prefillDate.getHours() < 6) {\n\t\t\t// \tprefillDate.setHours(6);\n\t\t\t// \tprefillDate.setMinutes(0);\n\t\t\t// \t$('.box #StartDateVal').val(formattedDate(prefillDate, \"custom\"));\n   //      var preEnd = new Date(prefillDate);\n   //      preEnd.setHours(preEnd.getHours() + 1);\n   //      $('.box #EndDateVal').datetimepicker('setStartDate', formattedDate(preEnd, \"standard\"));\n\t  //   \t//add 24 hours to the end date from the start date;\n\t\t\t// \tprefillDate.setHours(prefillDate.getHours() + 24);\n\t\t\t// \t$('.box #EndDateVal').val(formattedDate(prefillDate, \"custom\"));\n\t\t\t// }\n\t\t\t// else {\n\t\t\t// \tif (prefillDate.getMinutes()<30) {\n\t\t\t// \t\tprefillDate.setMinutes(30);\n\t\t\t// \t}\n\t\t\t// \telse{\n\t\t\t// \t\tprefillDate.setHours(prefillDate.getHours()+1);\n\t\t\t// \t\tprefillDate.setMinutes(0);\n\t\t\t// \t}\n\t\t\t// \t$('.box #StartDateVal').val(formattedDate(prefillDate, \"custom\"));\n   //      var preEnd = new Date(prefillDate);\n   //      preEnd.setHours(preEnd.getHours() + 1);\n   //      $('.box #EndDateVal').datetimepicker('setStartDate', formattedDate(preEnd, \"standard\"));\n\t\t\t// \tprefillDate.setHours(prefillDate.getHours() + 24);\n\t\t\t// \tif (prefillDate.getHours() >= 0 && prefillDate.getHours() < 6) {\n\t\t\t// \t\tprefillDate.setHours(6);\n\t\t\t// \t\tprefillDate.setMinutes(0);\n\t\t\t// \t\t$('.box #EndDateVal').val(formattedDate(prefillDate, \"custom\"));\n\t\t\t// \t}\n\t\t\t// \telse {\n\t\t\t// \t\t$('.box #EndDateVal').val(formattedDate(prefillDate, \"custom\"));\n\t\t\t// \t}\n\t\t\t// }\n   //  }\n\n\n    // Sets the starting date of drop time calendar to 60 minutes more than the pick up time if the pick up time is already set by the user.\n    // For Reschedule page in the MyAccounts Page\n\n    if ($('#StartDateResVal').val() != $('#StartDateResVal').attr('dummy-title')) {\n    \t// gets the value of pickup time -- format (12/04/2015 12:00) --\n    \tvar startdate = $('#StartDateResVal').val();\n\t\t  nd = getDateObject(startdate);\n\t\t  nd = nd.getTime()+60*60000;\n\t  \t// Adds 60 minutes to pickup time.\n    \tnd = new Date(nd);\n    \t// Sets the minimum value of drop time to 60 minutes + pickup time.\n    \t$('#EndDateResVal').datetimepicker('setStartDate', nd.getFullYear() + \"-\" + (nd.getMonth()+1) + \"-\" + nd.getDate() + \" \" + nd.getHours() + \":\" + nd.getMinutes());\n    }\n\n\n    var dropdownCheck = 0;\n    var tariffcheck = -1;\n    $(\".datetimebox\").click(function() {\n        var id = $(this).attr(\"id\");\n        $('#' + id + 'ValError').hide();\n        $('#' + id + 'Val').removeClass('field_with_errors');\n        $('#' + id + 'Val').datetimepicker('show');\n        $('.errorBox').hide();\n        if (id.search('Start') != -1) {\n            $('#' + id + 'Val').removeClass('dateError');\n            $('#' + id).removeClass('dateError');\n            dropdownCheck = 0;\n            if ($('#' + id + 'Val').hasClass('starts-home')) {\n                pushEvent('Homepage Search', 'Starts');\n            } else if ($('#' + id + 'Val').hasClass('starts-nav')) {\n                pushEvent('Search Bar', 'Pickup Dropdown');\n            } else if ($('#' + id + 'Val').hasClass('starts-cal')) {\n            \t\ttariffcheck = 0;\n                pushEvent('Calculator', 'Starts', 'Tariff Page');\n            } else if ($('#' + id + 'Val').hasClass('starts-recal')) {\n                pushEvent('Rescheduler', 'Org Starts');\n            } else if ($('#' + id + 'Val').hasClass('newstarts-recal')) {\n                pushEvent('Rescheduler', 'New Starts');\n            }\n        } else if (id.search('End') != -1) {\n            $('#' + id + 'Val').removeClass('dateError');\n            $('#' + id).removeClass('dateError');\n            dropdownCheck = 1;\n            var pid = id.replace('End', 'Start');\n            if ($('#' + pid + 'Val').val() != $('#' + pid + 'Val').attr('dummy-title')) {\n                $('#' + id + 'Val').datetimepicker('show');\n                if ($('#' + id + 'Val').hasClass('ends-home')) {\n                    pushEvent('Homepage Search', 'Ends');\n                } else if ($('#' + id + 'Val').hasClass('ends-nav')) {\n                    pushEvent('Search Bar', 'Drop Dropdown');\n                } else if ($('#' + id + 'Val').hasClass('ends-cal')) {\n                \t\ttariffcheck = 1;\n                    pushEvent('Calculator', 'Ends', 'Tariff Page');\n                } else if ($('#' + id + 'Val').hasClass('ends-recal')) {\n                    pushEvent('Rescheduler', 'Org Ends');\n                } else if ($('#' + id + 'Val').hasClass('newends-recal')) {\n                    pushEvent('Rescheduler', 'New Ends');\n                }\n            } else {\n              $('#' + pid + 'Val').addClass('dateError');\n              $('.datetimepicker').hide();\n              $('.errorBox').hide();\n              $('#' + pid + 'ValError').html('Please select start date first');\n              $('#' + pid + 'ValError').show();\n            }\n        }\n    });\n\n    $('.datetimepicker-days').click(function() {\n        if (dropdownCheck == 0) {\n        \tif(tariffcheck == 0){\n        \t\tpushEvent('Tariff Page Calculator', 'Pickup Date');\n        \t} else {\n            \tpushEvent('Search Bar', 'Pickup Date');\n            }\n        } else {\n        \t\tif(tariffcheck == 1){\n        \t\t\tpushEvent('Tariff Page Calculator', 'Drop Date');\n        \t\t} else {\n            \tpushEvent('Search Bar', 'Drop Date');\n            }\n        }\n    });\n\n    $('.datetimepicker-hours').click(function() {\n        if (dropdownCheck == 0) {\n        \tif(tariffcheck == 0){\n        \t\tpushEvent('Tariff Page Calculator', 'Pickup Hour');\n        \t}\telse {\n            pushEvent('Search Bar', 'Pickup Hour');\n          }\n        } else {\n        \t\tif(tariffcheck == 1){\n        \t\t\tpushEvent('Tariff Page Calculator', 'Drop Hour');\n        \t\t}\telse {\n            pushEvent('Search Bar', 'Drop Hour');\n          }\n        }\n    });\n\n    $('.datetimepicker-minutes').click(function() {\n        if (dropdownCheck == 0) {\n        \tif(tariffcheck == 0){\n        \t\tpushEvent('Tariff Page Calculator','Pickup Minute');\n        \t}else {\n            pushEvent('Search Bar', 'Pickup Minute');\n          }\n        } else {\n        \t\tif(tariffcheck == 1){\n        \t\t\tpushEvent('Tariff Page Calculator','Drop Minute');\n        \t\t}else {\n           \t\tpushEvent('Search Bar', 'Drop Minute');\n          }\n        }\n    });\n\n    $('.datetime').datetimepicker().on('hide', function(ev) {\n        if (ev.date.valueOf() < jQuery.now().valueOf()) {\n            $('#' + ev.currentTarget.id).val($('#' + ev.currentTarget.id).attr('dummy-title'));\n        }\n    });\n\n    $('.datetime').datetimepicker().on('changeDate', function(ev) {\n    var id = ev.currentTarget.id;\n    var path = window.location.pathname;\n    $(this).addClass(\"dateBold\");\n    if(id.search('Start') != -1) {\n    \t$('#' + id).addClass('dateBold');\n    \t$('#' + id).removeClass('dateError');\n    \tvar divId = id.slice(0, -3);\n    \t$('#' + divId).removeClass('dateError');\n    \t$('#' + divId + 'Val').removeClass('dateError');\n      var d = ev.date;\n      if (id.indexOf('Airport') === -1)\n        $('#StartAirportDateVal').val($('#' + id).val()).addClass('dateBold');\n      d = new Date(d.getTime() - 270*60000);\n      var nid = id.replace('Start','End');\n      if (nid !== 'EndAirDateVal') {\n        $('#' + nid).datetimepicker('setStartDate', formattedDate(d, \"standard\"));\n        $('#' + nid).removeClass('field_with_errors');\n        $('#' + nid + 'Error').hide();\n        $('#' + nid).datetimepicker('show');\n      }\n\t    // Sets the value of End trip ,One hour extra from the start trip in the reschedule page, User can select the time one hour extra more than the start trip.\n\t\t\tif(id == 'StartDateResVal') {\n\t\t\t\tvar newResDate;\n\t\t\t\t// Gets the value of pickup time -- format (12/04/2015 12:00) --\n      \t\t\tvar startDate = $('#StartDateResVal').val();\n\t\t\t\tvar dateArray = splitDate(startDate);\n\t\t\t\tvar startDateDtArr = dateArray[0];\n\t\t\t\tvar startDateTimeArr = dateArray[1];\n\t\t\t\tnewResDate = new Date(parseInt(startDateDtArr[2]),parseInt(startDateDtArr[1])-1,parseInt(startDateDtArr[0]),parseInt(startDateTimeArr[0]),parseInt(startDateTimeArr[1]),0,0);\n\t\t\t\tnewResDate =newResDate.getTime()+60*60000;\n\t\t\t\tnewResDate = new Date(newResDate);\n\t\t\t\tvar new_hour = newResDate.getHours() >=0 && newResDate.getHours() < 6 ? 6 : newResDate.getHours();\n\t\t\t  new_hour = new_hour < 10 ? (\"0\" + new_hour) : new_hour;\n\t\t\t  var new_minutes = newResDate.getMinutes() < 30 ? (\"0\" + newResDate.getMinutes()) : newResDate.getMinutes();\n\t\t\t\t$('#EndDateResVal').val(newResDate.getDate() + \"/\" + (newResDate.getMonth()+1) + \"/\" + newResDate.getFullYear() + \" \" + new_hour + \":\" + new_minutes);\n\t\t\t}\n\t\t\tif(id == 'StartAirDateVal') {\n\t\t\t\t$('#EndAirDateVal').addClass('dateBold');\n\t\t\t\tvar EndAirDate;\n\t\t\t\t// Gets the value of pickup time -- format (12/04/2015 12:00) --\n      \tvar startDate = $('#StartAirDateVal').val();\n\t\t\t\tvar dateArray = splitDate(startDate);\n\t\t\t\tvar startDateDtArr = dateArray[0];\n\t\t\t\tvar startDateTimeArr = dateArray[1];\n\t\t\t\tEndAirDate = new Date(parseInt(startDateDtArr[2]),parseInt(startDateDtArr[1])-1,parseInt(startDateDtArr[0]),parseInt(startDateTimeArr[0]),parseInt(startDateTimeArr[1]),0,0);\n\t\t\t\tEndAirDate =EndAirDate.getTime()+180*60000;\n\t\t\t\tEndAirDate = new Date(EndAirDate);\n\t\t\t\t// can be allowed from 12am to 6 am also\n\t\t\t  new_hour = EndAirDate.getHours() < 10 ? (\"0\" + EndAirDate.getHours()) : EndAirDate.getHours();\n\t\t\t  var new_minutes = EndAirDate.getMinutes() < 30 ? (\"0\" + EndAirDate.getMinutes()) : EndAirDate.getMinutes();\n\t\t\t  var new_month = EndAirDate.getMonth()+1;\n\t\t\t  new_month = new_month < 10 ? (\"0\" + new_month) : new_month;\n\t\t\t  new_date = EndAirDate.getDate() < 10 ? (\"0\" + EndAirDate.getDate()) : EndAirDate.getDate();\n\t\t\t\t$('#EndAirDateVal').val(new_date + \"/\" + new_month + \"/\" + EndAirDate.getFullYear() + \" \" + new_hour + \":\" + new_minutes);\n\t\t\t}\n      // $('.ends-home').datetimepicker().on('changeDate', function(ev) {pushEvent('Homepage Search', 'Ends');});\n      // $('.ends-nav').datetimepicker().on('changeDate', function(ev) {pushEvent('Navigation Search', 'Ends');});\n      if($('#' + id).hasClass('starts-home')) {\n        if(path.split(\"/\")[2] == \"\" || path.split(\"/\")[2] == undefined) {\n          pushEvent(\"Home\",\"Start DateTime\",$(this).val());\n        } else {\n          pushEvent(\"Search\",\"Start DateTime\",$(this).val());\n        }\n      } else if($('#' + id).hasClass('starts-nav')) {\n        if(path.search('login') != -1) {\n          pushEvent(\"Login\",\"Start DateTime\",$(this).val());\n        } else if(path.search('checkout') != -1) {\n          pushEvent(\"Checkout\",\"Start DateTime\",$(this).val());\n        } else if(path.search('search') != -1) {\n          pushEvent(\"Search\",\"Start DateTime\",$(this).val());\n        } else if(path.search('attractions') != -1) {\n          pushEvent(\"Attractions\",\"Start DateTime\",$(this).val());\n        } else {\n          pushEvent(\"Book Cars\",\"Start DateTime\",$(this).val());\n        }\n      } else if($('#' + id).hasClass('starts-cal')){\n        pushEvent('Tariff Calculator', 'Start DateTime', $(this).val());\n      } else if($('#' + id).hasClass('starts-recal')){\n        pushEvent('Trip Modification Estimator', 'Original PickUp Time', $(this).val());\n      } else if($('#' + id).hasClass('newstarts-recal')){\n        pushEvent('Trip Modification Estimator', 'New PickUp Time', $(this).val());\n      } else {\n        pushEvent(\"Book Cars\",\"Start DateTime\",$(this).val());\n      }\n    }\n    else {\n      if (id.indexOf('Airport') === -1)\n        $('#EndAirportDateVal').val($('#' + id).val()).addClass('dateBold');\n      $('#' + id).addClass('dateBold');\n      var divId = id.slice(0, -3);\n      $('#' + divId).removeClass('dateError');\n      $('#' + divId + 'Val').removeClass('dateError');\n      if($('#' + id).hasClass('ends-home')) {\n        if(path.split(\"/\")[2] == \"\" || path.split(\"/\")[2] == undefined) {\n          pushEvent(\"Home\",\"End DateTime\",$(this).val());\n        } else {\n          pushEvent(\"Search\",\"End DateTime\",$(this).val());\n        }\n      } else if($('#' + id).hasClass('ends-nav')) {\n        if(path.search('login') != -1) {\n          pushEvent(\"Login\",\"End DateTime\",$(this).val());\n        } else if(path.search('checkout') != -1) {\n          pushEvent(\"Checkout\",\"End DateTime\",$(this).val());\n        } else if(path.search('search') != -1) {\n          pushEvent(\"Search\",\"End DateTime\",$(this).val());\n        } else if(path.search('attractions') != -1) {\n          pushEvent(\"Attractions\",\"End DateTime\",$(this).val());\n        } else {\n        pushEvent(\"Book Cars\",\"End DateTime\",$(this).val());\n        }\n      } else if($('#' + id).hasClass('ends-cal')){\n        pushEvent('Tariff Calculator', 'End DateTime', $(this).val());\n      } else if($('#' + id).hasClass('ends-recal')){\n        pushEvent('Trip Modification Estimator', 'Original Dropoff Time', $(this).val());\n      } else if($('#' + id).hasClass('newends-recal')){\n        pushEvent('Trip Modification Estimator', 'New Dropoff Time', $(this).val());\n      } else {\n          pushEvent(\"Book Cars\",\"End DateTime\",$(this).val());\n      }\n    }\n  });\n}\n\n\nfunction splitDate(date) {\n\tvar dtArr = date.split(' ');\n\tvar dateArr = dtArr[0].split(/\\//g);\n\t// splits the first half of time separated by slash character\n\tvar timeArr = dtArr[1].split(':');\n\treturn [dateArr, timeArr];\n}\n// Global variable.Used for calculating the time gap in between start date and end date ,will be used for updating automatically.\nvar timeperiod =0;\n\nfunction initializeHdDatePicker(val) {\n\tvar d = new Date();\n\tvar required_time = new Date();\n\tvar chauffeur = val ? val : '';\n\n\tvar status = \"true\";\n\n\t// throw error if the pickup time is less than HD prep minutes from the current time //\n\tif ($('#Start'+chauffeur+'DateVal').val() != $('#Start'+chauffeur+'DateVal').attr('dummy-title')) {\n\t\tvar startDate = $('#Start'+chauffeur+'DateVal').val(); //gets the value of pickup time -- format (12/04/2015 12:00) --\n\n\t\tvar dateArray = splitDate(startDate);\n\t\tvar startDateDtArr = dateArray[0];\n\t\tvar startDateTimeArr = dateArray[1];\n\n\t\t// Uses the Javascript Date format of Date(year,month,date,hour,minute,second,microsecond) //\n\t\tstartDate = new Date(parseInt(startDateDtArr[2]),parseInt(startDateDtArr[1])-1,parseInt(startDateDtArr[0]),parseInt(startDateTimeArr[0]),parseInt(startDateTimeArr[1]),0,0);\n\t\tstartDate =  startDate.getTime();\n\n\t\tif(chauffeur == '') {\n\t\t\t//========TAKING THE END DATE FOR CALCULATING THE TIME PERIOD==================//\n\t\t\tvar endDate = $('#EndDateVal').val(); // gets the value of pickup time -- format (12/04/2015 12:00) --\n\t\t\tvar dateArray = splitDate(endDate);\n\t\t\tvar endDateDtArr = dateArray[0];\n\t\t\tvar endDateTimeArr = dateArray[1];\n\n\t\t\t// Uses the Javascript Date format of Date(year,month,date,hour,minute,second,microsecond) //\n\t\t\tendDate = new Date(parseInt(endDateDtArr[2]),parseInt(endDateDtArr[1])-1,parseInt(endDateDtArr[0]),parseInt(endDateTimeArr[0]),parseInt(endDateTimeArr[1]),0,0);\n\t\t\tendDate =  endDate.getTime();\n\t\t\ttimeperiod = endDate - startDate;\n\t\t\t//================================END=====================================================//\n\t\t}\n\n\t\t// get the current hour //\n\t\tvar prepDuration = chauffeur? 5 : parseInt(window.globals.hd_working_hours);\n\t\tvar hour = d.getHours();\n\t\tif (hour >= (24 - prepDuration)) {\n\t\t\tif(chauffeur == '') {\n\t\t\t\t//Adds HD preparation time hrs and 0 non-working hrs to current time.\n\t\t\t\tif(enable_full_hours == \"false\") {\n\t\t\t\t\tvar req_hrs = (hour + (6 + prepDuration)) % 24;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar req_hrs = (hour + (0 + prepDuration)) % 24;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t//Adds chauffeur preparation time hrs to current time.\n\t\t\t\tvar req_hrs = (hour + prepDuration) % 24;\n\t\t\t}\n\n\t\t\t// Set next day\n  \t\trequired_time.setDate( d.getDate() + 1 );\n  \t\trequired_time.setHours(req_hrs);\n\t\t}\n\t\telse if (hour < 6) {\n\t\t\tif(chauffeur == '') {\n\t\t\t\t// for hd adding 6 non-working hrs\n\t\t\t\tif(enable_full_hours == \"false\") {\n\t\t\t\t\trequired_time.setHours(6 + prepDuration);\n\t\t\t\t\trequired_time.setMinutes(0);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\trequired_time.setHours(d.getHours() + prepDuration);\n\t\t\t\t\tif(d.getMinutes() <= 30) {\n\t\t\t\t\t\trequired_time.setMinutes(30);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\trequired_time.setHours(required_time.getHours() + 1);\n\t\t\t\t\t\trequired_time.setMinutes(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// for chauffeurdoChauffeurBooking\n\t\t\t\tif(hour >= 1 ) {\n\t\t\t\t\trequired_time.setHours(prepDuration + hour);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\trequired_time.setHours(prepDuration);\n\t\t\t\t}\n\t\t\t\tif(d.getMinutes() <= 30) {\n\t\t\t\t\trequired_time.setMinutes(30);\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}\n\t\telse {\n\t\t\t //Adds 3 hrs to current time.\n\t\t\trequired_time.setHours(d.getHours() + prepDuration);\n\t\t}\n\t\tif(hour >= 6) {\n\t\t\tif(d.getMinutes() <= 30) {\n\t\t\t\trequired_time.setMinutes(30);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(enable_full_hours == \"false\") {\n\t\t\t\t\tif ((d.getHours() + prepDuration + 1) == 24 ) {\n\t\t\t\t\t //this is for not getting 00:00 (comes when we select the time at 9:00pm for home deleivery)\n\t\t\t\t\t\trequired_time.setHours(6);\n\t\t\t\t\t\trequired_time.setDate( d.getDate() + 1 );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\trequired_time.setHours(required_time.getHours() + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t//enabling the time from 12am to 6 am also\n\t\t\t\t\trequired_time.setHours(required_time.getHours() + 1);\n\t\t\t\t}\n\t\t\t\trequired_time.setMinutes(0);\n\t\t\t}\n\t\t}\n\t\trequired_time.setSeconds(0);\n\t\trequired_time.setMilliseconds(0);\n\t\tvar reqTime = required_time.getTime();\n\t\tif (startDate < reqTime && $('#hdEnable').val() == '1') {\n\t\t\tstatus = \"false\";\n\t\t\tvar date = required_time.getDate() < 10 ? (\"0\" + required_time.getDate()) : required_time.getDate();\n\t\t\tvar month = required_time.getMonth() + 1;\n\t\t\tmonth = month < 10 ? (\"0\" + month) : month;\n\t\t\tvar year = required_time.getFullYear();\n\t\t\tvar hours = required_time.getHours() < 10 ? (\"0\" + required_time.getHours()) : required_time.getHours();\n\t\t\tvar minutes = required_time.getMinutes() < 10 ? (\"0\" + required_time.getMinutes()) : required_time.getMinutes();\n\n\t\t\t// check for chauffeur driven to avoid time in between 00 hrs and 6hrs for MVP phase\n\t\t\tif(chauffeur && hours < 6) {\n\t\t\t\thours = \"06\";\n\t\t\t\tminutes = \"00\";\n\t\t\t}\n\n\t\t\t// set time in same format as is in the datetime box //\n\t\t\tvar time = date + \"/\" + month + \"/\" + year + \" \" + hours + \":\" + minutes;\n\n\t\t\t$('.errorBox').hide();\n\t\t\t$('#Start'+chauffeur+'DateValError').show();\n\t\t\t$('#Start'+chauffeur+'Date').removeClass('dateBold').addClass('dateError');\n\t\t\t$('#Start'+chauffeur+'DateVal').removeClass('dateBold').addClass('dateError');\n\t\t\t$('#Start'+chauffeur+'DateValError').html('<span>We need <span id =\"chauffeurWorkingHours\"></span> working hours to process a Chauffeur driven service.</span></br></br> <span> Earliest service available at: </span><br/> <span id=\"chauffeurTime\" onclick=\"setHdStartDate(this.id, \\'Chauffeur\\')\"></span>');\n\t\t\t$('#StartDateValError').html('<span>We need <span id =\"hdWorkingHours\"></span> working hours to process a Doorstep delivery.</span></br></br> <span> Earliest delivery available at: </span><br/> <span id=\"hdTime\" onclick=\"setHdStartDate(this.id)\"></span>');\n\t\t\tif(chauffeur == '') {\n\t\t\t\t$('#hdWorkingHours').html(prepDuration);\n\t\t\t\t$('#hdTime').html(time);\n\t\t\t}else{\n\t\t\t\t$('#chauffeurWorkingHours').html(prepDuration);\n\t\t\t\t$('#chauffeurTime').html(time);\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t}\n}\n\nfunction removeHDErrorBox() {\n\t$('.errorBox').hide();\n\t$('#StartDateValError').html('');\n}\n\nfunction setHdStartDate(id, val){\n\tvar startDate = $('#'+id).html();\n\tvar chauffeur = val? val : '';\n\t$('#Start'+chauffeur+'Date').removeClass('dateError');\n\t$('#Start'+chauffeur+'DateVal').removeClass('dateError');\n\t$('#Start'+chauffeur+'DateVal').addClass('dateBold');\n\t$('#Start'+chauffeur+'DateVal').val(startDate);\n\t//===========Set Of One Hour extra for datetimepicker at the Endtime of HD Booking===============//\n\t//gets the value of pickup time -- format (12/04/2015 12:00) --\n\tvar startdate = $('#Start'+chauffeur+'DateVal').val();\n\tif(chauffeur == '') {\n\t\tnewDate = getDateObject(startdate);\n\t\t// current time and it is used for updating the endtrip automatically using timeperiod variable which is already stored\n\t\tvar new_EndDateval = newDate.getTime();\n\t\t//Adds 60 minutes to pickup time.\n\t  newDate = newDate.getTime()+60*60000;\n\t  newDate = new Date(newDate);\n\t\t//Sets the minimum value of drop time to 60 minutes + pickup time.\n\t  $('#EndDateVal').datetimepicker('setStartDate', newDate.getFullYear() + \"-\" + (newDate.getMonth()+1) + \"-\" + newDate.getDate() + \" \" + newDate.getHours() + \":\" + newDate.getMinutes());\n\t\t//===============================END=========================================//\n\t  //automatically it updates the endtrip time .\n\t  new_EndDateval = new_EndDateval+ timeperiod;\n\t  new_EndDateval = new Date(new_EndDateval);\n\t  var new_date = new_EndDateval.getDate() < 10 ? (\"0\" + new_EndDateval.getDate()) : new_EndDateval.getDate();\n\t  if(enable_full_hours == \"true\") {\n\t  \tvar new_hour = new_EndDateval.getHours() < 10 ? (\"0\" + new_EndDateval.getHours()) : new_EndDateval.getHours();\n\t  \tvar new_minutes = new_EndDateval.getMinutes() < 30 ? (\"0\" + new_EndDateval.getMinutes()) : new_EndDateval.getMinutes();\n\t  }\n\t  else {\n\t  \tvar new_hour = new_EndDateval.getHours() >=0 && new_EndDateval.getHours() < 6 ? 6 : new_EndDateval.getHours();\n\t\t    new_hour = new_hour < 10 ? (\"0\" + new_hour) : new_hour;\n\t\t\tvar new_minutes = new_EndDateval.getHours() >=0 && new_EndDateval.getHours() < 6 ? 0 : new_EndDateval.getMinutes();\n\t      new_minutes = new_minutes < 30 ? (\"0\" + new_minutes) : new_minutes;\n\t  }\n\t\tvar new_months = (new_EndDateval.getMonth()+1) < 10 ? (\"0\" + (new_EndDateval.getMonth()+1)) : (new_EndDateval.getMonth()+1);\n\t  $('#EndDateVal').val(new_date + \"/\" + new_months + \"/\" + new_EndDateval.getFullYear() + \" \" + new_hour + \":\" + new_minutes);\n\t}else {\n\t\t$('#StartChauffeurDateValError').html('');\n\t}\n\n    //===========END==========//\n\n\tremoveHDErrorBox();\n}\n\n$(function() {\n\t$('#StartDateVal').focus(function() {\n\t\tremoveHDErrorBox();\n\t});\n\n\t$('#EndDateVal').focus(function() {\n\t\t$('#EndDate').removeClass('dateError');\n\t\tremoveHDErrorBox();\n\t});\n\n\t$('#hdlocation').focus(function(){\n\t\t$('#Locations').removeClass('hdError');\n\t});\n});\n\nfunction zapLogOut() {\n\tdocument.cookie = `zapRequest=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.${window.location.host.replace('www.','')}`;\n\tdocument.cookie = `zapRequestId=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.${window.location.host.replace('www.','')}`;\n\tdocument.cookie = `zapSubscribeSalePayment=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.${window.location.host.replace('www.','')}`;\n\tdocument.cookie = `zapSubscribeStep=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.${window.location.host.replace('www.','')}`;\n\tdocument.cookie = `authToken=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain=.${window.location.host.replace('www.','')}`;\n\tdocument.cookie = `zapRequest=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n\tdocument.cookie = `zapRequestId=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n\tdocument.cookie = `zapSubscribeSalePayment=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n\tdocument.cookie = `zapSubscribeStep=;path=/zap;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n\tdocument.cookie = `authToken=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;`;\n\tfetch(`/users/sign_out`,{\n\t\tcredentials: 'include'\n\t}).then(r => {\n\t\twindow.location = '/zap/subscribe';\n\t})\n}\n\nfunction logOut(url) {\n\tgetData(url, 'JsResponse', 'replace', null);\n\tdelCookie('authToken');\n}\n\nfunction mapZoom(map, newVal) {\n\t\t$(\"#ZoomMinus\").removeClass('box-inactive');\n\t\t$(\"#ZoomMinus\").addClass('box-active');\n\t\t$(\"#ZoomPlus\").removeClass('box-inactive');\n\t\t$(\"#ZoomPlus\").addClass('box-active');\n\t\tvar minVal = 10;\n\t\tvar maxVal = 16;\n\t\tif (newVal > minVal && newVal < maxVal) {\n\t\t\t\tmap.setZoom(newVal);\n\t\t} else if (newVal <= minVal) {\n\t\t\t\tcurVal = minVal;\n\t\t\t\tmap.setZoom(minVal);\n\t\t\t\t$(\"#ZoomMinus\").removeClass('box-active');\n\t\t\t\t$(\"#ZoomMinus\").addClass('box-inactive');\n\t\t} else if (newVal >= maxVal) {\n\t\t\t\tcurVal = maxVal;\n\t\t\t\tmap.setZoom(maxVal);\n\t\t\t\t$(\"#ZoomPlus\").removeClass('box-active');\n\t\t\t\t$(\"#ZoomPlus\").addClass('box-inactive');\n\t\t}\n\t\treturn false;\n}\n\n//==================== google map for home deliver on the home page ================//\n\nvar map = '';\nvar marker = '';\n\n$(function() {\n\t// when the hd modal opens initialize the map //\n\t$('#hdModal').on('shown.bs.modal', function() {\n\t\t(function isMapLoaded() {\n\t\t\tif (map !== \"\") {\n\t\t\t\tgoogle.maps.event.trigger(map, \"resize\");\n\t\t\t\tmap.setCenter(marker.getPosition());\n\t\t\t\tif (window.mapSearchSuggestionInit()) {\n\t\t\t\t\twindow.mapSearchSuggestionInit();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\twindow.setTimeout(isMapLoaded, 500);\n\t\t\t}\n\t\t})();\n\t});\n\n\t// when the hd modal closes uncheck the hd checkbox\n\t// and reset the address\n\t$('#hdModal').on('hidden.bs.modal', function() {\n\t\t$('.navbar-fixed-top').css(\"z-index\",\"1030\");\n\t\t$('.animateSearch').css('z-index','1010');\n\t\t// if ($('#hdCheckbox').is(':checked')){\n\t\t// \t$('#hdCheckbox').prop('checked',false);\n\t\t// \t$('#mapAddHash').val('');\n\t\t// \t$('#hdEnable').val('0');\n\t\t// \t$('#lat').val('');\n\t\t// \t$('#long').val('');\n\t\t// }\n\n\t\tsetLocationValue();\n\t});\n\n\t// preventing default press of enter to trigger the form submit\n\t// when selecting the location from google map dropdown\n\t$('#map_search_input').keydown(function (e) {\n\t  if (e.which == 13 && $('.pac-container:visible').length) return false;\n\t});\n\n\t$('#textLocations').keydown(function (e) {\n\t  if (e.which == 13 && $('.pac-container:visible').length) return false;\n\t});\n\n\t// select complete text of the search box in map modal //\n\t$('#hdModalContent').on('click', '#map_search_input', function(){\n\t\tthis.select();\n\t});\n\n\t// select complete text of address textarea //\n\t$('#newAddress').on('click', function(){\n\t\tthis.select();\n\t});\n});\n\n// find the address of selected location when the marker\n// is moved on the map\nfunction geocodePosition(pos, flag, callback) {\n\tvar geocoder = new google.maps.Geocoder();\n\tvar latlng = {lat: pos.lat(), lng: pos.lng()};\n\n  geocoder.geocode({\n    'location': latlng\n  }, function(responses) {\n    if (responses && responses.length > 0) {\n\n      getLocationAddress(responses[0]);\n\n      if (!flag) {\n        updateMarkerAddress(responses[0].formatted_address);\n      }\n\n    } else {\n      updateMarkerAddress('Cannot determine address at this location.');\n      updateMarkerPosition(pos);\n    }\n    if (callback) callback(responses);\n  });\n}\n\nfunction updateMarkerAddress(str) {\n  document.getElementById('map_search_input').value = str; // updating the search input\n  setLocationValue(); // setting the value of location in the search widget //\n}\n\n// setting the latitude n longitude of the place that will be\n// required for search query\nfunction updateMarkerPosition(latlng) {\n\t$('#lat').val(latlng.lat());\n\t$('#long').val(latlng.lng());\n}\n\n// get the complete details for the searched location and pass it to the form params //\nfunction getLocationAddress(place) {\n\tvar address = '';\n\n\tif (place.address_components) {\n\t\t// Get each component of the address from the place details\n\t\tvar addressHash = {};\n\t\tfor (var i = 0; i < place.address_components.length; i++) {\n\t\t\tvar addressType = place.address_components[i].types[0];\n\t\t\taddressHash[addressType] = place.address_components[i].long_name;\n\t\t}\n\t}\n\taddressHash = JSON.stringify(addressHash);\n\t$('#mapAddHash').val(encodeURIComponent(addressHash));\n\n}\n\n// Search header for HD //\nfunction openMapModal(callback) {\n\t// check if start and end date is present //\n\tvar start = $('#StartDateVal').val();\n\tvar end = $('#EndDateVal').val();\n\n\t$('.errorBox').hide();\n\t$('#hdlocation #Locations').removeClass('dateError');\n\t$('#locationHDError').html('');\n\n\tif (start == ($('#StartDateVal').attr('dummy-title')) ) {\n\t\t$('#hdCheckbox').prop('checked', false);\n\n\t\t// open the start datetime picker //\n\t\t$('#StartDateVal').datetimepicker('show');\n\n\t\t// red border for the datebox if its empty //\n\t\t$('#StartDate').addClass('dateError');\n\t\t$('#StartDateVal').addClass('dateError');\n\t}\n\telse if (end == ($('#EndDateVal').attr('dummy-title'))) {\n\t\t$('#hdCheckbox').prop('checked', false);\n\n\t\t// open the end datetime picker //\n\t\t$('#EndDateVal').datetimepicker('show');\n\n\t\t// red border for the datebox if its empty //\n\t\t$('#EndDate').addClass('dateError');\n\t\t$('#EndDateVal').addClass('dateError');\n\t}\n\telse {\n\t\tvar status = initializeHdDatePicker();\n\n\t\tif (status ==  \"true\") {\n\t\t\tshowHDModal('/users/hdMap', callback);\n\t\t}\n\n\t}\n\n}\n\nfunction openSearchMapModal(callback) {\n\tshowHDModal('/users/searchMap', callback);\n}\n\n\n// maintaining a counter so as to set pushEvent only once in case of\n// allowing/disabling location service\n// var counter=0;\nvar googleWait = false;\nfunction initializeHDMap(page, prefillCoordinate) {\n\tif($('#hdCheckbox').is(':checked')) {\n\t\t$('.mapInstruction p').text('Please place the pin at the delivery location');\n\t}\n\telse{\n\t\t$('.mapInstruction p').text('Please enter the locality where you need the car');\n\t}\n\tif (typeof google !== 'undefined') {\n\t\tvar lat = parseFloat($('#map_input').attr(\"data-lat\"));\n\t\tvar lng = parseFloat($('#map_input').attr(\"data-lng\"));\n\n\t\tvar latLng = new google.maps.LatLng(lat, lng);\n\t\tvar mapCanvas = document.getElementById('hdmap');\n\n\t\tvar current_zoom = (page == \"search\" ? 13 : 15);\n\n\t\t// If there's no canvas, then return\n\t\tif (!mapCanvas) return;\n\n\t\tvar myOptions = {\n\t\t\tcenter: latLng,\n\t\t\tzoom: (page == \"search\" ? 13 : 15),\n\t\t\tscrollwheel: false,\n\t\t\tstreetViewControl: false,\n\t\t\tmapTypeControl: false,\n\t\t\tzoomControl: !isMobile(),\n\t\t\tpanControl: false,\n\t\t\tzoomControlOptions: {\n\t\t\t\tstyle: google.maps.ZoomControlStyle.DEFAULT,\n\t\t\t\tposition: (page === \"search\" ? google.maps.ControlPosition.RIGHT_CENTER : google.maps.ControlPosition.RIGHT_BOTTOM)\n\t\t\t},\n\t\t\tmapTypeId: google.maps.MapTypeId.ROADMAP\n\t\t};\n\t\tmap = new google.maps.Map(mapCanvas, myOptions);\n\n\t\tvar input = document.getElementById('map_search_input');\n\n\t\tvar geolocation = {\n\t\t\tlat: lat,\n\t\t\tlng: lng\n\t\t};\n\n\t\tvar circle = new google.maps.Circle({\n\t\t\tcenter: geolocation,\n\t\t\tradius: 1000\n\t\t});\n\t\tvar options = {\n\t\t\tcomponentRestrictions: {country: 'in'}\n\t\t};\n\n\t\tvar autocomplete = new google.maps.places.Autocomplete(input, options);\n\t\t// autocomplete.setTypes(['geocode']);\n\t\t// autocomplete.bindTo('bounds', map);\n\t\tautocomplete.setBounds(circle.getBounds());\n\n\t\tmarker = new google.maps.Marker({\n\t\t\ticon: window.globals.map_location_pin,\n\t\t\tmap: map,\n\t\t\tposition: latLng,\n\t\t\tanimation: google.maps.Animation.DROP,\n\t\t\tdraggable: true\n\t\t});\n\n\t\tif (page === \"search\") marker.setVisible(false);\n\n\t\tif (page == \"search\") {\n\t\t\t// getting location after dragging the map\n\t\t\tgoogle.maps.event.addListener(map, \"dragend\", function (event) {\n\t\t\t\tvar point = map.getCenter();\n\t\t\t\tgeocodePosition(point);\n\t\t\t\tupdateMarkerPosition(point);\n\t\t\t\tmap.setCenter(point);\n\n\t\t\t\t// set flag for segment, either marker or place selection\n\t\t\t\t$('.set_location').attr(\"data-update\", \"marker\");\n\t\t\t});\n\n\t\t\tgoogle.maps.event.addDomListener(map,'zoom_changed', function() {\n\t\t  \tvar zoom =  map.getZoom();\n\n\t\t\t\tif(zoom > current_zoom){\n\t\t\t\t\t// segment for ZoomIn\n\t\t\t\t\tvar data_obj = {id: \"ZoomIn\"};\n\t\t\t\t\tjQuery.extend(data_obj, Segment.getSearchProperties());\n\t\t\t\t\tSegment.trackEvent('Link_Clicked', data_obj);\n\t\t\t\t}\n\n\t\t\t\telse{\n\t\t\t\t\t// segment for ZoomOut\n\t\t\t\t\tvar data_obj = {id: \"ZoomOut\"};\n\t\t\t\t\tjQuery.extend(data_obj, Segment.getSearchProperties());\n\t\t\t\t\tSegment.trackEvent('Link_Clicked', data_obj);\n\t\t\t\t}\n\n\t\t\t\tcurrent_zoom = zoom;\n\t\t\t});\n\t\t} else {\n\t\t\t// getting location after dragging the location marker //\n\t\t\tgoogle.maps.event.addListener(marker, \"dragend\", function (event) {\n\t\t\t\tvar point = marker.getPosition();\n\t\t\t\tmarker.setVisible(true);\n\t\t\t\tgeocodePosition(point);\n\t\t\t\tupdateMarkerPosition(point);\n\t\t\t\tif (isMobile() || page == \"search\") {\n\t\t\t\t\tmap.setCenter(point);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// getting location after autocomplete of the location in the Search bar //\n\t\tgoogle.maps.event.addListener(autocomplete, 'place_changed', function () {\n\n\t\t\t// set flag for segment, either marker or place selection\n\t\t\t$('.set_location').attr(\"data-update\", \"places\");\n\n\t\t\tmarker.setVisible(false);\n\t\t\tvar place = autocomplete.getPlace();\n\t\t\tif (!place.geometry) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// expandViewportToFitPlace(map, place);\n\t\t\t// If the place has a geometry, then present it on a map.\n\t\t\tif (place.geometry.viewport) {\n\t\t\t\tmap.fitBounds(place.geometry.viewport);\n\t\t\t} else {\n\t\t\t\tmap.setCenter(place.geometry.location);\n\t\t\t\tmap.setZoom(15);  // Why 15? Because it looks good.\n\t\t\t}\n\n\t\t\tmarker.setPosition(place.geometry.location);\n\t\t\tif (page !== \"search\") marker.setVisible(true);\n\t\t\tmap.setCenter(place.geometry.location);\n\n\t\t\t/*********************************************************************/\n\t\t\t/* var address contain your autocomplete address *********************/\n\t\t\t/* place.geometry.location.lat() && place.geometry.location.lat() ****/\n\t\t\t/* will be used for current address latitude and longitude************/\n\t\t\t/*********************************************************************/\n\n\t\t\tupdateMarkerPosition(place.geometry.location);\n\t\t\tgeocodePosition(place.geometry.location, true);\n\t\t\t$('.overlay').hide();\n\t\t\t$('.noLocationText').hide();\n\n\t\t\t// Save recent searches\n\t\t\tvar lat = place.geometry.location.lat()\n\t\t\t\t, lng = place.geometry.location.lng();\n\n\t\t\tif (localStorage.recent_address_searches) {\n\t\t\t\tvar recent_addresses = JSON.parse(localStorage.recent_address_searches);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar recent_addresses = [];\n\t\t\t}\n\n\t\t\t// First search for the address in the current recent\n\t\t\t// list and see if it already exists so that we\n\t\t\t// don't do anything.\n\t\t\tvar results = $.grep(recent_addresses, function (e) {\n\t\t\t\treturn e.formatted_address == place.formatted_address;\n\t\t\t});\n\n\t\t\tif (!results.length) {\n\t\t\t\trecent_addresses.unshift({formatted_address: place.formatted_address, lat: lat, lng: lng});\n\t\t\t\t// Save only recent 3 addresses\n\t\t\t\trecent_addresses = recent_addresses.splice(0, 3);\n\n\t\t\t\tlocalStorage.recent_address_searches = JSON.stringify(recent_addresses);\n\t\t\t}\n\t\t\t$('#hdBookNow button, .bookingDiv button').prop('disabled', false).removeClass('bg-9');\n\t\t});\n\n\t\tsetLocationValue();\n\n\t\t// get the current location of the user if he clicks on locate or opens map\n\t\tvar currentLocationSuccess = function (position) {\n\t\t\tupdateLocation(position);\n\n\t\t\t$('.locateDiv').show();\n\t\t\t$('.search_current_location').show();\n\t\t\t$('.tagged_addresses .current_location').show();\n\t\t\t// if (counter ==1) {\n\t\t\t// \tpushEvent('Doorstep Monitoring', 'Location Service', 'Allow');\n\t\t\t// }\n\t\t}\n\n\t\tvar updateLocation = function (position) {\n\t\t\tvar geolocate = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n\n\t\t\tif (page !== \"search\") marker.setVisible(true);\n\t\t\tmarker.setPosition(geolocate);\n\t\t\tgeocodePosition(geolocate);\n\t\t\tupdateMarkerPosition(geolocate);\n\t\t\tmap.setCenter(geolocate);\n\t\t\t$('.overlay').hide();\n\t\t\t$('.noLocationText').hide();\n\n\t\t\t$('#map_search_suggestion').hide();\n\n\t\t\tvar geolocation = {\n\t\t\t\tlat: position.coords.latitude,\n\t\t\t\tlng: position.coords.longitude\n\t\t\t};\n\n\t\t\tvar circle = new google.maps.Circle({\n\t\t\t\tcenter: geolocation,\n\t\t\t\tradius: 5000\n\t\t\t});\n\t\t\tautocomplete.setBounds(circle.getBounds());\n\t\t}\n\n\t\tvar currentLocationFailure = function (error) {\n\t\t\tvar recent_address;\n\t\t\tif (localStorage.recent_address_searches) {\n\t\t\t\trecent_address = JSON.parse(localStorage.recent_address_searches);\n\t\t\t}\n\t\t\tvar lat;\n\t\t\tvar lng;\n\t\t\t// if lat & lng is present then show the pin else show the overlay //\n\t\t\t// and ask the user to change location settings //\n\t\t\tif (recent_address && recent_address[0]) {\n\t\t\t\tlat = recent_address[0].lat;\n\t\t\t\tlng = recent_address[0].lng;\n\t\t\t\tvar position = {\n\t\t\t\t\tcoords: {\n\t\t\t\t\t\tlatitude: lat,\n\t\t\t\t\t\tlongitude: lng\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tupdateLocation(position);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('.overlay').show();\n\t\t\t\t$('#locDisableText').html(\"Sorry, we are not able to find your location.\");\n\t\t\t\t$('#locDisableSubText').css(\"display\", \"block\");\n\t\t\t\t$('.noLocationText').show();\n\t\t\t\t$('.tagged_addresses .current_location').hide();\n\t\t\t\t$('.locateDiv').hide();\n\t\t\t\t$('.search_current_location').hide();\n\t\t\t\t$('#hdBookNow button, .bookingDiv button').prop('disabled', true).addClass('bg-9');\n\t\t\t}\n\t\t\t// if (counter==1) {\n\t\t\t// \tconsole.log(\"location denied\");\n\t\t\t// \tpushEvent('Doorstep Monitoring', 'Location Service', 'Block');\n\t\t\t// }\n\t\t}\n\t\t// counter++;\n\t\tif (page == \"search\" && prefillCoordinate) {\n\t\t\tvar position = {\n\t\t\t\tcoords: {\n\t\t\t\t\tlatitude: parseFloat(prefillCoordinate.lat),\n\t\t\t\t\tlongitude: parseFloat(prefillCoordinate.lng)\n\t\t\t\t}\n\t\t\t};\n\t\t\tnavigator.geolocation.getCurrentPosition(function () {\n\t\t\t\t$('.locateDiv').show();\n\t\t\t\t$('.tagged_addresses .current_location').show();\n\n\t\t\t\t// segment for LocateMe\n\t\t\t\tvar data_obj = {id: \"LocateMe\"};\n\t\t\t\tjQuery.extend(data_obj, Segment.getSearchProperties());\n\t\t\t\tSegment.trackEvent('Link_Clicked', data_obj);\n\t\t\t});\n\t\t\tupdateLocation(position);\n\t\t}\n\t\telse if (localStorage.recent_address_searches) {\n\t\t\tvar recent_address = JSON.parse(localStorage.recent_address_searches);\n\t\t\tvar position = {\n\t\t\t\tcoords: {\n\t\t\t\t\tlatitude: recent_address[0].lat,\n\t\t\t\t\tlongitude: recent_address[0].lng\n\t\t\t\t}\n\t\t\t};\n\t\t\tnavigator.geolocation.getCurrentPosition(function () {\n\t\t\t\t$('.locateDiv').show();\n\t\t\t\t$('.search_current_location').show();\n\t\t\t\t$('.tagged_addresses .current_location').show();\n\t\t\t});\n\t\t\tupdateLocation(position);\n\t\t}\n\t\telse {\n\t\t\tnavigator.geolocation.getCurrentPosition(currentLocationSuccess, currentLocationFailure);\n\t\t}\n\n\t\t$('body').on('click', '.tagged_addresses .tagged_address, .recent_search_addresses a', function () {\n\t\t\tvar $el = $(this);\n\n\t\t\tvar lat = $el.data('lat');\n\t\t\tvar lng = $el.data('lng');\n\n\t\t\tvar position = {\n\t\t\t\tcoords: {\n\t\t\t\t\tlatitude: lat,\n\t\t\t\t\tlongitude: lng\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tupdateLocation(position);\n\t\t\t$('#map_search_suggestion').hide();\n\t\t});\n\n\t\t$('body').on('click', '.tagged_addresses .current_location', function () {\n\t\t\tnavigator.geolocation.getCurrentPosition(currentLocationSuccess, currentLocationFailure);\n\t\t\t$('#map_search_suggestion').hide();\n\t\t});\n\n\t\t$('.locateMap, .search_current_location').on('click', function () {\n\t\t\tnavigator.geolocation.getCurrentPosition(currentLocationSuccess, currentLocationFailure);\n\t\t});\n\n\t\tif (getCookie(\"abtestz2\") === \"1\" && $('#hdEnable').val() === '0' && map !== \"\") {\n\t\t\tinitializeSearchMap();\n\t\t}\n\t}\n\telse{\n\t\tif(!googleWait) {\n\t\t\tgoogleWait = true;\n\t\t\tsetTimeout(function () {\n\t\t\t\t$(document).ready(function(){\n\t\t\t\t\tinitializeHDMap(page, prefillCoordinate);\n\t\t\t\t});\n\t\t\t}, 3000);\n\t\t}\n\t}\n}\n\nfunction initializeHDVueMap(lat, lng) {\n\tdocument.querySelector('.map_container').style.height = (document.querySelector('.maplocation_container').clientHeight\n\t\t\t\t\t\t\t\t\t\t- document.querySelector('.maplocation_container .pullover_title').clientHeight) + 'px';\n\tdocument.querySelector('#hdmap').style.height = (document.querySelector('.mobileHDMap').clientHeight\n\t\t\t\t\t\t\t\t\t\t\t- document.querySelector('#map_input').clientHeight) + 'px';\n\tif (typeof lat !== 'undefined' && typeof lng !== 'undefined') {\n\t\tvar prefillCoordinate = {\n\t\t\tlat: lat,\n\t\t\tlng: lng\n\t\t};\n\t\tinitializeHDMap('search', prefillCoordinate);\n\t} else {\n\t\tinitializeHDMap('search');\n\t}\n\n}\n\nwindow.mapSearchSuggestionInitVue = function () {\n\tvar $input_box = $('#map_input');\n\tvar $input = $('#map_search_input');\n\tvar suggestion_box = $('#map_search_suggestion');\n\tvar map_dropbox = $('.pac-container');\n\n\tsuggestion_box.css('width', $input.outerWidth() + 'px');\n\tmap_dropbox.css('width', $input.outerWidth() + 'px');\n\tvar suggestion_box_left_offset = parseInt( $input.offset().left - suggestion_box.closest('.maplocation_container').offset().left );\n\tvar suggestion_box_top_offset = parseInt( $input.offset().top - $input_box.offset().top + $input.outerHeight() );\n\tsuggestion_box.css('top', suggestion_box_top_offset + 'px');\n\tsuggestion_box.css('left', suggestion_box_left_offset + 'px');\n\tsuggestion_box.css('zIndex', 10);\n\n\t// for iphones close the suggestion_box on focus out as suggestion_box is misplaced on focus out\n\tif (isMobile() && isiDevice()) {\n\t\t$input.on('focusout', function(e) {\n\t\t\tsetTimeout(function() {\n\t\t\t\tsuggestion_box_top_offset = parseInt( $input_box.offset().top - $('#hdmap').offset().top + $input_box.outerHeight() );\n\t\t\t\tsuggestion_box.css('top', suggestion_box_top_offset + 'px');\n\t\t\t}, 1000);\n\t\t});\n\t}\n\n\tif (!window.showSuggestionOnce) {\n\t\tshowSuggestionBox();\n\t\tif (window.showSuggestionOnce == false) {\n\t\t\twindow.showSuggestionOnce = true;\n\t\t}\n\t}\n\n\t$input.on('keyup focus', function (e) {\n\t\tvar $el = $(this);\n\n\t\tif ($el.val().trim()) {\n\t\t\tsuggestion_box.hide();\n\t\t}\n\t\telse {\n\t\t\tshowSuggestionBox();\n\t\t}\n\t});\n\n\tfunction showSuggestionBox() {\n\t\tsetTimeout(function () {\n\n\t\t\t// on keypad up in mobile device, the input box is repositioned, so the suggestion_box has to be repositioned along with it\n\t\t\tif (isMobile()) {\n\t\t\t\tsuggestion_box_top_offset = parseInt( $input_box.offset().top - $('#hdmap').offset().top + $input_box.outerHeight() );\n\t\t\t\tsuggestion_box.css('top', suggestion_box_top_offset + 'px');\n\t\t\t}\n\n\t\t\tsuggestion_box.show();\n\n\t\t\t// populate recent searches\n\t\t\tif (localStorage.recent_address_searches) {\n\t\t\t\tvar recent_addresses = JSON.parse(localStorage.recent_address_searches);\n\t\t\t\t$('.recent_search_addresses li').remove();\n\n\t\t\t\trecent_addresses.forEach(function (v, i, arr) {\n\t\t\t\t\tvar item = $('<li><a href=\"javascript:void(0);\"></a></li>');\n\n\t\t\t\t\titem.find('a').text( v.formatted_address );\n\t\t\t\t\titem.find('a').attr('data-lat', v.lat);\n\t\t\t\t\titem.find('a').attr('data-lng', v.lng);\n\n\t\t\t\t\t$('.recent_search_addresses').append(item);\n\t\t\t\t});\n\n\t\t\t\t$('.recent_search_addresses').removeClass('hide');\n\t\t\t}\n\n\t\t}, 500);\n\t}\n\n\t$('.maplocation_container').on('click', function(e) {\n\t\tif ($(e.target) !== $('#map_search_suggestion') || $(e.target) !== $('#map_input')) {\n\t\t\tsuggestion_box.hide();\n\t\t}\n\t});\n\n};\n\n// function for closing the hd modal //\nfunction closeHDModal() {\n\tif ($('#hdBookNow button, .bookingDiv button').attr('disabled') !== 'disabled') {\n\t\t$('#hdModal').modal('hide');\n\t\t$('#ModalContentWait').hide();\n\t}\n}\n\n// show HD Modal\nfunction showHDModal(url, callback) {\n\t$('#hdModal').modal('show');\n\t$('#ModalContentWait').hide();\n\tgetData(url, 'hdModalContent', 'html', '', callback);\n}\n\n// setting the value of location in the search widget //\nfunction setLocationValue() {\n\tvar locationVal = document.getElementById('map_search_input') && document.getElementById('map_search_input').value;\n\tif (locationVal !== '' && $('#mapAddHash').val() !== ''){\n\t\t$('#hdLocation').show();\n\t\t$('#hdLocation').html(locationVal);\n\t\t$('#hdPickUp').hide();\n\t\t$('#hdLocationError').hide();\n\t}\n\telse {\n\t\t$('#hdLocation').hide();\n\t\t$('#hdPickUp').show();\n\t}\n}\n\nfunction preventFormSubmit(booking_type) {\n\tvar selectedAddress = JSON.parse( decodeURIComponent($('#mapAddHash').val()) );\n\tvar sublocality;\n\tif (typeof selectedAddress['sublocality_level_1'] !== 'undefined') {\n\t\tsublocality = selectedAddress[\"sublocality_level_1\"];\n\t}\n\telse if (typeof selectedAddress['locality'] !== 'undefined') {\n\t\tsublocality = selectedAddress['locality'];\n\t}\n\telse {\n\t\tsublocality = '';\n\t}\n\tvar postalcode = selectedAddress[\"postal_code\"];\n\t$('#sublocality').val(sublocality);\n\t$('#postalcode').val(postalcode);\n\tif( booking_type === 'pickup'){\n\t\t$('#noHDLocationMap #Locations').html(sublocality + ' - ' + postalcode);\n\t\t$('#noHDLocationMap #Locations').removeClass('dateError');\n\t}\n\telse if ( booking_type === 'hd' ){\n\t\t$('#hdlocation #Locations').html(sublocality + ' - ' + postalcode);\n\t\t$('#hdlocation #Locations').removeClass('dateError');\n\t}\n\t$('.errorBox').hide();\n\t$('#StartDateValError').html('');\n\tcloseHDModal();\n}\n\n// Search Variation Experiment\nfunction initSearchPlaces() {\n\tvar input = this;\n\n\t// select the entire text in the input box\n\tinput.select();\n\n\tvar options = {\n\t  componentRestrictions: {country: \"in\"}\n\t};\n\n\tvar autocomplete = new google.maps.places.Autocomplete(input, options);\n\n\tautocomplete.addListener('place_changed', function(event) {\n\n\t  var place = autocomplete.getPlace();\n\n\t  var place_location = place.geometry.location;\n\t  if (place.geometry) {\n\t  \tgeocodePosition(place_location, true);\n\t  \tupdateMarkerPosition(place_location);\n\t  }\n\t});\n\n\t// get the current location\n\t$('body').on('click', '.tagged_addresses .current_location', function () {\n\t\tnavigator.geolocation.getCurrentPosition(currentLocationPlaceSuccess);\n\t\t$('#place_search_suggestion').hide();\n\t});\n\n\tfunction currentLocationPlaceSuccess (position) {\n\t\t$('.tagged_addresses .current_location').show();\n\n\t\t// get the lat-lng\n\t\tvar geolocate = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);\n\n\t\t// get the location name and pin for the lat-lng recieved from the maps api\n\t\tgeocodePosition(geolocate);\n\n\t\t// update lat-lng for the current location\n\t\tupdateMarkerPosition(geolocate);\n\t}\n\n}\n\nfunction newUserSessionEvent(path, category, action) {\n    // if (path == '/bangalore' || path == '/pune') {\n    //     pushEvent(category, action, 'Home Page (My Account)');\n    // } else if (path.search('/bookings/login') != -1) {\n    //     pushEvent('Login', action, 'Y');\n    // } else {\n    //     pushEvent(category, action, 'Misc');\n    // }\n    if (path.search('/bookings/login') != -1) {\n        pushEvent('Login', action, 'Y');\n    } else {\n        pushEvent(category, action, 'Y');\n    }\n}\n\nfunction populateLocations(cityId, zoom, divId) {\n\t\t$(\"#\" + divId + 'Wait').show();\n\t\t$(\"#\" + divId).html('');\n\t\tgetData('/get_locations_map/' + cityId + '?zoom=' + zoom, divId, 'replace', divId + 'Wait');\n}\n\nfunction postData(complete_url, divId, divAction, divWait, dataStr, successCB) {\n\t\tcheckajax = $(\"#AjaxActive\").val();\n\t\tif (checkajax == 1) {\n\t\t\t\tif (\"undefined\" != typeof(event)) event.returnValue = false;\n\t\t\t\treturn false;\n\t\t}\n\t\t$(\"#AjaxActive\").val(1);\n\t\tif (divWait) {\n\t\t\t\t$(\"#\" + divWait).show();\n\t\t}\n\t\tvar resp = $.ajax({\n\t\t\t\turl: complete_url,\n\t\t\t\tdata: dataStr,\n\t\t\t\tdataType: \"json\",\n\t\t\t\ttype: 'POST'\n\t\t});\n\t\tresp.done(\n\t\t\t\tfunction(data) {\n\t\t\t\t\t\tif (data[\"alert\"]) {\n\t\t\t\t\t\t\t\talert(data[\"alert\"]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (divId) {\n\n\t\t\t\t\t\t\t\t\tif (divId === 'DetailsDiv' && window.location.hash === \"#codriverSignup\") {\n\t\t\t\t\t\t\t\t\t\twindow.location.href = \"/users/license\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tif (divAction) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (window.location.pathname.indexOf('airport_one_way') !== -1 && divId == 'SignupDiv') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tloginCallback();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tif (divAction == 'append') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).append(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t\t\t} else if(divAction == 'noreplace') { // airport one way\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(data.success == false) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('.res_msg').hide();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#failuremsg').show();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#failuremsg .error_msg\").text(data.errors);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\telse if(data.success == true) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$('#successmsg').show();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (data[\"return_to\"]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twindow.location = data[\"return_to\"];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data['html']);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#\" + divId).html(data[\"html\"]);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif ((divId === \"SignupDiv\" || divId === \"DetailsDiv\") &&\n\t\t\t\t\t\t\t\t\t\twindow.location.pathname.indexOf('zap') !== -1 &&\n\t\t\t\t\t\t\t\t\t\t(complete_url === '/users/signup' || complete_url === '/users/sign_in')) {\n\t\t\t\t\t\t\t\t\t\tif (divId === \"DetailsDiv\") {\n\t\t\t\t\t\t\t\t\t\t\t$('#newModalContent .close').click();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tappendZapForm();\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(\"#AjaxActive\").val(0);\n\t\t\t\t\t\t$('.help').tooltip();\n\n\t\t\t\t\t\tif (typeof successCB !== 'undefined') successCB(data);\n\t\t\t\t}\n\t\t);\n\t\tresp.fail(\n\t\t\t\tfunction(jqXHR, textStatus) {\n\t\t\t\t\t\tif (divWait) {\n\t\t\t\t\t\t\t\t$(\"#\" + divWait).hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(\"#AjaxActive\").val(0);\n\t\t\t\t\t\tif (jqXHR.getAllResponseHeaders()) {\n\t\t\t\t\t\t\t\talert(\"Request failed, please try again later.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$('a[data-toggle = tab]').removeClass('disabled'); // enable tabs on search failure\n\t\t\t\t\t\t// remove the loader on search failure\n\t\t\t\t\t\t$('.verticals-SearchSubmit').show();\n\t        \t$('span.verticals-book-now').show();\n\t        \t$('span.verticals-spinner').hide();\n\t\t\t\t\t\t$('#SearchSubmit').show();\n\t        \t$('span#book-now').show();\n\t        \t$('span#spinner').hide();\n\n\t\t\t\t}\n\t\t);\n\t\tif (\"undefined\" != typeof(event)) event.returnValue = false;\n\t\treturn false;\n}\n\nif(window.location.pathname.includes('checkout') ||\n    window.location.pathname.includes('login') ||\n    window.location.pathname.includes('wallet') ||\n    window.location.pathname.includes('payment')) {\n      $('#floatingHead').hide();\n    }\n\n    $(window).scroll(function () {\n      if(window.location.pathname.includes('howitworks')) {\n        if(window.scrollY > 1200) {\n          $('#redesign_header_container').css('position', 'fixed');\n          $('#floatingHead').css('margin-top', '62px');\n          $('.floatingHead.navbar-fixed-top .brandLogo').css('display', 'none');\n\t\t\t\t\t$('.floatingHead').addClass('navbar-fixed-top');\n\t\t\t\t\t$('#floatingHead').css('z-index', '1');\n        } else {\n          $('#redesign_header_container').css('position', 'initial');\n          $('#floatingHead').css('margin-top', '0px');\n          $('.floatingHead').removeClass('navbar-fixed-top');\n        }\n\n      } else {\n        if (window.scrollY > 110) {\n          $('.floatingHead').addClass('navbar-fixed-top');\n        } else {\n          $('.floatingHead').removeClass('navbar-fixed-top');\n        }\n      }\n    });\n\nfunction pushEvent(category, action, label) {\n\ttry{\n\t\tif(label) {\n\t\t\t\t_gaq.push(['_trackEvent', category, action, label]);\n\t\t} else {\n\t\t\t\t_gaq.push(['_trackEvent', category, action]);\n\t\t}\n\t\t//trackEventsForAnalytics(category, action, label);\n\t}\n\tcatch(err){\n\t}\n}\n\nfunction pushEventQueue() {\n\tvar zaq = (typeof _zaq === 'undefined') ? [] : _zaq;\n\tzaq.forEach(function(e) {\n\t\tif(e.length == 3) {\n\t\t\tpushEvent(e[0], e[1], e[2]);\n\t\t} else {\n\t\t\tpushEvent(e[0], e[1]);\n\t\t}\n\t});\n\t_zaq = [];\n}\n\nfunction saveLoginEmail(){\n\tsessionStorage.setItem('loginEmail', $('#LoginEmail').val());\n}\n\nfunction getLoginEmail(){\n\tsessionStorage.getItem('loginEmail');\n}\n\nfunction showAvailability(carId, locId, avail, locName, carName, locKm, el) {\n\t\t$('.locCar'+carId).attr(\"data-selectlocation\", locId);\n\t\tvar pId = $('.'+carId + '.flexiSelected').data(\"pid\");\n    var segmentProps = Segment.getBookingProperties(carId, locId, pId);\n\n\t\tvar lat = parseFloat($(el).attr('data-lat'))\n\t\t\t, lng = parseFloat($(el).attr('data-lng'))\n\t\t\t, radius = parseFloat($(el).attr('data-radius'))\n\t\t\t, allocation_info = $(el).attr('data-allocation_info');\n\n\t\t$('#Avail' + carId).removeClass('yes no');\n\t\tif (avail == 1) {\n\t\t\t\t$('#Avail' + carId).text(\"Available\");\n\t\t\t\t$('#Avail' + carId).addClass('yes');\n        $(\"#ButtonYes\" + carId)\n\t\t\t\t\t.attr(\"onClick\", \"doBooking(\" + carId + \", \" + locId + \", \" + pId + \", '', '', this,\" + segmentProps + \");\")\n\t\t\t\t\t.attr({\n\t\t\t\t\t\t'data-radius': radius,\n\t\t\t\t\t\t'data-allocation_info': allocation_info\n\t\t\t\t\t});\n\t\t\t\t$(\"#ButtonYes\" + carId).show();\n\t\t\t\t$(\"#ButtonNo\" + carId).hide();\n\t\t\t\t$(\"#ButtonNotify\" + carId).hide();\n\t\t\t\tpushEvent('Search', carName, locName+'_Y');\n\t\t} else {\n\t\t\t\t$('#Avail' + carId).text(\"Not Available\");\n\t\t\t\t$('#Avail' + carId).addClass('no');\n\t\t\t\t$(\"#ButtonYes\" + carId).attr(\"segmentProps\", segmentProps);\n\t\t\t\t$(\"#ButtonYes\" + carId).attr(\"onClick\", \"\");\n\t\t\t\t$(\"#ButtonYes\" + carId).hide();\n\t\t\t\t$(\"#ButtonNotify\" + carId).attr(\"onClick\", \"doBookingNotify(\" + carId + \", \" + locId + \");\");\n\t\t\t\t$(\"#ButtonNotify\" + carId).show();\n\t\t\t\t$(\"#ButtonNo\" + carId).show();\n\t\t\t\tpushEvent('Search', carName, locName+'_N');\n\t\t}\n\n\t\tif(radius > 0) {\n\t\t\t// update the name, km and data attributes for zap cars in the zap location section\n\t\t\t$('#LocName' + carId + ' #zapLocShortName').text(locName);\n\t\t\t$('#LocName' + carId + ' #zaploc_km').text(locKm);\n\t\t\t$('#zapHelpIcon' + carId).attr({\n\t\t\t\t'data-lat': lat,\n\t\t\t\t'data-lng': lng,\n\t\t\t\t'data-radius': radius,\n\t\t\t\t'data-allocation_info': allocation_info\n\t\t\t});\n\n\t\t\t// hide and show the respective containers\n\t\t\t$('#zapLocationInfo' + carId).removeClass('hide');\n\t\t\t$('#nonZapLocationInfo' + carId).addClass('hide');\n\t\t}\n\t\telse {\n\t\t\t// update the name, km and data attributes for non-zap cars in the non-zap location section\n\t\t\t$('#LocName' + carId + ' #LocShortName').text(locName);\n\t\t\t$('#LocName' + carId + ' #loc_km').text(locKm);\n\n\t\t\t// hide and show the respective containers\n\t\t\t$('#zapLocationInfo' + carId).addClass('hide');\n\t\t\t$('#nonZapLocationInfo' + carId).removeClass('hide');\n\t\t}\n\n\t\t$('#LocMenu' + carId).find('li').removeClass('active');\n\t\t$('#LocSel' + carId + locId).addClass('active');\n\t\tif ($('#Timeline' + carId).html() != '') {\n\t\t\t\tshowTimeline(carId, 0);\n\t\t\t\tshowTimeline(carId, 0);\n\t\t}\n\t\t//pushEvent('Search', carName, 'Location');\n}\n\n// called when a new location is selected from the locations modal\n// checks for availability and makes the corresponding updates\nfunction showAvailabilityNewAlgo(carId, locId, avail, locName, carName, startTime, endTime, GA_event, locKm, el) {\n\t\tstartTime = startTime.toString();\n\t\tendTime = endTime.toString();\n\t\t$('.locCar'+carId).attr(\"data-selectlocation\", locId);\n\t\tvar pId = $('.'+carId + '.flexiSelected').data(\"pid\");\n    var segmentProps = Segment.getBookingProperties(carId, locId, pId);\n\n\t\tvar lat = parseFloat($(el).attr('data-lat'))\n\t\t\t, lng = parseFloat($(el).attr('data-lng'))\n\t\t\t, radius = parseFloat($(el).attr('data-radius'))\n\t\t\t, allocation_info = $(el).attr('data-allocation_info');\n\n\t$('#Avail' + carId).removeClass('yes no');\n\t\tif (avail == 1) {\n\t\t\t\t$('#Avail' + carId).text(\"Available\");\n\t\t\t\t$('#Avail' + carId).addClass('yes');\n\t\t\t\t// update the radius and allocation_info attributes of the book now button when a new location is selected\n\t\t\t\t$(\"#ButtonYes\" + carId)\n\t\t\t\t\t.attr(\"onClick\", \"doBookingNew(\" + carId + \", \" + locId + \", \" +  pId + \", '\" + startTime + \"', '\" + endTime + \"', this,\" + segmentProps + \"); pushEvent('Search Result Clicks','\" + GA_event + \"');\")\n\t\t\t\t\t.attr({\n\t\t\t\t\t\t'data-radius': radius,\n\t\t\t\t\t\t'data-allocation_info': allocation_info\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t$(\"#ButtonYes\" + carId).show();\n\t\t\t\t$(\"#ButtonNo\" + carId).hide();\n\t\t\t\t$(\"#ButtonNotify\" + carId).hide();\n\t\t} else {\n\t\t\t\t$('#Avail' + carId).text(\"Not Available\");\n\t\t\t\t$('#Avail' + carId).addClass('no');\n\t\t\t\t$(\"#ButtonYes\" + carId).attr(\"segmentProps\", segmentProps);\n\t\t\t\t$(\"#ButtonYes\" + carId).attr(\"onClick\", \"\");\n\t\t\t\t$(\"#ButtonYes\" + carId).hide();\n\t\t\t\t$(\"#ButtonNotify\" + carId).attr(\"onClick\", \"doBookingNotify(\" + carId + \", \" + locId + \");\");\n\t\t\t\t$(\"#ButtonNotify\" + carId).show();\n\t\t\t\t$(\"#ButtonNo\" + carId).show();\n\t\t}\n\t\tif(radius > 0) {\n\t\t\t// update the name, km and data attributes for zap cars in the zap location section\n\t\t\t$('#LocName' + carId + ' #zapLocShortName').text(locName);\n\t\t\t$('#LocName' + carId + ' #zaploc_km').text(locKm);\n\t\t\t$('#zapHelpIcon' + carId).attr({\n\t\t\t\t'data-lat': lat,\n\t\t\t\t'data-lng': lng,\n\t\t\t\t'data-radius': radius,\n\t\t\t\t'data-allocation_info': allocation_info\n\t\t\t});\n\n\t\t\t// hide and show the respective containers\n\t\t\t$('#zapLocationInfo' + carId).removeClass('hide');\n\t\t\t$('#nonZapLocationInfo' + carId).addClass('hide');\n\t\t}\n\t\telse {\n\t\t\t// update the name, km and data attributes for non-zap cars in the non-zap location section\n\t\t\t$('#LocName' + carId + ' #LocShortName').text(locName);\n\t\t\t$('#LocName' + carId + ' #loc_km').text(locKm);\n\n\t\t\t// hide and show the respective containers\n\t\t\t$('#zapLocationInfo' + carId).addClass('hide');\n\t\t\t$('#nonZapLocationInfo' + carId).removeClass('hide');\n\t\t}\n\n\t\t// change the location that is active in the locations modal\n\t\t$('#LocMenu' + carId).find('li').removeClass('active');\n\t\t$('#LocSel' + carId + locId).addClass('active');\n\t\tif ($('#Timeline' + carId).html() != '') {\n\t\t\t\tshowTimeline(carId, 0);\n\t\t\t\tshowTimeline(carId, 0);\n\t\t}\n}\n\nvar locationDropdownRank = 0;\n\nfunction showAvailabilityNew(carId, locId, avail, locName, carName, startTime, startDate, endTime, endDate, fare, days, hours, minutes, selectStartTime, selectEndTime, search_start_time, search_end_time, search_loc, GA_event, el, locKm) {\n\t\tlocationDropdownRank = $(el).closest('li').index() - 1;\n\n\t\tshowAvailabilityNewAlgo(carId, locId, avail, locName, carName, selectStartTime.toString(), selectEndTime.toString(), GA_event, locKm, el);\n    pushEvent('Search', carName, locName+'_Y');\n    $('#LocPickTime' + carId).text(startTime);\n\t\t$('#LocPickDate' + carId).text(startDate);\n\t\t$('#LocDropTime' + carId).text(endTime);\n\t\t$('#LocDropDate' + carId).text(endDate);\n\t\t$('#LocFare' + carId).text(fare);\n\t\t$('#LocFare' + carId).digits();\n\t\t$('#time-span' + carId).text(days + \" days, \" + hours + \" hours, \" + minutes + \" minutes\");\n\n\t\tvar diffStartTime = Date.parse(selectStartTime) - Date.parse(search_start_time);\n\t\tvar diffEndTime = Date.parse(selectEndTime) - Date.parse(search_end_time);\n\t\tif (diffStartTime != 0 || diffEndTime != 0) {\n\t\t\t\t$('#emptyclockspace' + carId + ' span').remove();\n\t\t\t\t$('#emptyclockspace' + carId).append(\"<span></span>\");\n\t\t\t\t$('#emptyclockspace' + carId + ' span').addClass('add-search-icon clock-icon position-r help pointer');\n\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\"data-html\": 'true',\n\t\t\t\t\t\t\"data-placement\": \"left\",\n\t\t\t\t\t\t\"data-toggle\": \"tooltip\"\n\t\t\t\t});\n\n\t\t\t\tif (diffStartTime > 0) {\n\t\t\t\t\t\tif (diffEndTime > 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is later and drop-off time is later.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (diffEndTime < 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is later and drop-off time is earlier.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is later.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t} else if (diffStartTime < 0) {\n\t\t\t\t\t\tif (diffEndTime > 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is earlier and drop-off time is later.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (diffEndTime < 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is earlier and drop-off time is earlier.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's pickup time is earlier.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t\tif (diffEndTime > 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's drop-off time is later.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (diffEndTime < 0) {\n\t\t\t\t\t\t\t\t$('#emptyclockspace' + carId + ' span.add-search-icon.clock-icon').attr({\n\t\t\t\t\t\t\t\t\t\t\"data-title\": \"This booking's drop-off time is earlier.\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$('.add-search-icon').tooltip();\n\t\t} else {\n\t\t\t\t$('#emptyclockspace' + carId + ' span').remove();\n\t\t}\n\t\tif (search_loc != '') {\n\t\t\t\tif (locId != search_loc) {\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t\t\t\t\t$('#emptylocspace' + carId).append(\"<span></span>\");\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').addClass('add-search-icon loc-icon position-r help pointer').attr({\n\t\t\t\t\t\t\t\t\"data-html\": 'true',\n\t\t\t\t\t\t\t\t\"data-placement\": \"left\",\n\t\t\t\t\t\t\t\t\"data-title\": \"This booking starts from a different location\",\n\t\t\t\t\t\t\t\t\"data-toggle\": \"tooltip\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('.add-search-icon').tooltip();\n\t\t\t\t} else {\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t\t\t}\n\t\t} else {\n\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t}\n}\n\nfunction showAvailabilityNewNotAvail(carId, locId, avail, locName, carName, default_fare, days, hours, minutes, search_startTime, search_startDate, search_endTime, search_endDate, search_loc, locKm) {\n\t\tshowAvailability(carId, locId, avail, locName, carName, locKm);\n\t\t$('#LocPickTime' + carId).text(search_startTime);\n\t\t$('#LocPickDate' + carId).text(search_startDate);\n\t\t$('#LocDropTime' + carId).text(search_endTime);\n\t\t$('#LocDropDate' + carId).text(search_endDate);\n\t\t$('#LocFare' + carId).text(default_fare);\n\t\t$('#LocFare' + carId).digits();\n\t\t$('#time-span' + carId).text(days + \" days \" + hours + \" hours \" + minutes + \" minutes\");\n\t\tif (avail == '0') {\n\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t\t\t$('#emptyclockspace' + carId + ' span').remove();\n\t\t}\n\t\tif (search_loc != '') {\n\t\t\t\tif (locId != search_loc) {\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t\t\t\t\t$('#emptylocspace' + carId).append(\"<span></span>\");\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').addClass('add-search-icon loc-icon position-r help pointer').attr({\n\t\t\t\t\t\t\t\t\"data-html\": 'true',\n\t\t\t\t\t\t\t\t\"data-placement\": \"left\",\n\t\t\t\t\t\t\t\t\"data-title\": \"This booking starts from a different location\",\n\t\t\t\t\t\t\t\t\"data-toggle\": \"tooltip\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('.add-search-icon').tooltip();\n\t\t\t\t} else {\n\t\t\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t\t\t}\n\t\t} else {\n\t\t\t\t$('#emptylocspace' + carId + ' span').remove();\n\t\t}\n}\n\n$.fn.digits = function() {\n\t\treturn this.each(function() {\n\t\t\t\t$(this).text($(this).text().replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, \"$1,\"));\n\t\t})\n}\n\nfunction showCalculator(action) {\n  if (action == 'tariff') {\n    pushEvent('Calculator', 'Open', null);\n  } else {\n    pushEvent('Rescheduler', 'Open', null);\n  }\n  $('#CalculatorContentWait').show();\n  $('#CalculatorContent').html('');\n  showModal();\n  getData(\"/showcal/\" + action, 'CalculatorContent', 'replace' ,'CalculatorContentWait');\n}\n\nfunction showModal(title, url, wait, divId, callback, param) {\n\t\tif(typeof wait === \"undefined\") {\n\t\t\t$('#ModalContentWait').show();\n\t\t}\n\t\t$('#ModalContent').html('');\n\t\t$('#ModalLabel').text(title);\n\t\t$('#ModalLabel').css({\n\t\t\t\t'text-align': 'center',\n\t\t\t\t'color': '#96D05E'\n\t\t\t\t\t\t//'font-size' : '20px'\n\t\t});\n\t\tvar genDivId = 'ModalContent';\n\t\tif (divId) {\n\t\t\tgenDivId = divId;\n\t\t}\n\t\tif (isMobile()) {\n\t\t\tif (divId === 'modal_search_box') {\n\t\t\t\t$('#ModalContent').css('height', '0px');\n\t\t\t\t$('.mobileModalBody').css('height', 'auto');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#ModalContent').css('height', '100%');\n\t\t\t\t$('.mobileModalBody').css('height', '100%');\n\t\t\t}\n\t\t}\n\t\t$('#Modal').modal('show');\n\t\tgetData(url, genDivId, 'replace', 'ModalContentWait');\n\t\tif (callback) {\n\t\t\tcallback(param);\n\t\t}\n}\n\nfunction showModalReschedule(title, url, css) {\n\t\t$('#ModalContentWait').show();\n\t\t$('#ModalContent').html('');\n\t\t$('#ModalLabel').text(title);\n\t\tvar border = '';\n\t\tif (!title) {\n\t\t\tborder = 'none';\n\t\t}\n\t\t$('.modal-content').css({\n\t\t\t'overflow': 'visible'\n\t\t});\n\t\t$('.modal-header').css({\n\t\t\t'border': border\n\t\t});\n\t\t$('.modal-body').css({\n\t\t\t'padding': 0,\n\t\t});\n\t\t$('#ModalLabel').css({\n\t\t\t\t'color': '#2e2e2e',\n\t\t\t\t'fontWeight': '600'\n\t\t});\n\t\t$('#Modal').modal('show');\n\t\tgetData(url, 'ModalContent', 'replace', 'ModalContentWait');\n}\n\nfunction showNewModal(title, url, social_error, callback, currElement) {\n\t\t$('#newModal').modal('show');\n\t\tgetData(url, 'newModalBodyRight', social_error, 'divWait', callback, currElement);\n}\n\nfunction showSearch(hd_enabled, googleMapKey) {\n\t\t$('#SHWait').show();\n\t\t$('#SHContent').html('');\n\t\t$('#SH').show();\n\t\t$('#NavBuffer').removeClass('nav-buffer').addClass('nav-buffer-big');\n\t\t$('#header-new').addClass('p-b30');\n\t\tif (hd_enabled) {\n\t\t\tif(typeof google === 'undefined' || typeof google.maps === 'undefined'){\n\t\t\t\tvar script = document.createElement(\"script\");\n\t\t\t\tscript.type = \"text/javascript\";\n\t\t\t\tscript.src = \"https://maps.googleapis.com/maps/api/js?key=\" +googleMapKey+ \"&libraries=places&callback=initializeHDMap\";\n\t\t\t\tdocument.body.appendChild(script);\n\t\t\t}\n\t\t\tgetData('/bookings/widget_hd', 'SHContent', 'replace', 'SHWait');\n\t\t}\n\t\telse {\n\t\t\tgetData('/bookings/widget', 'SHContent', 'replace', 'SHWait');\n\t\t}\n}\n\nfunction showTimeline(carId, action, carName, click) {\n\t\tvar locId = $('#LocMenu' + carId).find('li.active').attr(\"id\").split('LocSel' + carId)[1];\n\t\tvar locName = $('#LocName' + carId).html().trim()\n\t\tif (action == 0) {\n\t\t\t\tif ($('#Timeline' + carId).html() == '') {\n\t\t\t\t\t\t$('#TimelineWait' + carId).slideDown();\n\t\t\t\t\t\tif (carName && click) {\n\t\t\t\t\t\t\t\tpushEvent('Search', carName + '_' + locName, 'Show Availability');\n\t\t\t\t\t\t\t\t// pushEvent('Cars Selected', carName, 'Timeline Open');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgetData(\"/bookings/timeline?car=\" + carId + \"&location=\" + locId, 'Timeline' + carId, 'replace', null);\n\t\t\t\t} else {\n\t\t\t\t\t\tif (carName && click) {\n\t\t\t\t\t\t\t\tpushEvent('Search', carName + '_' + locName, 'Hide Availability');\n\t\t\t\t\t\t\t\t// pushEvent('Cars Selected', carName, 'Timeline Close');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$('#TimelineWait' + carId).slideUp();\n\t\t\t\t\t\t$('#Timeline' + carId).slideUp();\n\t\t\t\t\t\t$('#Timeline' + carId).html('');\n\t\t\t\t\t\t$('#TimelineText' + carId).html(\"Show Availability\");\n\t\t\t\t\t\t$('#TimelineAction' + carId).html(\"<div class='arrw-d'></div>\");\n\t\t\t\t}\n\t\t\t\t$('#TimelineAction' + carId).tooltip('hide');\n\t\t} else if (action == 1) {\n\t\t\t\t$('.arrw-d').hide();\n\t\t\t\t$('#TimelineWait' + carId).slideDown();\n\t\t\t\tvar num = $('#TimelineMoreNum' + carId).val();\n\t\t\t\tgetData(\"/bookings/timeline?car=\" + carId + \"&location=\" + locId + \"&page=\" + num, 'TimelineContent' + carId, 'append', null);\n\t\t} else if (action == -1) {\n\t\t\t\t$('.arrw-u').hide();\n\t\t\t\t$('#TimelineWait' + carId).slideDown();\n\t\t\t\tvar num = $('#TimelineLessNum' + carId).val();\n\t\t\t\tgetData(\"/bookings/timeline?car=\" + carId + \"&location=\" + locId + \"&page=\" + num, 'TimelineContent' + carId, 'prepend', null);\n\t\t}\n}\n\nfunction socialPlugins() {\n\n\n\t\t(function() {\n\t\t\t\tvar po = document.createElement('script');\n\t\t\t\tpo.type = 'text/javascript';\n\t\t\t\tpo.async = true;\n\t\t\t\tpo.src = 'https://apis.google.com/js/plusone.js';\n\t\t\t\tvar s = document.getElementsByTagName('script')[0];\n\t\t\t\ts.parentNode.insertBefore(po, s);\n\t\t})();\n\n\t\t(function(d, s, id) {\n\t\t\t\tvar js, fjs = d.getElementsByTagName(s)[0];\n\t\t\t\tif (!d.getElementById(id)) {\n\t\t\t\t\t\tjs = d.createElement(s);\n\t\t\t\t\t\tjs.id = id;\n\t\t\t\t\t\tjs.src = \"//platform.twitter.com/widgets.js\";\n\t\t\t\t\t\tfjs.parentNode.insertBefore(js, fjs);\n\t\t\t\t}\n\t\t}(document, \"script\", \"twitter-wjs\"));\n}\n\nfunction SubmitForm(frm, url, divId, successCB) {\n\t\tvar frmId = frm.id;\n\t\tif ($(\"#\" + frmId.replace('Form', 'Submit')).length > 0 && $(\"#\" + frmId.replace('Form', 'Wait')).length > 0) {\n\t\t\t\thideDiv = frmId.replace('Form', 'Wait');\n\t\t} else {\n\t\t\t\thideDiv = null;\n\t\t}\n\t\tvar new_url = '';\n\t\tvar failed = false;\n\t\tfor (var i = 0; i < frm.elements.length; i++) {\n\t\t\t\tif (frm.elements[i].name != 'commit') {\n\t\t\t\t\t\tif ($(frm.elements[i]).prop(\"type\") == 'checkbox') {\n\t\t\t\t\t\t\t\tif ($(frm.elements[i]).prop(\"checked\")) {\n\t\t\t\t\t\t\t\t\t\tnew_url += \"&\" + frm.elements[i].name + \"=\" + frm.elements[i].value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// for authenticity tokens\n\t\t\t\t\t\t\t\tif (frm.elements[i].name == 'authenticity_token') {\n\t\t\t\t\t\t\t\t\tnew_url += \"&\" + frm.elements[i].name + \"=\" + encodeURIComponent(frm.elements[i].value);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tif (!frm.elements[i].disabled) {\n\t\t\t\t\t\t\t\t\t\tnew_url += \"&\" + frm.elements[i].name + \"=\" + frm.elements[i].value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// $('#' + frm.elements[i].id + 'Error').html(\"arbit\");\n\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"hidden\");\n\t\t\t\t\t\t$(frm.elements[i]).removeClass('field_with_errors');\n\t\t\t\t\t\tif ($(frm.elements[i]).hasClass('validate-presence') && (frm.elements[i].value.length == 0 || frm.elements[i].value == $('#' + frm.elements[i].id).attr('dummy-title'))) {\n\t\t\t\t\t\t\t\tif (!failed) {\n\t\t\t\t\t\t\t\t\t\tfrm.elements[i].focus();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ($('#' + frm.elements[i].id + 'Error').length > 0) {\n\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').html(\"Please fill this field\");\n\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').show();\n\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"visible\");\n\t\t\t\t\t\t\t\t\t\t$(frm.elements[i]).addClass('field_with_errors');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\talert(\"Please fill this field.\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ($(frm.elements[i]).hasClass('validate-numeric') && (frm.elements[i].value.length > 0) && (!ValidateNumeric(frm.elements[i].value))) {\n\t\t\t\t\t\t\t\t\t\tif (!failed) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrm.elements[i].focus();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ($('#' + frm.elements[i].id + 'Error').length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').html(\"Should be numeric\");\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"visible\");\n\t\t\t\t\t\t\t\t\t\t\t\t$(frm.elements[i]).addClass('field_with_errors');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\talert(\"Should be numeric.\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ($(frm.elements[i]).hasClass('validate-length') && (frm.elements[i].value.length > 0) && (frm.elements[i].value.length != $(frm.elements[i]).data(\"length\"))) {\n\t\t\t\t\t\t\t\t\t\tif (!failed) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrm.elements[i].focus();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ($('#' + frm.elements[i].id + 'Error').length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').html(\"Need \" + $(frm.elements[i]).data(\"length\") + \" characters\");\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"visible\");\n\t\t\t\t\t\t\t\t\t\t\t\t$(frm.elements[i]).addClass('field_with_errors');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\talert(\"Should be of \" + $(frm.elements[i]).data(\"length\") + \" characters.\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ($(frm.elements[i]).hasClass('validate-email') && (frm.elements[i].value.length > 0) && (!ValidateEmail(frm.elements[i].value))) {\n\t\t\t\t\t\t\t\t\t\tif (!failed) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrm.elements[i].focus();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ($('#' + frm.elements[i].id + 'Error').length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').html(\"Email is invalid\");\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"visible\");\n\t\t\t\t\t\t\t\t\t\t\t\t$(frm.elements[i]).addClass('field_with_errors');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\talert(\"Email is invalid.\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ($(frm.elements[i]).hasClass('validate-date') && (frm.elements[i].value.length > 0) && (!ValidateDate(frm.elements[i].value))) {\n\t\t\t\t\t\t\t\t\t\tif (!failed) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrm.elements[i].focus();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif ($('#' + frm.elements[i].id + 'Error').length > 0) {\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').html(\"Is invalid\");\n\t\t\t\t\t\t\t\t\t\t\t\t$('#' + frm.elements[i].id + 'Error').css(\"visibility\", \"visible\");\n\t\t\t\t\t\t\t\t\t\t\t\t$(frm.elements[i]).addClass('field_with_errors');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\talert(\"Date is invalid.\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t}\n\t\tif (!failed) {\n\t\t\t\t$(\"#\" + frmId.replace('Form', 'Submit')).hide();\n\t\t\t\tif(frmId === \"SearchForm\"){\n\t\t\t\t\t$('#SearchSubmit').show();\n        \t$('span#book-now').hide();\n        \t$('span#spinner').show();\n\t\t\t\t}\n\t\t\t\tif (isMobile()) {\n\t\t\t\t\tif (frmId === \"SearchHDForm\") {\n\t\t\t\t\t\t$('#mobileSearchSubmit').show();\n\t        \t$('span#book-now').hide();\n\t        \t$('span#spinner').show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (frmId.indexOf(\"Zoom\") !== -1 && frmId.indexOf(\"SearchForm\") !== -1) {\n\t\t\t\t\tvar searchType = frmId.substring(0,frmId.indexOf(\"SearchForm\"));\n\t\t\t\t\t$('#' + searchType + 'SearchSubmit').show();\n        \t$('span#' + searchType + 'book-now').hide();\n        \t$('span#' + searchType + 'spinner').show();\n\t\t\t\t\t$('a[data-toggle = tab]').addClass('disabled'); // disable tabs on search\n\t\t\t\t}\n\t\t\t\tif(frmId === \"SearchHDForm\") {\n\t\t\t\t\t$('#SearchHDSubmit').show();\n\t\t\t\t}\n\t\t\t\tif(frmId === \"ForgotForm\"){\n\t\t\t\t\t$('#forgotBtnText').hide();\n\t\t\t\t\t$('.fixedForgotSubmitBtn #spinner').show();\n\t\t\t\t}\n\n\t\t\t\tvar isAirportSearch = $(\"input[name='zoom_air']\").val();\n\t\t\t\tif (!isMobile()  && (frmId == \"ZoomClassicSearchForm\" || frmId == \"SearchHDForm\" || frmId == \"SearchForm1\" || frmId == \"SearchForm2\") && !isMobile()) {\n\t\t\t\t\tvar newSearchUrl = url.replace('/tariff', '');\n\t\t\t\t\tgetSearchData(frm, newSearchUrl, new_url, successCB);\n\t\t\t\t} else {\n\t\t\t\t\tif (frmId === \"airport_one_way_detailsForm\") {\n\t\t\t\t\t\tpostData(url, divId, 'noreplace', frmId, new_url, successCB);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpostData(url, divId, 'replace', hideDiv, new_url, successCB);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(contactFlag === 1) {\n\t\t\t\t\twindow.setTimeout(DisplayQueryForm,2000);\n\t\t\t\t}\n\t\t\t\t// postData(url, divId, 'replace', hideDiv, new_url, successCB);\n\t\t\t\tif(typeof newsletter !== undefined) {\n\t\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\t\t$('.news').hide();\n\t\t\t\t\t\t$('#successText').html(\"Thanks for signing up for the deals Newsletter!\");\n\t\t\t\t\t},3000);\n\t\t\t\t}\n\t\t}\n\t\tif (\"undefined\" != typeof(event)) event.returnValue = false;\n\t\treturn false;\n}\n\n// function to get Date object from date string\nfunction getDateObject(date) {\n\tvar datetimeArr = date.split(' ');\n\tvar dateArr = datetimeArr[0].split(/\\//g); //splits the first half of time separated by slash character\n\tvar timeArr = datetimeArr[1].split(':');\n\t//Uses the Javascript Date format of Date(year,month,date,hour,minute,second,microsecond);\n\treturn new Date(parseInt(dateArr[2]),parseInt(dateArr[1])-1,parseInt(dateArr[0]),parseInt(timeArr[0]),parseInt(timeArr[1]),0,0);\n}\n\nfunction SearchSubmitForm(frm, url, divId, dateID) {\n\tvar dateID = typeof dateID !== 'undefined' ? dateID : '';\n\t// check if end date is not less than start date\n\tvar startDate = $('#Start' + dateID + 'DateVal').val();\n\tvar endDate = $('#End' + dateID + 'DateVal').val();\n\n\tif (startDate === $('#Start' + dateID + 'DateVal').attr('dummy-title') || endDate === $('#End' + dateID + 'DateVal').attr('dummy-title')) {\n\t\tif (startDate === $('#Start' + dateID + 'DateVal').attr('dummy-title'))\n\t\t\t$('#Start' + dateID + 'DateVal').datetimepicker('show');\n\t\telse if (endDate === $('#End' + dateID + 'DateVal').attr('dummy-title'))\n\t\t\t$('#End' + dateID + 'DateVal').datetimepicker('show');\n\t\treturn false;\n\t}\n\n\tstartDate = getDateObject(startDate);\n\tendDate = getDateObject(endDate);\n\tif (startDate >= endDate) {\n\t\t$('.errorBox').hide();\n\t\t$('#End' + dateID + 'DateValError').text('End Time cannot be less than Start Time');\n\t\t$('#End' + dateID + 'DateValError').show();\n\t\t$('#End' + dateID + 'Date').addClass('dateError');\n\t\t$('#End' + dateID + 'DateVal').addClass('dateError');\n\t\treturn false;\n\t}\n\n\t// Check if city is selected for zoom airport search\n\telse if ($('#CityVal').val() === 'null' && dateID == 'Airport') {\n\t\t$('#CityValError').text('Please select a city').show();\n\t\treturn false;\n\t}\n\n\tif (dateID === 'Airport') {\n\t\tpushEvent('Airport Shack Search Bar', 'Start Time', startDate);\n\t\tpushEvent('Airport Shack Search Bar', 'End Time', endDate);\n\t\tpushEvent('Airport Shack Search Bar', 'City', $('#CityVal').val());\n\t}\n\tSubmitForm(frm, url, divId);\n}\n\nfunction TariffCalculatorSubmitForm(frm, url, divId) {\n\n\t// Get start date\n\tif ($('#starts-form').length) {\n\t\t// we'll need to change dd/mm to mm/dd for new Date's acceptance\n\t\tvar d = new Date($('#starts-form').val().trim().replace(/(\\d{2})\\/(\\d{2})\\/(\\d{4})/, \"$2/$1/$3\"));\n\t\tvar start_date = d.getFullYear() + '-' + (\"0\" + (d.getMonth() + 1)).slice(-2) + '-' + (\"0\" + d.getDate()).slice(-2);\n\t\tvar start_time = (\"0\" + d.getHours()).slice(-2) + ':' + (\"0\" + d.getMinutes()).slice(-2) + ':' + (\"0\" + d.getSeconds()).slice(-2);\n\t}\n\n\tSubmitForm(frm, url, divId);\n}\n\nfunction LoginSubmitForm(frm, url, divId, successCB) {\n\tvar signup_details = { email: $('#LoginEmail').val().trim() };\n\tsignup_details = JSON.stringify(signup_details);\n\tsessionStorage.setItem('signup_details', signup_details);\n\tSubmitForm(frm, url, divId, successCB);\n}\n\nfunction DetailsSubmitForm(frm, url, divId) {\n\tvar signup_details = {};\n\tsignup_details.name = $('#DetailsName').val();\n\tsignup_details.phone = $('#DetailsPhone').val();\n\tsignup_details.dob = $('#DetailsDob').val();\n\n\tvar selectedCity = $('#selectedCity').val();\n\t//var selectedCity = $('option[value=\"'+selectedCityID+'\"]').text().trim();\n\n\tsignup_details.city = selectedCity;\n\n\tvar stored_signup_details = JSON.parse(sessionStorage.getItem('signup_details'));\n\tif (stored_signup_details && stored_signup_details.email) {\n\t\tsignup_details.email = stored_signup_details.email;\n\n\t\tsignup_details = JSON.stringify(signup_details);\n\t\tsessionStorage.setItem('signup_details', signup_details);\n\t}\n\n\tpushEvent(\"User Details\", \"Submit\", window.location.pathname);\n\n\tSubmitForm(frm, url, divId);\n}\n\nfunction trackEventsForPageScroll(isDuplicate) {\n\t\t$(window).scroll(function() {\n\t\t\t\tvar bottom = $(window).height() + $(window).scrollTop();\n\t\t\t\tvar height = $(document).height();\n\t\t\t\tvar percentage = Math.round(100 * bottom / height);\n\n\t\t\t\tif (isDuplicate == 0) {\n\t\t\t\t\t\tpushEvent('Home Page Scroll', 'Top');\n\t\t\t\t\t\tisDuplicate = 1;\n\t\t\t\t}\n\t\t\t\t//70% is the mark where map occupies major part of the screen - middle part of page visually\n\t\t\t\tif (percentage >= 70 && isDuplicate < 2) {\n\t\t\t\t\t\tpushEvent('Home Page Scroll', 'Middle');\n\t\t\t\t\t\tisDuplicate = 2;\n\t\t\t\t} else if (percentage >= 100 && isDuplicate < 3) {\n\t\t\t\t\t\tpushEvent('Home Page Scroll', 'Bottom');\n\t\t\t\t\t\tisDuplicate = 3;\n\t\t\t\t}\n\t\t});\n}\n\nfunction userActive() {\n\t\t$('#UserBar').popover({\n\t\t\t\ttitle: 'Signup',\n\t\t\t\tcontent: \"Your account is activated, please continue.\",\n\t\t\t\tplacement: 'bottom'\n\t\t});\n\t\t$('#UserBar').popover('show');\n\t\twindow.setTimeout(clearLogin, 3000);\n}\n\nfunction userLogin() {\n    pushEvent('Sign In', 'Successful Sign-in', 'Y');\n}\n\nfunction userLogout() {\n\t\tpushEvent('Logout','Logout','Y');\n\t\twindow.analytics.reset(); //Segment: Reset User on logout.\n\t\twindow.location.href = '/';\n}\n\nfunction ValidateDate(inputText) {\n\t\tvar dateformat = /^(0?[1-9]|[12][0-9]|3[01])[\\/](0?[1-9]|1[012])[\\/]\\d{4}$/;\n\t\tif (inputText.value.match(dateformat)) {\n\t\t\t\treturn true;\n\t\t} else {\n\t\t\t\treturn false;\n\t\t}\n}\n\nfunction ValidateEmail(email) {\n\t\tvar re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\tif (!email.match(re)) {\n\t\t    return false;\n\t\t}\n\t\treturn true;\n}\n\nfunction ValidateNumeric(numValue) {\n\t\tif (!numValue.toString().match(/^[-]?\\d*\\.?\\d*$/)) {\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n}\n\n$(function() {\n\tlazyLoadOnScroll();\n\t$('.carousel').carousel();\n\tcarouselPause();\n\t$('.help').tooltip();\n\tif(isMobile()){\n\t\tinitializeDatePicker();\n\t}\n\tpushEventQueue();\n\n\t/* Tariff Details, FAQ, Fee and Payment Tabs */\n\t$('#tariff-header a, #faqs-tabs a, #fee-tabs a').click(function(e) {\n\t\te.preventDefault();\n\t\t$(this).siblings().removeClass('active');\n\t\t$(this).addClass('active');\n\t\t$(this).tab('show');\n\t\t// pushEvent('Wallet', 'Wallet FAQ Pop Up (Checkout)');\n\t});\n\n\t$(\".clickable-row\").click(function() {\n\t\twindow.document.location = $(this).attr(\"href\");\n\t});\n\n\t$('.pop').popover();\n\n\t$('.safe-booking, .unsafe-booking').on('hide.bs.popover', function() {\n\t\t\tvar title = $(this).attr('data-original-title');\n\t\t\tvar el = $('#row' + title);\n\t\t\tel.removeClass('highlight');\n\t});\n\n\t$('.safe-booking, .unsafe-booking').on('show.bs.popover', function() {\n\t\t\tvar title = $(this).attr('data-original-title');\n\t\t\tvar el = $('#row' + title);\n\t\t\tel.addClass('highlight');\n\t});\n\n\t//flag to prevent bogus google analytics events\n\tvar flg = true;\n\t$('.safe-booking, .unsafe-booking').on('show.bs.popover', function() {\n\t\t\tif (flg) {\n\t\t\t\t\tpushEvent('Wallet', 'Graph Booking Icon (My Bookings)');\n\t\t\t\t\tflg = false;\n\t\t\t} else {\n\t\t\t\t\tflg = true;\n\t\t\t}\n\t});\n\n\t$('#active_city').html(city_name);\n\t$(\".cityDropdown li a\").click(function(){\n\t\t// js issue in production, hence removing this code, selecetd_city is not defined anywhere\n\t\t// selected_city.attr('data-cargroup_id',$(this).data('cargroup_id'));\n\t});\n\n\t// using this for wallet skip experiment\n  var cookie = getCookie('alphabtestx8');\n  if(cookie) {\n  \t$('.skip-citrus:eq(1)').css(\"display\",\"block\");\n  \t$('.citrus_text:eq(1)').css(\"display\",\"block\");\n  }\n\n\t// jQuery(\"#resume_widget\").addClass(\"open\");\n\tjQuery('body').on('click',\".pull_header\", function(){\n\t\tif(jQuery(\".open\").length) {\n\t\t\tjQuery(\"#resume_widget\").animate({right:\"-210px\"});\n\t\t\tjQuery(\"#resume_widget\").removeClass(\"open\");\n\t\t}\n\t\telse {\n\t\t\tjQuery(\"#resume_widget\").animate({right:\"0px\"});\n\t\t\tjQuery(\"#resume_widget\").addClass(\"open\");\n\t\t}\n\t});\n\tcount_close = 1;\n\tjQuery('body').on('click', \"#resume_widget\", function(){\n\t\t\tif(count_close == 1){\n\t\t\t\t$('#resume_widget').css('display','none');\n\t\t\t}\n\t\t\t$.ajax({\n\t\t\ttype: \"GET\",\n\t\t\turl: 'resume_close',\n\t\t\tsuccess:function(result){\n\t\t\t}\n\t\t});\n\t});\n\n\t// Notification for resume widget\n\t$(document).mouseup(function (e) {\n\t\tvar target1 = $(\".resume_widget_button\");\n\t\tvar target2 = $(\".resume_widget_dropmenu\");\n\t\tif (!target1.is(e.target) && target1.has(e.target).length === 0) {\n\t\t\t$('.resume_widget_notification').show();\n\t\t}\n\t});\n\n\tvar url = document.location.toString();\n\tif (url.match('#')) {\n\t\tvar anchor = url.split('#')[1];\n\t\tif (anchor == 'faq-42') {\n\t\t\t$('#faqs-tabs a[href=#faqs-7]').tab('show').addClass('active').siblings().removeClass('active');\n\t\t\t$(document).scrollTop($('#faq-42').offset().top);\n\t\t}\n\t}\n\n\tif ($('body').hasClass('body-header-new')) {\n\t\t\t$(document).scroll(function() {\n\t\t\t\t\tif ($(document).scrollTop() >= 115) {\n\t\t\t\t\t\t\t$('#HomepageForm')\n\t\t\t\t\t\t\t\t\t.addClass('line-bg border-b-c')\n\t\t\t\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\t\t\t\t\t'position': 'fixed',\n\t\t\t\t\t\t\t\t\t\t\t'z-index': 10,\n\t\t\t\t\t\t\t\t\t\t\t'top': '96px',\n\t\t\t\t\t\t\t\t\t\t\t'height': '40px',\n\t\t\t\t\t\t\t\t\t\t\t'width': '100%',\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.find('.widget-hor')\n\t\t\t\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\t\t\t\t\t'top': '0'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.children().first().removeClass('bg r-5 bs-3').css({\n\t\t\t\t\t\t\t\t\t\t\t'padding': '4px 10px 4px 10px'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#HomepageForm')\n\t\t\t\t\t\t\t\t\t.removeClass('line-bg border-b-c')\n\t\t\t\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\t\t\t\t\t'position': 'relative',\n\t\t\t\t\t\t\t\t\t\t\t'z-index': 10,\n\t\t\t\t\t\t\t\t\t\t\t'top': '0',\n\t\t\t\t\t\t\t\t\t\t\t'height': '40px',\n\t\t\t\t\t\t\t\t\t\t\t'width': '100%',\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.find('.widget-hor')\n\t\t\t\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\t\t\t\t\t'top': '107px'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.children().first().addClass('bg r-5 bs-3').css({\n\t\t\t\t\t\t\t\t\t\t\t'padding': '10px'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t});\n\t}\n\n\n\t$('#proceedToPayment').click(function() {\n\t\t\t$('.tariff-details').slideUp();\n\n\t\t\t$('.payment-options').slideDown();\n\n\t\t\treturn false;\n\t});\n\n\t$('[data-toggle=\"popover\"]').popover();\n\n\t$('body').on('click', function(e) {\n\t\t\t$('[data-toggle=\"popover\"]').each(function() {\n\t\t\t\t\t//the 'is' for buttons that trigger popups\n\t\t\t\t\t//the 'has' for icons within a button that triggers a popup\n\t\t\t\t\tif (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {\n\t\t\t\t\t\t\t$(this).popover('hide');\n\t\t\t\t\t}\n\t\t\t});\n\t});\n\n\t$(\".credits-popover\").hover(function() {\n\t\t\t\t\t$(\".walletPage-popupBox\").css(\"display\", \"block\");\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\t\t$(\".walletPage-popupBox\").css(\"display\", \"none\");\n\t\t\t});\n\n\t$(\".creditsDescBtn-showPage\").hover(function() {\n\t\t$(\".booking-showPage-popupBox\").css(\"display\", \"block\");\n\t},\n\tfunction() {\n\t\t$(\".booking-showPage-popupBox\").css(\"display\", \"none\");\n\t});\n\n});\n\n\nfunction verifyGoDaddySSLSeal() {\n\tvar bgHeight = \"460\";\n\tvar bgWidth = \"593\";\n\tif (document.location.hostname === \"www.zoomcar.com\") {\n\t\t\tvar sealId = \"Ny6EijIfOSXkAo0dlbSlYNs0ZFMtzRvqFfiLzW78jh8vlbbgLpcc7s\";\n\t} else {\n\t\t\tvar sealId = \"3yCVbZLiXFziOzM9ZKtu3FP5qb8hkkipd76ehYTJzYmggPqLSbF1u4Vn\";\n\t}\n\tvar url = \"https:\\/\\/seal.godaddy.com\\/verifySeal?sealID=\" + sealId;\n\twindow.open(url, 'SealVerfication', 'menubar=no,toolbar=no,personalbar=no,location=yes,status=no,resizable=yes,fullscreen=no,scrollbars=no,width=' + bgWidth + ',height=' + bgHeight);\n}\n\t\t// $('input.credit-card-cvv')\n\t\t// \t.payment('formatCardCVC')\n\t\t// \t.focus(function(){\n\t\t// \t$('#credit-card-cvv-icon').fadeIn();\n\t\t// })\n\t\t// \t.blur(function(){\n\t\t// \t$('#credit-card-cvv-icon').fadeOut();\n\t\t// });\n\nfunction trackPagesForAnalytics() {\n  try{\n    var url = window.globals.analytics_url + \"/track/page?\";\n    url += '&datetime=' + new Date().getTime() + \"&referral=\" + encodeURIComponent(document.referrer) + \"&ga=\" + encodeURIComponent(getGaCookie()) + \"&title=\" + encodeURIComponent(document.title);\n    var trackImg = new Image();\n    trackImg.onload = function() {\n    \ttrackImg.src = this.src;\n    }\n    trackImg.src = \"https://\" + url;\n  }\n  catch(e){\n\n\t}\n}\n\nfunction trackEventsForAnalytics(category, action, label) {\n\ttry{\n\t\tvar url = window.globals.analytics_url + \"/track/event?\";\n\t\tvar url_components = '';\n\t\turl_components += \"category=\" + encodeURIComponent(category);\n\t\turl_components += \"&act=\" + encodeURIComponent(action);\n\t\tif(label) {\n\t\t\turl_components += \"&label=\" + encodeURIComponent(label);\n\t\t}\n\t\turl_components += '&datetime=' + new Date().getTime() + \"&referral=\" + encodeURIComponent(document.referrer);\n\t\turl += url_components;\n\t\tvar trackImg = new Image();\n\t\ttrackImg.onload = function() {\n\t\t\ttrackImg.src = this.src;\n\t\t}\n\t\ttrackImg.src = \"https://\" + url;\n\t}\n\tcatch(e){\n\n\t}\n}\n\nfunction getGaCookie(){\n\tvar ga = document.cookie.split(';');\n\tfor(var i = 0; i < ga.length; i++){\n\t\tif(ga[i].search(\"__utma\") != -1){\n\t\t\tvar gaUid = ga[i].split('=')[1];\n\t\t\treturn gaUid.substring(0,gaUid.indexOf(\".\", gaUid.indexOf(\".\", gaUid.indexOf(\".\") + 1) + 1));\n\t\t}\n\t}\n\treturn \"\";\n}\n\n//function send_analytics_cookies(){\n//\t$.ajax({\n//\t\ttype: \"GET\",\n//\t\turl: \"get_analytics_cookies\",\n//\t\tsuccess:function(result){\n//\t\t\tpushEvent('Analytics', result.uid, result.unique_session);\n//\t\t}\n//\n//\t});\n//}\n\n/*-------Referral Page------------*/\n$(document).ready(function(){\n\tfunction clearEmailSent() {\n\t\t$('#ReferForm, #r-email').popover('destroy');\n\t}\n\t$(\"#ReferForm #submit-refer\").click(function(e){\n\t\tvar el = $(\"#ReferForm\");\n\t\te.preventDefault();\n\t\tif($('#r-email').val() != '') {\n\t\t\t$.ajax({\n\t\t\t\ttype: \"POST\",\n\t\t\t\turl: $(\"#ReferForm\").attr('action'),\n\t\t\t\tdata: {email:$(\"#r-email\").val()},\n\t\t\t\tsuccess:function(result){\n\t\t\t\t\tif(result.err == false) {\n\t\t\t\t\t\tel.popover({\n\t\t\t\t\t\t\t// title: 'Email sent',\n\t\t\t\t\t\t\tcontent: result.response\n\t\t\t\t\t\t}).popover(\"show\");\n\t\t\t\t\t\twindow.setTimeout(clearEmailSent, 7000);\n\t\t\t\t\t\twindow.setTimeout(function(){location.reload()},7000)\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t$(\"#r-email\").popover({\n\t\t\t\t\t\t\tcontent: result.response\n\t\t\t\t\t\t}).popover(\"show\");\n\t\t\t\t\t\twindow.setTimeout(clearEmailSent, 7000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t$(\"#r-email\").popover({\n\t\t\t\tcontent: \"Please enter email address\"\n\t\t\t}).popover(\"show\");\n\t\t\twindow.setTimeout(clearEmailSent, 5000);\n\t\t}\n\t});\n\tif(window.location.pathname == '/bookings') {\n\t\t$.ajax({\n\t\t\ttype: \"GET\",\n\t\t\turl: \"extwallets/get_balance\",\n\t\t\tsuccess:function(result){\n\t\t\t\tvar amount = result.value;\n\t\t\t\t$('.ex-wall-loader').hide();\n\t\t\t\t$('#ext-wall-amt').text('' + result.value);\n\t\t\t\t$('.ext-wall-amt').show();\n\t\t\t}\n\n\t\t});\n\t}\n\n\t$('.selectpicker').selectpicker();\n\t//trackPagesForAnalytics();\n//\tsend_analytics_cookies();\n});\n\n// $('#DetailsSubmit input').attr('disabled',true);\n  // $('#citrus').click(function () {\n  //   var $this = $(this);\n  //   if ($this.is(':checked')) {\n  //     $('#citrus-account-details').show();\n  //     $('#DetailsSubmit input').attr('disabled',true);\n  //     $('.nornmal-email').hide();\n  //   } else {\n  //     $('#citrus-account-details').hide();\n  //     $('#DetailsSubmit input').removeAttr('disabled');\n  //     $('.nornmal-email').show();\n  //   }\n  // });\n  // $('#validate-citrus').click(function(){\n  //  var cit_user = $('#citrus_email').val();\n  //  var cit_pass = $('#citrus_pass').val();\n  //  $.ajax({\n  //    type: \"POST\",\n  //    url: \"/hitApi\",\n  //    data: { cit_user : cit_user, cit_pass : cit_pass },\n  //    success:function(result){\n  //      $('#CitrusSubmiT div').attr('disabled',true);\n  //      $('#validate-citrus').text('Account verified !')\n  //    }\n  //  });\n  //  $('#cw_conf_acc').bind(\"copy paste\",function(e) {\n //      e.preventDefault();\n //    });\n  // });\n\n// Citrus Cash Sign In/ Sign Up Page\n//checkJquery_common();\n\n\n$(document).ready(function(){\n\t$(document).on('click','#create-citrus', function(){\n\t\t$('#ValidateCitrus').hide();\n\t\t$('#CreateCitrus').show();\n\t\t$('#flash_msg1').hide();\n\t\t$('#flash_msg3').hide();\n\t\t$(\"#modal_extend\").removeClass(\"modal_cw\");\n    pushEvent('External Wallet','Sign-up','');\n\t});\n\t$(document).on('click','#already-citrus', function(){\n\t\t$('#ValidateCitrus').show();\n\t\t$('#CreateCitrus').hide();\n\t\t$(\"#modal_extend\").removeClass(\"modal_cw\");\n    pushEvent('External Wallet','Sign in','');\n\t});\n\t$(document).on('click','#forget-password', function(){\n\t\t$('#flash_msg2').hide();\n\t\t$('#forgotPassword').show();\n\t\t$('#ValidateCitrus').hide();\n\t\t$(\"#modal_extend\").removeClass(\"modal_cw\");\n    pushEvent('External Wallet','Forgot password','');\n\t});\n\n\t$(document).on('click','#create-citrus2', function(){\n\t\t$('#forgotPassword').hide();\n\t\t$('#CreateCitrus').show();\n\t\t$('#flash_msg1').hide();\n\t\t$('#flash_msg3').hide();\n    pushEvent('External Wallet','Sign-up','');\n\t});\n\t$(document).on('click','#already-citrus2', function(){\n\t\t$('#forgotPassword').hide();\n\t\t$('#ValidateCitrus').show();\n\t\t$('#flash_msg1').hide();\n\t\t$('#flash_msg3').hide();\n    pushEvent('External Wallet','Sign in','');\n\t});\n\n\t// To forbid multiple ajax calls for the same request\n\tvar eventDispatcherReset = null;\n\n\t$(document).on('click','#Reset-citrus',function(){\n\t\t\t$(\"#CwForgetForm\").validator().on('submit', function(e){\n\t\t\t\tif (e.isDefaultPrevented()) {\n\t\t\t\t\t$('create-citrus2').off('click');\n\t\t\t    $('.with-errors').each(function(){\n\t\t\t\t\t\tif($(this).text().trim() !== \" \"){\n\t\t\t\t\t\t\t$(this).css('visibility', 'visible');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t  }\n\t\t\t  else{\n\t\t\t  \tif(eventDispatcherReset) clearTimeout(eventDispatcherReset);\n\t\t\t\t   eventDispatcherReset = setTimeout(function(){\n\t\t\t\t     \tvar email = $('#cw_user').val();\n\t\t\t\t\t\t\t$('.modal-loader-reg').show();\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\ttype:\"POST\",\n\t\t\t\t\t\t\t\t\turl: \"/extwallets/forgot_password\",\n\t\t\t\t\t\t\t\t\tdata: {email: email},\n\t\t\t\t\t\t\t\t\tsuccess:function(result){\n\t\t\t\t\t\t\t\t\t\tif(result.success === true){\n\t\t\t\t\t\t\t\t\t\t\t$(\".details-info\").hide();\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg1').show();\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg1').addClass('zoom');\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg1').removeClass('maroon');\n\t\t\t\t\t\t\t\t\t\t\t// $('#flash_msg1').addClass(\"alert alert-success\");\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg1').html(result.message);\n\t\t\t\t\t\t\t\t\t\t\t$('#forgotPassword').hide();\n\t\t\t\t\t\t\t\t\t\t\t$('.modal-loader-reg').hide();\n\t\t\t\t\t\t\t\t\t\t\t$('#ValidateCitrus').show();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg2').show();\n\t\t\t\t\t\t\t\t\t\t\t// $('#flash_msg2').addClass(\"alert alert-danger\");\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg2').addClass('maroon');\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg2').removeClass('zoom');\n\t\t\t\t\t\t\t\t\t\t\t$('#flash_msg2').html(result.message);\n\t\t\t\t\t\t\t\t\t\t\t$('.modal-loader-reg').hide();\n\t\t\t\t\t\t\t\t\t\t\t$('#forgotPassword').show();\n\t\t\t\t\t\t\t\t\t\t\t$('#cw_user').val(\"\");\n\t\t\t\t\t\t\t\t\t\t\t$(\"#modal_extend\").addClass(\"modal_cw\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t   }, 300);\n\t\t\t  }\n\t\t\t});\n\t});\n\n\t$(document).on('click','.skip-citrus, .mobile-skip-citrus',function(event){\n\t\tevent.preventDefault();\n\t\tif(location.pathname.indexOf(\"bookings\") === -1 ) {\n\t\t  window.location.href = '/';\n\t\t} else {\n\t\t\twindow.location.href = 'https://'+ window.location.host + '/' + user_city + '/bookings/checkout?skip=true';\n\t\t}\n\t});\n\n\t$(document).on('click','#register-citrus',function(){\n\t\t\tpushEvent(\"Wallet\", \"Sign Up\", window.location.pathname);\n\t\t\t$(\"#CwCreateForm\").validator().on('submit', function(e){\n\t\t\t\tif (e.isDefaultPrevented()) {\n\t\t\t    $('.with-errors').each(function(){\n\t\t\t\t\t\tif($(this).text().trim() !== \"Dummy\"){\n\t\t\t\t\t\t\t$(this).css('visibility', 'visible');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t  }\n\t\t\t});\n\t\t\tvar user_reg = $('#cw_user_new').val();\n\t\t\tvar pass_reg = $('#cw_pass_new').val();\n\t\t\tvar confirm_reg = $('#cw_pass_confirm').val();\n\t\t\t\t\t$('.modal-loader-reg').show();\n\t\t\t\t\tif(validatePwd() == true && validateEmailId() == true){\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\ttype:\"POST\",\n\t\t\t\t\t\t\turl: \"/extwallets/create_citrus\",\n\t\t\t\t\t\t\tdata: {email: user_reg,\n\t\t\t\t\t\t\t\t\t\tpassword: pass_reg,\n\t\t\t\t\t\t\t\t\t\tconfirm_password: confirm_reg},\n\t\t\t\t\t\t\tsuccess:function(result){\n\t\t\t\t\t\t\t\tif(result.success === true){\n\t\t\t\t\t\t\t\t\t$(\"#modal_extend\").removeClass(\"modal_cw\");\n\t\t\t\t\t\t\t\t\t$(\".details-info\").hide();\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').show();\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').removeClass('maroon');\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').addClass('zoom');\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').removeClass(\"alert alert-danger alert-gap\");\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').addClass(\"alert alert-success alert-gap\");\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').html(result.message);\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').parent().prev('.loginHeading').addClass('errorHeading');\n\t\t\t\t\t\t\t\t\t$('#CwCreateForm').hide();\n\n\t\t\t\t\t\t\t\t\t// Redirect to checkout from signup (but not on my bookings)\n\t\t\t\t\t\t\t\t\tif (location.pathname.indexOf('walletdetails') !== -1 || location.pathname.indexOf('userdetails') !== -1) {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t\t\twindow.location.pathname = '/' + user_city + '/bookings/checkout';\n\t\t\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\t  window.location.reload(true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#modal_extend\").addClass(\"modal_cw\");\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').show();\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').addClass(\"alert alert-danger alert-gap\");\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').addClass('maroon');\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').removeClass('zoom');\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').html(result.message);\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').parent().prev('.loginHeading').addClass('errorHeading');\n\t\t\t\t\t\t\t\t\t$('.modal-loader-reg').hide();\n\t\t\t\t\t\t\t\t\t$('#CreateCitrus').show();\n\t\t\t\t\t\t\t\t\t$('#cw_user_new').val(\"\");\n\t\t\t\t\t\t\t\t\t$('#cw_pass_new').val(\"\");\n\t\t\t\t\t\t\t\t\t$('#cw_pass_confirm').val(\"\");\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (result.is_wallet_tried === true) {\n\t\t\t\t\t\t\t\t\t// $.get('/users/cw_signup_error_view', {}, function (wait_html) {\n\t\t\t\t\t\t\t\t\t// \t$('.citrus-account-details').html(wait_html);\n\t\t\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t\t\t// \tsetTimeout(function () {\n\t\t\t\t\t\t\t\t\t// \twindow.location.pathname = '/' + user_city + '/bookings/checkout';\n\t\t\t\t\t\t\t\t\t// \t}, 2000);\n\t\t\t\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t\t\t\tif (location.pathname.indexOf('walletdetails') !== -1)\n\t\t\t\t\t\t\t\t\t\t$('#CwCreateForm .skip-citrus, #CwCreateForm .citrus_text').css(\"display\",\"block\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').addClass(\"alert alert-success alert-gap\");\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').addClass('zoom');\n\t\t\t\t\t\t\t\t\t// $('#flash_msg3').removeClass('maroon');\n\t\t\t\t\t\t\t\t\t$('#flash_msg3').html(result.message);\n\t\t\t\t\t\t\t\t\t$('.modal-loader-reg').hide();\n\t\t\t\t\t\t\t\t\t$('#CreateCitrus').show();\n\t\t\t\t\t\t\t\t\t$(\"#modal_extend\").addClass(\"modal_cw\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},error:function(){\n\t\t\t\t\t\t\t\t// $('#flash_msg3').addClass(\"alert alert-danger alert-gap\");\n\t\t\t\t\t\t\t\t$('#flash_msg3').addClass('maroon');\n\t\t\t\t\t\t\t\t$('#flash_msg3').removeClass('zoom');\n\t\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\t} else {\n\t            // $('#flash_msg3').addClass(\"alert alert-danger alert-gap\");\n\t\t\t\t\t\t\t$('#flash_msg3').addClass('maroon');\n\t\t\t\t\t\t\t$('#flash_msg3').removeClass('zoom');\n\t\t\t\t\t\t\t$(\"#modal_extend\").addClass(\"modal_cw\");\n\t\t\t\t\t\t\t$('#flash_msg3').parent().prev('.loginHeading').removeClass('errorHeading');\n\t\t\t\t\t}\n\t});\n\n\t// To forbid multiple ajax calls for the same request\n\tvar eventDispatcherValidate = null;\n\n  $(document).on('click','#validate-citrus',function(){\n    pushEvent(\"Wallet\", \"Sign In\", window.location.pathname);\n    $(\"#CwValidateForm\").validator().on('submit', function(e){\n      if (e.isDefaultPrevented()) {\n        $('.with-errors').each(function(){\n          if($(this).text().trim() !== \"Dummy\"){\n            $(this).css('visibility', 'visible');\n          }\n        });\n      }\n      else{\n        if(eventDispatcherValidate) clearTimeout(eventDispatcherValidate);\n        eventDispatcherValidate = setTimeout(function(){\n          var user_reg = $('#cw_user_old').val();\n          var pass_reg = $('#cw_pass_old').val();\n          $('.modal-loader-reg').show();\n            $.ajax({\n              type:\"POST\",\n              url: \"/extwallets/validate_citrus\",\n              data: {email: user_reg,\n                    password: pass_reg},\n              success:function(result){\n                if(result.success === true){\n                  $('.modal-loader-reg').show();\n                  $(\".details-info\").hide();\n                  $('#flash_msg1').show();\n                  $('#flash_msg1').removeClass('maroon');\n                  $('#flash_msg1').addClass('zoom');\n                  $('#flash_msg1').html(result.message);\n                  $('#CwValidateForm').hide();\n                  if(typeof user_city != 'undefined'){\n                    pushEvent('External Wallet','Successful Sign-in');\n                    var pathname = window.location.pathname;\n                    if (pathname != \"/users/profile\") {\n                      window.location.pathname = '/' + user_city + '/bookings/checkout';\n                    }\n                    else{\n                      window.location.reload(true);\n                    }\n                 }\n                }\n                else {\n                  $('#flash_msg1').show();\n                  // $('#flash_msg1').addClass(\"alert alert-danger alert-gap\");\n                  $('#flash_msg1').addClass('maroon');\n                  $('#flash_msg1').removeClass('zoom');\n                  $('#flash_msg1').html(result.message);\n                  $('.modal-loader-reg').hide();\n                  $(\".details-info\").show();\n                  $('#cw_user_old').val(\"\");\n                  $('#cw_pass_old').val(\"\");\n                }\n                if (result.is_wallet_tried === true) {\n\n                  // $.get('/users/cw_signup_error_view', {}, function (wait_html) {\n                  // \t$('.citrus-account-details').html(wait_html);\n                  // });\n\n                  if (location.pathname.indexOf('walletdetails') !== -1)\n                    $('#CwValidateForm .skip-citrus, #CwValidateForm .citrus_text').css(\"display\",\"block\");\n                }\n                else{\n                  $('#flash_msg1').show();\n                  // $('#flash_msg1').addClass(\"alert alert-danger alert-gap\");\n                  $('#flash_msg1').addClass('maroon');\n                  $('#flash_msg1').removeClass('zoom');\n                  $('#flash_msg1').html(result.message);\n                  $('.modal-loader-reg').hide();\n                  $('#ValidateCitrus').show();\n                  $(\"#modal_extend\").addClass(\"modal_cw\");\n                }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t   }, 300);\n\t\t\t  }\n\t\t\t});\n\t});\n\n\t$('#link_my_wallet').on('click', function() {\n\t  // $.get('/users/cw_signup_view', {}, function (data) {\n\n\t  // }, 'json')\n\n\t  showNewModal('Citrus Cash Account', '/users/wallet_signup_view');\n\t  return false;\n\t});\n\n});\n\n\n\n\nfunction validatePwd() {\n\tvar minLength = 8; // Minimum length\n\tvar maxLength = 16; // Maximum length\n\tvar pw1 = $('#cw_pass_new').val();\n\t// check for minimum length\n\tif (pw1.length < minLength || pw1.length > maxLength || pw1.indexOf(' ')!=-1 ) {\n\t$('#flash_msg3').show();\n\t$('#flash_msg3').addClass('maroon');\n\t$('#flash_msg3').removeClass('zoom');\n\t// $('#flash_msg3').addClass(\"alert alert-success alert-gap\");\n\t// $('#flash_msg3').html(\"Password length between 8-16. Space not allowed.\");\n\t$('.modal-loader-reg').hide();\n\treturn false;\n\t}\n\telse{\n\t\t\treturn true;\n\t}\n}\nfunction validateEmailId() {\n\tvar email= $('#cw_user_new').val();\n\t if (email.indexOf(' ')==-1\n\t\t\t\t&& 0<email.indexOf('@')\n\t\t\t\t&& email.indexOf('@')+1 < email.length\n\t ) return true;\n\t else\n\t\t$('.modal-loader-reg').hide();\n\t\talert ('Invalid email address!')\n\t\treturn false;\n}\n\nfunction referForm(frm, url, divId) {\n\t\t$(document).ready(function() {\n\t\t\t\tvar otp_code = jQuery.trim($(\"#otp_code\").val());\n\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\turl: url,\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\totp_code: otp_code\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(json) {\n\t\t\t\t\t\t\t\t$(\"#referForm\").empty().append(json.html);\n\t\t\t\t\t\t})\n\t\t});\n}\n\nfunction resendOTP() {\n\t$(document).ready(function() {\n\t\t\t$('#modal-loader-wrapper').show();\n\t\t\t$.ajax({\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\turl: '/users/send_otp_sms/',\n\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(json) {\n\t\t\t\t\t\t\t$('#modal-loader-wrapper').hide();\n\t\t\t\t\t})\n\t});\n}\n\nfunction modifyPhone() {\n\t\t$(document).ready(function() {\n\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\ttype: \"GET\",\n\t\t\t\t\t\t\t\turl: '/users/signup/',\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\treenter_phone: '1'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.done(function(json) {\n\t\t\t\t\t\t\t\t$(\"#referForm\").empty().append(json.html);\n\t\t\t\t\t\t})\n\t\t});\n}\n\n/********************** Offers page ************************************/\n\n$(function() {\n\t$('body').on('click',function(event){\n\t  if ($(event.target).parents('.newstatic') || event.target.tagName === 'BODY') {\n\t    if(event.target.className !=='offer_img') {\n\t      $(this).find('div.offer_text').slideUp();\n\t    }\n\t  }\n\t});\n});\n\nfunction showTerms(id) {\n  var display = $(\"#\" + id).css(\"display\");\n  if (display === \"none\") {\n    $(\"#\" + id).removeClass(\"hide\");\n    $('.offer_text').slideUp();\n    $(\"#\" + id).slideDown();\n  }\n  else {\n    $(\"#\" + id).slideUp();\n  }\n}\n\n/********************************************************************/\n//converting the integer into indian number format with commas\nfunction convert_indian_format(number) {\n\tvar x=number;\n\tx=x.toString();\n\tvar lastThree = x.substring(x.length-3);\n\tvar otherNumbers = x.substring(0,x.length-3);\n\tif(otherNumbers != '') {\n\t\tlastThree = ',' + lastThree;\n\t}\n\tvar res = otherNumbers.replace(/\\B(?=(\\d{2})+(?!\\d))/g, \",\") + lastThree;\n\treturn res;\n}\n/*==========================*/\n/* TARIFF CALCULATOR SLIDER\n/*==========================*/\nfunction tariffCalculate(pageLoadFlag){\n\t\t// No tariff calculation on mobiles\n\t\tif (isMobile()) return;\n\n    var current_time = new Date();\n    var hours = current_time.getHours();\n    var minutes = current_time.getMinutes();\n\n    // round the time to nearest half hour\n    var m = (parseInt((minutes + 15)/30) * 30) % 60;\n    var h = (minutes > 45 ? (hours === 23 ? 0 : ++hours) : hours) + 6;\n\n    // since the value of h goes more than 24 if it goes to the next day.\n    if(h >= 24 && h < 30){\n    \th = 30;\n    \tm = 0;\n    }\n\n    current_time.setHours(h);\n    current_time.setMinutes(m);\n\n    // adds '0' to single digit values in date, for displaying in the required format\n    function convertDate(inputFormat) {\n      function pad(s) { return (s < 10) ? '0' + s : s; }\n      var d = new Date(inputFormat);\n      return [pad(d.getDate()), pad(d.getMonth()+1), d.getFullYear()].join('/');\n    }\n\n    var formatted_date = convertDate(current_time) + \" \" + current_time.getHours() + \":\" +\n                      ((current_time.getMinutes() < 10) ? '0' + current_time.getMinutes() : current_time.getMinutes());\n\n    $(\".tariffDropdown li a\").click(function(){\n\t  var selected_car = $('#tariffCarsHtml');\n\t  selected_car.html($(this).text());\n\t  selected_car.attr('data-cargroup_id',$(this).data('cargroup_id'));\n\t\t});\n  \t// get the pickup time for the api call\n \t\t// if this slider reset function is called via page-load\n    if(pageLoadFlag){\n      var starts = formatted_date;\n      $(\"#tariffStartDateVal\").val(formatted_date);\n\n      // reset the session to initial 5 when the page loads\n      sessionStorage.setItem('slider_val', 5);\n    }\n    // if this slider reset function is called by changing either the car or the pickup date\n    else{\n      var starts = $(\"#tariffStartDateVal\").val();\n    }\n\n    // get the cargroup_id of the selected car for the api call\n\n    var cargroup_id = $('#tariffCarsHtml').attr('data-cargroup_id');\n    var fare = \"\";\n\n    // initialize a blank slider while the page loads\n    $(\"#slider2\").slider({\n      range: \"min\",\n      animate: true,\n      value: 0,\n      min: 0,\n      max: 0,\n      step: 0,\n      slide: function(event, ui) {\n        slider_update(2, ui.value, duration_array, fares, free_km, ends); //changed\n      }\n    });\n\n    $.ajax({\n      type:\"GET\",\n      url: 'calculate_tariff',\n      data: {cargroup_id: cargroup_id, starts: starts, bracket: bracket},\n      dataType: \"json\"\n    })\n    .done(function(json){\n      var duration_array = Object.keys(json.response);\n      var duration_array_length = duration_array.length;\n      var free_km = [];\n      var fares = [];\n      var ends = [];\n\n      // store the fare, duration and end dates from the api response in arrays\n      for(var i = 0; i < duration_array_length; i++){\n        fares.push(json.response[duration_array[i]].fare);\n        free_km.push(json.response[duration_array[i]].free_kms);\n        ends.push(json.response[duration_array[i]].ends);\n      }\n\n      if(pageLoadFlag){\n      \tvar val = 5;\n      }\n      else{\n      \tvar val = sessionStorage.getItem('slider_val');\n      }\n\n      // set the selected duration of trip to an initial 10 hours\n      $('#duration-label').text(duration_array[val]);\n\n      // set the fare for 10 hours\n      $(\"#tariffTotal1\").text(convert_indian_format(fares[val][0]));\n      $(\"#tariffTotal2\").text(convert_indian_format(fares[val][1]));\n      $(\"#tariffTotal3\").text(convert_indian_format(fares[val][2]));\n\n      // set the free kms for 10 hours\n      $('#driveFree1').text(convert_indian_format(free_km[val][0])+ \" km free\");\n      $('#driveFree2').text(convert_indian_format(free_km[val][1])+ \" km free\");\n      $('#driveFree3').text(convert_indian_format(free_km[val][2])+ \" km free\");\n\n      // set the end date for 10 hours, not displayed but used for checking availability\n      $( \"#ends-form\" ).val(ends[val]);\n\n      // set the hidden form elements for start and cargroup for checking availability\n      $( \"#starts-form\" ).val($(\"#tariffStartDateVal\").val());\n      $( \"#cargroup-form\" ).val($('#tariffCarsHtml').attr('data-cargroup_id'));\n\n      $(\"#slider2\").slider({\n        range: \"min\",\n        animate: true,\n        value: val,\n        min: 0,\n        max: duration_array_length-1,\n        step: 1,\n        slide: function(event, ui) {\n          slider_update(2, ui.value, duration_array, fares, free_km, ends); //changed\n          sessionStorage.setItem('slider_val', ui.value);\n        }\n      });\n    })\n}\n\n//changed. now with parameter\nfunction slider_update(slider, val, tariffHours, fares, free_km, ends) {\n  //changed. Now, directly take value from ui.value. if not set (initial, will use current value.)\n  if(typeof val === 'undefined')\n    var slider_position = parseInt(0);\n  else\n    var slider_position = parseInt(val);\n\n  $( \"#starts-form\" ).val($(\"#tariffStartDateVal\").val());\n  $( \"#ends-form\" ).val(ends[slider_position]);\n  $( \"#cargroup-form\" ).val($('#tariffCarsHtml').attr('data-cargroup_id'));\n\n  $(\"#duration-label\").text(tariffHours[slider_position]);\n  // tariff price\n  $(\"#tariffTotal1\").text(convert_indian_format(fares[slider_position][0]));\n  $(\"#tariffTotal2\").text(convert_indian_format(fares[slider_position][1]));\n  $(\"#tariffTotal3\").text(convert_indian_format(fares[slider_position][2]));\n\n  // tariff free Kms\n  $('#driveFree1').text(convert_indian_format(free_km[slider_position][0])+ \" km free\");\n  $('#driveFree2').text(convert_indian_format(free_km[slider_position][1])+ \" km free\");\n  $('#driveFree3').text(convert_indian_format(free_km[slider_position][2])+ \" km free\");\n}\n\n$(function() {\n\n\t/**************** New Commute page **********************/\n\n\t$('.comType').on('click', function(){\n\t  var $el = $(this);\n\t  var id = $el.attr(\"id\");\n\t  var kms = $el.attr(\"data-kms\");\n\t  var loc_id = $el.closest('.commute_card').find('.commute_loc_dropdown .comtxt').attr(\"data-loc\");\n\t  var car = $el.closest('.commute_card').find('.commute_carname h4').text();\n\n\t\t$el.closest('.commute_card').find('.comType').css(\"background-color\",\"#e8e6e6\");\n\t\t$el.closest('.commute_card').find(\"[data-tick]\").css(\"display\",\"none\");\n\t  $(\"#\"+ id).css(\"background-color\",\"#ffffff\");\n\t  $el.find(\".commute_tick\").css(\"display\",\"block\");\n\t  $el.closest('.commute_card').find('.commuteCode').val(id);\n\t  $el.closest('.commute_card').find('.commuteLocationId').val(loc_id);\n\t  $el.closest('.commute_card').find('.commuteKms').val(kms);\n\t});\n\n\t$('.commutecityDropdown').on('click', 'li a', function() {\n\t  var $el = $(this);\n\t  var loc_id = $el.attr(\"data-loc-id\");\n\t  $el.closest(\".Commlocation\").find('.commute_loc_dropdown .comtxt').text($el.text());\n\t  $el.closest(\".Commlocation\").find('.commute_loc_dropdown .comtxt').attr(\"data-loc\",loc_id);\n\t  $el.closest('.commute_card').find('.commuteLocationId').val(loc_id);\n\t});\n\n\t$('.selectedDate').on('click', function(){\n\t  $('.selectedDate').css(\"background-color\",\"#e8e6e6\");\n\t  var $el = $(this);\n\t  var commuteDate = $el.attr(\"data-commute-date\");\n\t  $(\"[data-commute-date=\\\"\"+commuteDate+\"\\\"]\").css(\"background-color\",\"#ffffff\");\n\t  $('.commuteLoader').removeClass(\"hide\");\n\n\t\twindow.location.href = \"/\"+city_name_downcase+\"/commute?start_time=\" + commuteDate + \"/#grabCommute\"\n\t\t// hiding the loader after sometime\n\t\twindow.setTimeout(function(){\n\t\t\t$('.commuteLoader').addClass(\"hide\");\n\t\t}, 3000);\n\n\t});\n});\n\n/**************** CONTACT US page **********************/\n$(document).ready(function(){\n\tresetContactUs();\n\n\t$('.issue-list > li').on(\"mouseover\", function(){\n\t\tvar $el = $(this);\n\t\tvar id = $el.attr('id');\n\t\tvar data_issue = $el.attr('data-issue');\n\t\t$(\".issueText .caret\").hide();\n\t\t$(\"#\" +id+ \" .caret\").show();\n\t\t$(\"[data-subissue]\").hide();\n\t\t$(\"[data-subissue=\\\"\"+data_issue+\"\\\"]\").show();\n\t\t$('.detail-list').show();\n\t\t$('.detail-list').css(\"border\",\"1px solid #ccc\");\n\t\tif (id === \"issue6\") {\n\t\t\t$('.detail-list').css(\"margin-top\",\"195px\");\n\t\t}\n\t\telse if (id === \"issue5\") {\n\t\t\t$('.detail-list').css(\"margin-top\",\"80px\");\n\t\t}\n\t\telse {\n\t\t\t$('.detail-list').css(\"margin-top\",\"0\");\n\t\t}\n\t});\n\n\t$('.issue-list').mouseleave(function(){\n\t\tresetContactUs();\n\t});\n\n\t$('.right-pane .panel-default').click(function(){\n\t\tvar $el = $(this);\n\t\t$('.right-pane .panel-default .panel-heading').children(\"img\").removeClass(\"rotated\");\n\t\tif ($el.find('div').hasClass(\"collapse\")) {\n\t\t\tpushEvent('Contact us', 'Top Queries',$el.find(\".panel-heading\").text().trim());\n\t\t\t$el.find(\".panel-heading img\").addClass(\"rotated\");\n\t\t}\n\t\telse {\n\t\t\t$el.find(\".panel-heading img\").removeClass(\"rotated\");\n\t\t}\n\t});\n\n\t$('.relatedQueries .panel-default').click(function(){\n\t\tvar $el = $(this);\n\t\t$('.relatedQueries .panel-default .panel-heading').children(\"img\").removeClass(\"rotated\");\n\t\tif ($el.find('div').hasClass(\"collapse\")) {\n\t\t\tpushEvent('Contact us', 'Main Query',$el.find(\".panel-heading\").text().trim());\n\t\t\t$el.find(\".panel-heading img\").addClass(\"rotated\");\n\t\t}\n\t\telse {\n\t\t\t$el.find(\".panel-heading img\").removeClass(\"rotated\");\n\t\t}\n\t});\n\n\t/* My Account */\n\n\t$('.edit_user').on('submit', function () {\n\t\tvar $el = $(this),\n\t\t\t$form = $el.closest('form'),\n\t\t\t$user_name =  $('#user_name'),\n\t\t\t$user_phone = $('#user_phone'),\n\t\t\t$user_gender = $('#user_gender');\n\n\t\tvar userDetails = {\n\t\t\t'Name': ($user_name.length > 0) ? $user_name.val().trim() : '',\n\t\t\t'Phone': ($user_phone.length > 0) ? $user_phone.val().trim() : '',\n\t\t\t'Identity': $form.data('user-id'),\n\t\t\t// Since we don't take the gender by default during signup\n\t\t\t// and we simply save false (Male) in the DB\n\t\t\t'Gender': (($user_gender.length > 0) && $user_gender.val().trim() === 'false') ? 'M' : 'F'\n\t\t};\n\n\t\tif (userDetails['Phone'].length === 10)\n\t\t\tuserDetails['Phone'] = '+91' + userDetails['Phone'];\n\t});\n\n});\n\nfunction resetContactUs() {\n\t$(\".issueText .caret\").hide();\n\t$('.issue-list .issueText').first().children().show();\n\t$('.detail-list').hide();\n}\n\nfunction SelectIssue(issue, subissue,mainId,subId,login,booking, call) {\n\tcontactLogin = login;\n\tissueID = mainId;\n\tsubissueID = subId;\n\tbooking_id_required = booking;\n\tpushEvent('Contact us',issue,subissue);\n\t$('.issue-wrapper').hide();\n\t$('.issueRibbon').show();\n\t$('#mainI').html(issue);\n\t$('#subI').html(subissue);\n\t$(\"[data-query]\").hide();\n\t$(\"[data-query=\\\"\"+subId+\"\\\"]\").show();\n\t$('.relatedQueries').show();\n\t$.ajax({\n\t\ttype: \"GET\",\n\t\turl: '/contactus_query',\n\t\tdataType: 'json'\n\t})\n\t.done(function(json) {\n\t\tvar faqs = $('.relatedQueries').find('div:visible').length;\n\t\t$('.query-selector').show();\n\t\t$('.query-selector').html(json.query);\n\t\t$('#or').addClass(\"hide\");\n\t\t$('#call').addClass(\"hide\");\n\t\t$('.call-query').css(\"display\",\"none\");\n\t\tif (call === \"true\") {\n\t\t\t$('#or').removeClass(\"hide\");\n\t\t\t$('#call').removeClass(\"hide\");\n\t\t}\n\t\t$('.query-wrapper').hide();\n\t\tif ( faqs < 3) {\n\t\t\t$($('.faqlink')[0]).hide();\n\t\t\t$('#not-satisfied').html(\"Have any questions?\");\n\t\t}\n\t\telse {\n\t\t\t$($('.faqlink')[0]).show();\n\t\t}\n\t});\n}\n\nfunction call() {\n\tpushEvent('Contact us', 'Get Contact number');\n\t$('#call').addClass(\"hide\");\n\t$('.call-query').css(\"display\",\"inline-block\");\n}\n\nfunction renderIssue() {\n\t$('.issue-wrapper').show();\n\t$('#issue1 .caret').show();\n\t$('.issueRibbon').hide();\n\t$('.relatedQueries').hide();\n\t$('.query-selector').hide();\n\t$('.query-wrapper').hide();\n}\n\nfunction verifyUserLogin() {\n\tpushEvent('Contact us', 'Verify user for login and display query form');\n  var issue = $('#mainI').html();\n  if (contactLogin === \"true\") {\n    contactFlag = 1;\n\t\tdoLogin();\n  }\n  else {\n    DisplayQueryForm();\n    contactQuery();\n  }\n}\n\nfunction DisplayQueryForm() {\n\tpushEvent('Contact us', 'Send your Query');\n  var issue = $('#mainI').html();\n\t\t$.ajax({\n\t\t\ttype: \"GET\",\n\t\t\turl: '/contactus_submitForm',\n\t\t\tdataType: 'json'\n\t\t})\n\t\t.done(function(json) {\n\t\t\t$('.query-wrapper').show();\n\t\t\t$(\".query-wrapper\").html(json.contact);\n\t\t\tif (contactLogin === \"true\") {\n\t\t    $('#booking').show();\n\t\t  }\n\t\t  else {\n\t\t    $('#booking').hide();\n\t\t  }\n\t\t  $('.query-selector').hide();\n\t\t});\n\t}\n\nfunction EmailValidator(email) {\n\tvar re = /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\tif (email.match(re)) {\n\t    return true;\n\t}\n}\n\nfunction selectBookingID(RowId) {\n  $('#BookingID').html(RowId);\n\t$('#BookingID').css(\"border\",\"1px solid #adaeaf\");\n  $('#ContactModal').modal('hide');\n}\n\n/********************************************************************/\n\nfunction newsletter_signup(e) {\n\t$('#DealSignUpForm').validator();\n\tvar email = '';\n\tif (e) {\n\t\temail = e;\n\t} else {\n\t\temail = $('#DealsEmail').val();\n\t}\n\n\tvalid = false;\n\tvalid = EmailValidator(email);\n\n\tif (valid == true) {\n\t\t$.ajax({\n\t\t\t\ttype:\"POST\",\n\t\t\t\turl: '/newsletter',\n\t\t\t\tdata: {\n\t\t\t\t\temail: email\n\t\t\t\t},\n\t\t\t\tdataType: \"json\"\n\t\t})\n\t\t.done(function(json){\n\t\t\tif (json.status == \"success\") {\n\t\t\t\t$('.news').hide();\n\t\t\t\t$('#message').show();\n\t\t\t\t$('#message').css(\"color\",\"#6ABD19\");\n\t\t\t\t$('#message').html(json.message);\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\t$('#DealModal').modal('hide');\n\t\t\t\t}, 3000);\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#message').show();\n\t\t\t\t$('#message').css(\"color\",\"#b94a48\");\n\t\t\t\t$('#message').html(\"You have already signed up for the deals newsletter\");\n\t\t\t}\n\t\t});\n\t}\n\telse {\n\t\t$('#message').show();\n\t\t$('#message').css(\"color\",\"#b94a48\");\n\t\t$('#message').html(\"Invalid email address!\");\n\t}\n}\n\n/*\n  For User Settings pages\n*/\n\nif (typeof window.user_settings_modal !== 'undefined' && window.user_settings_modal === true) {\n  showNewModal('Phone Number Verification', '/users/signup');\n}\n/*==========================*/\n/* TARIFF CALCULATOR SLIDER\n/*==========================*/\nvar tariff_response;\n$(document).ready(function() {\n\n  var flexiTariffPanels = $('.tab-pane');\n\n  flexiTariffPanels.each(function(){\n  \tvar firstPanel = $(this).find('.panel:eq(0)');\n\n  \tfirstPanel.find('.noncollapse-head-first').removeClass('show');\n\n  \tfirstPanel.find('.noncollapse-head-first').addClass('hide');\n\n  \tfirstPanel.find('.collapse-head-first').removeClass('hide');\n\n  \tfirstPanel.find('.glyphicon').addClass('glyphicon-chevron-up');\n\n  \tfirstPanel.find('.glyphicon').removeClass('glyphicon-chevron-down');\n  });\n\n  $('.panel').on('shown.bs.collapse', function (e) {\n    $(window).scroll();\n  });\n  $('.panel').on('hidden.bs.collapse', function (e) {\n    $(window).scroll();\n  });\n\n  function togglePanelClasses(selector, hasCl, changeCl){\n    if(selector.hasClass(hasCl)){\n      selector.removeClass(hasCl);\n      selector.addClass(changeCl);\n    }\n    else{\n      selector.removeClass(changeCl);\n      selector.addClass(hasCl);\n    }\n  }\n\n  $('.each-panel').on('click', function(e) {\n    var collapse = $(this).parents('.tariff-car-accordion-title').find(\".collapse-head-first\");\n    var noncollapse = $(this).parents('.tariff-car-accordion-title').find(\".noncollapse-head-first\");\n    var glyph = $(this).parents('.tariff-car-accordion-title').find(\".glyphicon\");\n    var category = $(e.target).hasClass('collapsed') ? 'Expanded category' : 'Collapsed category';\n\tvar action = category === 'Collapsed category' ? 'show' : 'hide';\n\tpushEvent('Tariff Page Table',action,category);\n    togglePanelClasses(collapse, 'hide', 'show');\n    togglePanelClasses(noncollapse, 'show', 'hide');\n    togglePanelClasses(glyph, 'glyphicon-chevron-down', 'glyphicon-chevron-up');\n  });\n\n});\n\n/******************* new Booking summary page ***********************/\n$('.bookingDetails .panel-default').ready(function(){\n\t$('.bookingDetails .panel-heading').click(function(){\n\n\t\tvar $el = $(this).closest(\".panel-default\");\n\t\tif ($el.find('div').hasClass(\"collapse\")) {\n\t\t\t$el.find(\".panel-title .fa\").removeClass(\"fa-chevron-right\");\n\t\t\t$el.find(\".panel-title .fa\").addClass(\"fa-chevron-down\");\n\t\t}\n\t\telse {\n\t\t\t$el.find(\".panel-title .fa\").addClass(\"fa-chevron-right\");\n\t\t\t$el.find(\".panel-title .fa\").removeClass(\"fa-chevron-down\");\n\t\t}\n\t});\n});\n\nfunction arrowMovement(elem) {\n\tvar $el = $(elem);\n\t$('.fa').addClass(\"fa-chevron-right\");\n\t$('.fa').removeClass(\"fa-chevron-down\");\n\tif ($el.hasClass(\"collapsed\")) {\n\t\t$el.find(\".fa\").removeClass(\"fa-chevron-right\");\n\t\t$el.find(\".fa\").addClass(\"fa-chevron-down\");\n\t}\n\telse {\n\t\t$el.find(\".fa\").addClass(\"fa-chevron-right\");\n\t\t$el.find(\".fa\").removeClass(\"fa-chevron-down\");\n\t}\n}\n\n$(document).ready(function() {\n\n\tif (!isMobile()) {\n\t\t$('#statusOptions').mouseover(function(){\n\t\t\t$('#statusOptionsDropdown').addClass(\"show\").removeClass(\"hide\");\n\t\t});\n\n\t\t$('#statusOptionsDropdown').mouseleave(function(){\n\t\t\t$('#statusOptionsDropdown').addClass(\"hide\").removeClass(\"show\");\n\t\t\t$('#statusOptions').addClass(\"show\").removeClass(\"hide\");\n\t\t});\n\t}\n\telse {\n\t\tvar statusOpen = false;\n\t\t$('#statusOptions').on('click', function(e) {\n\t\t\t$('#statusOptionsDropdown').addClass(\"show\").removeClass(\"hide\");\n\t\t\tstatusOpen = true;\n\t\t\te.stopPropagation();\n\t\t});\n\t\t$('body').on('click', function(e) {\n\t\t\tif (($(e.target) != $('#statusOptionsDropdown')) && statusOpen) {\n\t\t\t\t$('#statusOptionsDropdown').addClass(\"hide\").removeClass(\"show\");\n\t\t\t\t$('#statusOptions').addClass(\"show\").removeClass(\"hide\");\n\t\t\t\tstatusOpen = false;\n\t\t\t}\n\t\t});\n\t}\n\n\t$('.status > a').click(function(){\n\t\t$('#statusOptionsDropdown').removeClass(\"show\");\n\t\t$('#statusOptionsDropdown').addClass(\"hide\");\n\t});\n\n  // Slide the Z-logo with interaction in all pages\n  var cityRE = new RegExp(city_name.replace(/\\s.*/g,'')+'$', 'ig');\n  if((window.location.pathname.split('/').length >=2 && window.location.pathname.match(cityRE) instanceof Array ) || window.location.pathname == \"/\"){\n    slideup();\n  } else {\n    slideup();\n  }\n  $('#stateSelect').change(function(){\n    $('.state_content_body').hide();\n    $('#' + $(this).val()).fadeIn();\n  });\n  $('#cargroupSelect').change(function(){\n    var cgrp = $('#cargroupSelect').val()\n      , charges = {cargroupSelected: cgrp}\n      , data_obj = {};\n    data_obj.charges = charges;\n    var self = this;\n     $.ajax({\n        type: \"POST\",\n        url: \"/damage_charges\",\n        data: data_obj,\n        dataType: \"JSON\"\n      })\n      .done(function (response){\n      \t$('.damage_charges').html(response.html);\n      });\n\n    return;\n  });\n});\n\n\n// Slide the trans-header after 100px browser window\nfunction slideup(){\n  $(window).scroll(function() {\n    var scroll = $(window).scrollTop();\n    // hides the datetimepicker when scroll is greater than zero\n    if (scroll > 0) {\n    \t$('.datetimepicker').hide();\n    }\n    if ((scroll >= 100) || (scroll >= 1900)) {\n\n\t\t\tif (window.location.pathname !== '/howitworks')\n      \t$('#slideupHeader').addClass(\"slidetop_head\");\n      \t$('.modifySearch').css(\"margin-top\",\"0\"); // for chauffeur wideget\n\t\t\t// If its how it works but intro is disabled\n\t\t\tif (window.location.pathname === '/howitworks' && window.hiw_intro_effect_disabled) {\n\t\t\t\t$('#slideupHeader').addClass(\"slidetop_head\");\n\t\t\t}\n\n\t\t\tif (window.location.pathname === '/howitworks' && !window.hiw_intro_effect_disabled) {\n\t\t\t\tif (scroll >= 2000) { // 1900 + 100 (original margin for collapsing)\n\t\t\t\t\t$('#slideupHeader').addClass(\"slidetop_head\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$(\"#slideupHeader\").removeClass(\"slidetop_head\");\n\t\t\t\t}\n\t\t\t}\n    }\n\t\telse{\n      $(\"#slideupHeader\").removeClass(\"slidetop_head\");\n      $('.modifySearch').css(\"margin-top\",\"-4px\"); // for chauffeur wideget\n    }\n  });\n}\n\n\nfunction whiteheader(){\n\t$(document).ready(function() {\n\t\t$(window).scroll(function() {\n\t\t\tscrollFunctionHomepage();\n\t\t});\n\t\t$(window).scroll(function() {\n\t\t\tvar scroll = $(window).scrollTop();\n\t\t\tif (scroll >= 80) {\n\t\t\t\t// for homedelivery search box\n\t\t\t\t$(\"#search_div\").addClass(\"animateSearch\");\n\t\t\t\t$(\".datetimepicker\").hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// for homedelivery search box\n\t\t\t\t$(\"#search_div\").removeClass(\"animateSearch\");\n\t\t\t}\n\t\t});\n\t});\n}\n\nfunction scrollFunctionHomepage() {\n\t//var hash = window.location.pathname.split('/');\n\t//hash = '#' + hash[hash.length - 1];\n\t// var hash = window.location.hash;\n\tvar cookieObject = new CookieModule();\n\tvar hash = cookieObject.getCookie('verticals_active_tab');\n\tif (hash.indexOf('zoom') === -1) {\n\t\thash = \"#zoom\";\n\t}\n\t$(\"#header-new\").removeClass(\"transHead\");\n\t// get the amount the window has scrolled\n\tvar scroll = $(window).scrollTop();\n\tif (scroll >= 80) {\n\t\t$(\"#header-new\").addClass(\"whiteHead\");\n\t\t$(\"#header-new\").removeClass(\"transHead\");\n\t\t//$(\"#search_box\").addClass(\"animateSearch\");\n\t\t$(\"#logoColor\").show();\n\t\t$(\"#logoWhite\").hide();\n\n\t\t$('.scrollUpNav').css('display', 'inline');\n\t\t$(hash).removeClass('active').removeClass('in');  // to keep the fixed header\n\t\t$('.verticals_search:eq(0)').addClass('active').addClass('in'); // add the 'active' class to the correct id based on the scroll amount\n\t\t// remove the tariff & new to zoomcar nav //\n\t\t$('#homeNav').removeClass('p-t15');\n\t\t$('#homeNav').addClass('p-t5');\n\t} else {\n\t\t$(\"#header-new\").removeClass(\"whiteHead\");\n\t\t$(\"#header-new\").addClass(\"transHead\");\n\t\t//$(\"#search_box\").removeClass(\"animateSearch\");\n\t\t$(\"#logoColor\").hide();\n\t\t$(\"#logoWhite\").show();\n\t\t$('.scrollUpNav').css('display', 'none');\n\t\t$('.verticals_search:eq(0)').removeClass('active').removeClass('in'); // to keep the fixed header\n\t\t$(hash).addClass('active').addClass('in');\n\t\t// show the tariff & new to zoomcar nav //\n\t\t$('#homeNav').addClass('p-t15');\n\t\t$('#homeNav').removeClass('p-t5');\n\t}\n}\n\n/*==================================================*/\n/*=============== HOME DELIVERY PAGE ===============\n/*==================================================*/\n\nfunction renderAddresses(index) {\n\t$('#hd_address_boxes').html(\"\");\n\t$.ajax({\n\t\ttype:\"GET\",\n\t\turl: \"/user_addresses\",\n\t\tdataType: \"json\",\n\t})\n\t.done(function(json){\n\t\tif(json.status === \"0\"){\n\t\t\t$('#hdaddressUpdate').addClass('hide');\n\t\t\t$('#hdNewAddress').removeClass('hide');\n\t\t\t$('#checkoutButton')[0].dataset.status = \"0\";\n\t\t\t$('#checkoutButton')[0].dataset.cd = \"0\";\n\t\t}\n\t\telse{\n\t\t\tif (json.all_addresses.length == 4) {\n\t\t\t\t$('#addNewAddress').hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#addNewAddress').show();\n\t\t\t}\n\t\t\t$('#hdNewAddress').addClass('hide');\n\t\t\t$(\"#hdaddressUpdate\").removeClass('hide');\n\t\t\t$('#checkoutButton')[0].dataset.status = \"1\";\n\t\t\tvar hd_address_list = json.all_addresses;\n\t\t\tfor(var i=0; i< hd_address_list.length; i++){\n\t\t\t\tvar hd_address_html = $($('#hd_address').html());\n\n\t\t\t\tif(hd_address_list[i].id == index || (index == 'last' && i == hd_address_list.length - 1)){\n\t\t\t\t\thd_address_html.addClass('active_hd_add');\n\t\t\t\t\thd_address_html.find('.active_hd_tick').removeClass('hide');\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\thd_address_html.addClass('hd_opacity');\n\t\t\t\t}\n\n\t\t\t\thd_address_html.attr(\"data-id\", hd_address_list[i].id);\n\t\t\t\thd_address_html.find('.hd_address').text(hd_address_list[i].address);\n\t\t\t\thd_address_html.find('.hd_city').text(hd_address_list[i].city);\n\t\t\t\thd_address_html.find('.hd_locality').text(hd_address_list[i].locality);\n\t\t\t\thd_address_html.find('.hd_zipcode').text(hd_address_list[i].zipcode);\n\t\t\t\thd_address_html.find('.hd_landmark').text(hd_address_list[i].landmark);\n\t\t\t\thd_address_html.find('.hd_edit').attr(\"data-id\", hd_address_list[i].id);\n\t\t\t\thd_address_html.find('.hd_delete').attr(\"data-id\", hd_address_list[i].id);\n\t\t\t\t$('#hd_address_boxes').append(hd_address_html);\n\n\t\t\t}\n\t\t\t\t// $(document).on('click', '.hd_edit', function(){\n\t\t\t\t// \tvar _this = $(this);\n\t\t\t\t// \tvar address_container = _this.parents('.hd_addressBox');\n\t\t\t\t// \tvar x = json.all_addresses.filter(function(v,i,a){\n\t\t\t\t// \t\t\t\t\t\treturn v.id === parseInt(_this.attr(\"data-id\"));\n\t\t\t\t// \t\t\t\t\t})[0];\n\t\t\t\t// \t$('#hd_edit_address').on('shown.bs.modal', function () {\n\t\t\t\t// \t\tvar temp = _this.attr(\"data-id\");\n\t\t\t\t// \t\t$('#hd_edit_address .hd_modal_street').val(address_container.find('.hd_address').text());\n\t\t\t\t// \t\t$('#hd_edit_address .hd_modal_area').val(address_container.find('.hd_locality').text());\n\t\t\t\t// \t\t$('#hd_edit_address .hd_modal_landmark').val(address_container.find('.hd_landmark').text());\n\t\t\t\t// \t\t$('#hd_edit_address .hd_modal_zipcode').val(address_container.find('.hd_zipcode').text());\n\t\t\t\t// \t\t$('#hd_edit_address #editSaveAddress').attr('data-id', temp);\n\t\t\t\t//\n\t\t\t\t// \t});\n\t\t\t\t// });\n\t\t\t\t// $(document).on('click','.hd_addressBox', function(){\n\t\t\t\t// \t$(this).siblings('.hd_addressBox').removeClass(\"active_hd_add\").addClass('hd_opacity');\n\t\t\t\t// \t$(this).siblings('.hd_addressBox').find('.active_hd_tick').addClass('hide');\n\t\t\t\t// \t$(this).removeClass('hd_opacity');\n\t\t\t\t// \t$(this).find('.active_hd_tick').removeClass('hide');\n\t\t\t\t// \t$(this).addClass(\"active_hd_add\");\n\t\t\t\t// });\n\t\t}\n\t});\n}\n\n// function to handle maxlength for input type number\nvar maxlength_for_input = function($el) {\n\tvar maxlength = parseInt($el.attr('maxlength'));\n\tvar input_value = $el.val();\n\tif(input_value.length > maxlength) {\n\t\tinput_value = input_value.slice(0, maxlength);\n\t\t$el.val(input_value);\n\t}\n}\n\n$('.hd_modal_zipcode').on('keyup', function(e){\n\tvar sanitized = $(this).val().replace(/[^0-9]/g, '');\n  $(this).val(sanitized);\n\tmaxlength_for_input($(this));\n})\n///////////////////////////////////////// API driven code end /////////////////////////////////\n\n\t$(function() {\n\t\t$('.hd_addressBox').each(function(index){\n\t\t\tif(index === 0){\n\t\t\t\t$(this).addClass('active_hd_add');\n\t\t\t\t$(this).find('.active_hd_tick').removeClass('hide');\n\t\t\t\t$(this).data('active', '1');\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(this).addClass('hd_opacity');\n\t\t\t\t$(this).data('active', '0');\n\t\t\t}\n\t\t});\n\n\t\t$(document).on('click', '.hd_edit', function(e){\n\t\t\te.preventDefault();\n\t\t\tvar _this = $(this);\n\t\t\tvar address_container = _this.parents('.hd_addressBox');\n\t\t\tif ($(address_container).hasClass('hd_opacity')) {\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#hd_edit_address').modal('show');\n\t\t\t}\n\t\t\tvar temp = _this.attr(\"data-id\");\n\t\t\t$('#hd_edit_address #editAddress').val(address_container.find('.hd_address').text().trim());\n\t\t\t$('#hd_edit_address #editArea').val(address_container.find('.hd_locality').text().trim());\n\t\t\t$('#hd_edit_address #editArea').data('locality', address_container.find('.hd_locality').text().trim());\n\t\t\t$('#hd_edit_address #editLandmark').val(address_container.find('.hd_landmark').text().trim());\n\t\t\t$('#hd_edit_address #editZipcode').val(address_container.find('.hd_zipcode').text().trim());\n\t\t\t$('#hd_edit_address #editZipcode').data('zipcode', address_container.find('.hd_zipcode').text().trim());\n\t\t\tif (address_container.data('addtype') === 0 || address_container.data('addtype') === 1) {\n\t\t\t\tvar addType = (address_container.data('addtype') === 0 ? 'Home' : 'Office');\n\t\t\t\t$('#hd_edit_address #editAddressType').text('Tagged as ' + addType + ' Address').data('addtype', address_container.data('addtype'));\n\t\t\t}\n\t\t\t$('#hd_edit_address #editSaveAddress').attr('data-id', temp);\n\t\t});\n\n\t\t$(document).on('click', '.hd_delete', function(e){\n\t\t\te.preventDefault();\n\t\t\tvar _this = $(this);\n\t\t\tvar address_container = _this.parents('.hd_addressBox');\n\t\t\tif ($(address_container).hasClass('hd_opacity')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar temp = _this.attr(\"data-id\");\n\t\t\tif (confirm('Are you sure you want to delete this address?')) {\n\t\t\t\t$.ajax({\n\t\t\t\t\t\ttype:\"POST\",\n\t\t\t\t\t\turl: \"/user_addresses/delete\",\n\t\t\t\t\t\tdataType: \"json\",\n\t\t\t\t\t\tdata: {address_id: temp}\n\t\t\t\t\t})\n\t\t\t\t.done(function(json){\n\t\t\t\t\tif(json.status === \"1\"){\n\t\t\t\t\t\trenderAddresses('last');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\n\t\t\t}\n\t\t});\n\n\t\t$(document).on('click','.hd_addressBox', function(e){\n\t\t\tvar editBtn = $(this).find('.hd_edit').data('id');\n\t\t\tvar deleteBtn = $(this).find('.hd_delete').data('id');\n\t\t\tif ($(e.target).data('id') == editBtn || $(e.target).data('id') == deleteBtn) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$('.hd_addressBox').removeClass(\"active_hd_add\").addClass('hd_opacity');\n\t\t\t$('.hd_addressBox').data('active', '0');\n\t\t\t$('.hd_addressBox').find('.active_hd_tick').addClass('hide');\n\t\t\t$(this).removeClass('hd_opacity');\n\t\t\t$(this).find('.active_hd_tick').removeClass('hide');\n\t\t\t$(this).addClass(\"active_hd_add\");\n\t\t\t$(this).data('active', '1');\n\t\t});\n\t});\n// $('#homeDelivery').on('click', function(){\n// \tif($(this).is(\":checked\"))\n// \t{\n// \t\tpushEvent('Home Delivery','Home Delivery','Y');\n// \t\tenableHD();\n// \t}\n// \telse{\n// \t\t$(\"#hdNewAddress, #hdaddressUpdate\").hide();\n// \t\t$('#checkoutButton')[0].dataset.status = \"noHD\";\n// \t}\n// });\n\n/*************************** Intent to Leave *****************************/\n\nvar intentCounter = 0;\nfunction intentToLeave(){\n  $(document).mouseleave(function(){\n    if(intentCounter === 0){\n      $('#intent_to_leave').modal('show');\n      $('.modal-backdrop').css('opacity','0.8');\n      intentCounter = 1;\n    }\n  });\n  $(document).mouseenter(function(){\n  \t$('#intent_to_leave').modal('hide');\n  });\n}\n\nintentToLeave();\n\n\n/**************************** Codriver Signup Redirect **********************/\n\n\n//checks whether the user is landed on homepage via codriver signup link or Not\n\nfunction checkCodriverHash(signed_in) {\n\tif (window.location.hash == '#codriverSignup' && signed_in === \"false\") {\n\t\tdoLogin();\n\t}\n}\n\n\n/******************************************************************************/\n/*==================================================*/\n/*=============== FLEXI TARIFF PAGE ======== =======\n/*==================================================*/\n\n$(function() {\n\t$('#flexiTabs li').on('click', function(){\n\n\t\tif($(this).data('freekms') === 5){\n\t\t\tpushEvent(\"Tariff Page\", \"Flexi Tariff\", \"Lite\");\n\t\t}\n\t\telse if($(this).data('freekms') === 10){\n\t\t\tpushEvent(\"Tariff Page\", \"Flexi Tariff\", \"Normal\");\n\t\t}\n\t\telse if($(this).data('freekms') === 15){\n\t\t\tpushEvent(\"Tariff Page\", \"Flexi Tariff\", \"Xtra\");\n\t\t}\n\t});\n});\n\n/*==================================================*/\n/*=============== MY BOOKINGS PAGE ==================\n/*==================================================*/\n\nfunction mybookings(page, apiKey=\"\"){\n\tlet params = {\n\t\tpage_no: page\n\t},\n\t\theader = {};\n\tif(apiKey) header['partner-api-key'] = apiKey\n\n\t$.ajax({\n\t\ttype:\"GET\",\n\t\turl: \"/bookings/bookings_list\",\n\t\tdataType: \"json\",\n\t\tdata : params,\n\t\theaders : header\n\t})\n\t.done(function(response) {\n\n\t\t// check if api request is a success\n\t\tif(response && response.status === \"1\"){\n\t\t\tbookings_resp = response;\n\t\t\t// get all the keys for the response object\n\t\t\tvar resp_keys = Object.keys(response);\n\n\t\t\t// loop over all the elements in the response object\n\t\t\tfor(var i = 0, resp_keys_len = resp_keys.length; i < resp_keys_len; i++){\n\t\t\t\tvar current_key = resp_keys[i]\n\n\t\t\t\t// skip the \"status\" field\n\t\t\t\tif(current_key !== \"status\"){\n\t\t\t\t\tif(current_key === \"completed\" && response[\"completed\"].length < 10){\n\t\t\t\t\t\t$('#viewMoreBookings').hide();\n\t\t\t\t\t}\n\n\t\t\t\t\t// fetch the array of objects for the current field - live, completed, cancelled etc...\n\t\t\t\t\tvar current_array = response[current_key];\n\t\t\t\t\tvar current_array_len = current_array.length;\n\t\t\t\t\tif(current_array_len !== 0){\n\t\t\t\t\t\tfor(var j = 0; j < current_array_len; j++){\n\t\t\t\t\t\t\t// get the html of the booking card's template\n\t\t\t\t\t\t\tvar bookingsTemplate = $($('#bookingsTemplate').html());\n\n\t\t\t\t\t\t\tif (current_array[j].booking_type == \"ONE_WAY\") {\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_start_drop').css(\"display\",\"none\");\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_loc_text').css(\"display\",\"none\");\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_start_drop_one_way').css(\"display\",\"block\");\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.start_location_one_way').text(current_array[j].source_location);\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.start_city_one_way').text(current_array[j].source_city);\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.destination_city_one_way').text(current_array[j].destination_city);\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.destination_loc_one_way').text(current_array[j].destination_location);\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.destination_date_txt').text(current_array[j].ends_date);\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.destination_time_txt').text(current_array[j].ends_time);\n\n\t\t\t\t\t\t\t\tvar day = ((current_array[j].days > 0) ? current_array[j].days +' day ' : \"\"),\n\t\t\t\t\t\t\t\t\thours = ((current_array[j].hours > 0) ? current_array[j].hours +' hr ' : \"\"),\n\t\t\t\t\t\t\t\t\tmin = ((current_array[j].minutes > 0)? current_array[j].minutes +' min ': \"\"),\n\t\t\t\t\t\t\t\t\toneWayTimeInfo = day + hours + min;\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_one_way_info').text(oneWayTimeInfo);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_start_drop').css(\"display\",\"block\");\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_start_drop_one_way').css(\"display\",\"none\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_car_img').css('background', 'url('+ current_array[j].small_image_url +')');\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_id_text a').text(current_array[j].booking_id);\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_id_text a').attr('href', \"/bookings/\" + current_array[j].booking_id);\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_id_car').text(current_array[j].car);\n\t\t\t\t\t\t\tbookingsTemplate.find('.start_time_txt').text(current_array[j].starts_time);\n\t\t\t\t\t\t\tbookingsTemplate.find('.start_date_txt').text(current_array[j].starts_date);\n\t\t\t\t\t\t\tbookingsTemplate.find('.end_time_txt').text(current_array[j].ends_time);\n\t\t\t\t\t\t\tbookingsTemplate.find('.end_date_txt').text(current_array[j].ends_date);\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_loc_text').text(current_array[j].location);\n\n\t\t\t\t\t\t\tbookingsTemplate.find('.booking_manage a').attr('href', \"/bookings/\" + current_array[j].booking_id);\n\n\t\t\t\t\t\t\tif(parseInt(current_array[j].balance) <= 0){\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_pay_now, .booking_amt_text').addClass('hide');\n\t\t\t\t\t\t\t\t// bookingsTemplate.find('.booking_amt_text').addClass('hide');\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_status_text').text(current_array[j].status.substring(0,\n\t\t\t\t\t\t\t\t\tcurrent_array[j].status.lastIndexOf(\"<br/>\")).split(\"<br/>\").join(' | ').replace(/<(?:.|\\n)*?>/gm, ''));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tbookingsTemplate.find('.booking_amt_text').text(\"Outstanding  \" + current_array[j].balance);\n                bookingsTemplate.find('.booking_pay_now, .booking_amt_text').removeClass('hide');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbookingsTemplate.find('.mybookings-form').attr('action', \"/bookings/\"+current_array[j].confirmation_key.toLowerCase()+\"/dodeposit\");\n\n\t\t\t\t\t\t\t$(\"#\" + current_key + \"Bookings\").append(bookingsTemplate.html());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif((current_key === \"live\" || current_key === \"future\") && page === 0){\n\t\t\t\t\t\t\tif(response[\"live\"].length === 0 && response[\"future\"].length === 0 ){\n\t\t\t\t\t\t\t\t$(\"#live_upcomingBookings .noBookings\").text(\"You do not have any live and upcoming bookings. Keep on Zooming! :)\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif (page === 0) {\n\t\t\t\t\t\t\t\t$(\"#\" + current_key + \"Bookings .noBookings\").text(\"You do not have any \" + current_key + \" bookings. Keep on Zooming! :)\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n  })\n  .fail(function() {\n  })\n}\n\n/*==================================================*/\n/*=============== USER PROFILE SIDEBAR ==============\n/*==================================================*/\n\n// Only on my accounts\nfunction profile_sidebar(){\n\t$(\".ajax_spinner\").show();\n\t$.ajax({\n\t\ttype:\"GET\",\n\t\turl: \"/users/user_info\",\n\t\tdataType: \"json\",\n\t})\n\t.done(function(response) {\n\t\t//console.log(response);\n\n\t\t// check if api request is a success\n\t\tif(response && response.status === \"1\"){\n\t\t\t$(\"#pro_name\").text(response.name || '');\n\t\t\t$(\"#pro_mobile\").text(response.number || '');\n\t\t\t$(\"#pro_email\").text(response.email || '');\n\t\t\t$('#walletEmail').text(response.citrus_wallet_email || '');\n\n\t\t\t// license verification check\n\t\t\tvar license_status = response.license_status;\n\t\t\tif(license_status === true){\n\t\t\t\t$(\"#licenceStatus\").css('color', '#78b643');\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(\"#licenceStatus\").addClass('fa fa-times-circle-o');\n\t\t\t\t$(\"#licenceStatus\").removeClass('fa-check-circle-o');\n\t\t\t\t$(\"#licenceStatus\").css('color', '#BE3232');\n\t\t\t}\n\n\t\t\t// mobile verification check\n\t\t\tvar mobile_verify = response.mobile_verified\n\t\t\tif(mobile_verify === 1){\n\t\t\t\t$(\"#numberStatus\").css('color', '#78b643');\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(\"#numberStatus\").addClass('fa fa-times-circle-o');\n\t\t\t\t$(\"#numberStatus\").removeClass('fa-check-circle-o');\n\t\t\t\t$(\"#numberStatus\").css('color', '#BE3232');\n\t\t\t}\n\n\n\t\t\t// wallet status check\n\t\t\tvar wallet_verify = response.citrus_wallet_status;\n\t\t\tif(wallet_verify === true ){\n\t\t\t\t$(\"#walletStatus\").css('color', '#78b643');\n\t\t\t\t$(\"#wallet_linked_Details\").show();\n\t\t\t\t$(\"#walletAmount\").text(\" \" + response.citrus_wallet);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$(\"#walletStatus\").addClass('fa fa-times-circle-o');\n\t\t\t\t$(\"#walletStatus\").removeClass('fa-check-circle-o');\n\t\t\t\t$(\"#walletStatus\").css('color', '#BE3232');\n\t\t\t\t$('#wallet_notlinked_Details').show();\n\t\t\t}\n\n\t\t\t// credits status check\n\t\t\t$('#creditAmount').text(\" \" + response.zoomcar_credits);\n\t\t\tif(!response.is_supermiler){\n\t\t\t\t$('#user_zpoints_line').hide();\n\t\t\t\t$('#user_zpoints').hide();\n\t\t\t}\n\t\t\t$('.zpoint_sec .available_z_points span').text(response.zpoints +' Z-Points');\n\n\t\t\t$(\".ajax_spinner\").hide();\n\t\t}\n  })\n  .fail(function() {\n  })\n}\n\nfunction myAccounts(){\n\t$.ajax({\n\t\ttype: \"GET\",\n\t\turl: \"/users/details\",\n\t\tdataType: \"json\"\n\t})\n\t.done(function(response){\n\t\tif(response && response.status === \"1\"){\n\t\t\taccounts_resp = response;\n  \t\t// convert date format\n\t\t\tvar date = '';\n\t\t\tif (response.dob != null) {\n\t  \t\tdate = new Date(response.dob);\n\t  \t\tdate = (date.getDate() < 10 ? '0' + date.getDate() : date.getDate()) + '/' + ((date.getMonth() + 1) < 10 ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1)) + '/' + date.getFullYear();\n\t\t\t}\n  \t\t// Fill the input fields in the form with this response\n\n  \t\t$('#cUserEmail').text(response.email);\n  \t\t$('#cUserMobile').val(response.phone);\n  \t\t$('#cUserName').val(response.name);\n  \t\t$('#cUserNameInText').text(response.name);\n  \t\t$('#cUserDob').val(date);\n\t\t\t// response sends Male and Female, whereas Update request expects false and true respectively. So value is set to false and true\n  \t\tif(response.gender === \"Male\"){\n\t\t\t\t$('#cUserGender').val(0);\n  \t\t}\n  \t\telse if(response.gender === \"Female\"){\n  \t\t\t$('#cUserGender').val(1);\n  \t\t}\n\n  \t\t$('#cUserCountry').val(response.country);\n\n  \t\tif(response.country !== \"IN\"){\n\t\t\t\t$('.bind-to-country').hide();\n  \t\t}\n\n  \t\t$('#cUserState').val(response.state);\n  \t\t$('#cUserCity').val(response.city);\n  \t\t$('#cUserPincode').val(response.pincode);\n  \t}\n\t});\n}\n\n$('#accounts-form').on('submit', function () {\n\tevent.preventDefault();\n\n\tvar phone = $('#cUserMobile').val()\n\t\t, name = $('#cUserName').val()\n\t\t, dob = $('#cUserDob').val()\n\t\t, gender = $('#cUserGender').val()\n\t\t, city = $('#cUserCity').val()\n\t\t, auth_token = getCookie('authToken');\n\n\tvar dataObj = {\n\t\tauth_token: auth_token\n\t};\n\n\tif (accounts_resp.dob != null) {\n\t\tdate = new Date(accounts_resp.dob);\n\t\taccounts_resp.dob = (date.getDate() < 10 ? '0' + date.getDate() : date.getDate()) + '/' + ((date.getMonth() + 1) < 10 ? '0' + (date.getMonth() + 1) : (date.getMonth() + 1)) + '/' + date.getFullYear();\n\t}\n\tif(accounts_resp.gender === \"Male\"){\n\t\taccounts_resp.gender = 0;\n\t}\n\telse if(accounts_resp.gender === \"Female\"){\n\t\taccounts_resp.gender = 1;\n\t}\n\n\tif (accounts_resp.phone !== phone) {\n\t\tdataObj.phone = phone;\n\t}\n\tif (accounts_resp.name !== name) {\n\t\tdataObj.name = name;\n\t}\n\tif (accounts_resp.dob !== dob) {\n\t\tdataObj.dob = dob;\n\t}\n\tif (accounts_resp.gender !== gender) {\n\t\tdataObj.gender = gender;\n\t}\n\tif (accounts_resp.city !== city) {\n\t\tdataObj.city = city;\n\t}\n\n\t$.ajax({\n\t\ttype: \"POST\",\n\t\turl: \"/users/update\",\n\t\tdata: dataObj\n\t})\n\t.done(function (response) {\n\t\tif (dataObj.phone) {\n\t\t\t$('#unverifiedNumber').text(dataObj.phone);\n\t\t\t$('#newModalBodyRight').html($('#otpModalContent').html());\n\t\t\t$('#newModal').modal('show');\n\t\t}\n\t\telse {\n\t\t\twindow.location.reload();\n\t\t}\n\t})\n});\n\n/*==================================================*/\n/*=============== Mobile Top Banner===============\n/*==================================================*/\n$(function() {\n\n\t$('#mobile-site-header-close').on('click', function(){\n\t\t$('#mobile-site-header-container').addClass('hide');\n\t});\n\t////////////////// function to call tooltip ////////////////\n  $('[data-toggle=\"tooltip\"]').tooltip();\n\n});\n\n/*===============Called when city selected  from drop down menu===============*/\nfunction changeCity(changed_city, cityArr, hd_enabled) {\n\n\t$('.mobile_drawer_container #currentCity').text(changed_city);\n\tvar path = window.location.pathname;\n\tvar newURL = window.location.protocol + \"//\" + window.location.host;\n  var search = window.location.search;\n\tpath = path.split('/');\n\tif (parseInt(hd_enabled) === 1 && path.indexOf('search') !== -1) {\n\t\twindow.location.href = '/' + changed_city;\n\t\treturn;\n\t}\n\tif ((path.indexOf('payment_options') !== -1) || (path.indexOf('checkout') !== -1)) {\n\t\twindow.location.href = '/' + changed_city;\n\t\treturn;\n\t}\n\n  var toHome = false;\n\n  // if new search\n  if (search.indexOf('new_search') !== -1) {\n    var paramHash = getRequestParams(search);\n    if (paramHash['hd'] == \"0\") {\n\n      // remove the lat, lng from url when changed to new city\n      paramHash['formattedAddress'] = '';\n      paramHash['lat'] = '';\n      paramHash['lng'] = '';\n      paramHash['mapAddHash'] = '';\n      search = '?';\n      for (param in paramHash) {\n        if (paramHash[param] !== '') {\n          search += (param + '=' + encodeURIComponent(paramHash[param]) + '&');\n        }\n      }\n      search = search.slice(0, -1);\n    } else {\n      search = '';\n      toHome = true;\n    }\n  }\n\n\tif (cityArr.indexOf(path[1]) !== -1 ) {\n\t\tpath[1] = changed_city;\n    if (toHome) path[2] = ''; // if doorstep then redirect to homepage, remove the search param from url\n\t\tpath = path.join('/');\n\t\tnewURL += (path + search);\n\t}\n\telse {\n\t\tnewURL += (window.location.pathname + search);\n\t}\n\t$.ajax({\n\t\turl: '/change_current_city',\n\t\ttype: 'POST',\n\t\tdata : {city: changed_city}\n\t}).done(function(data) {\n\t\tif (data['success'] === \"1\")\n\t\t\twindow.location = '/';\n\t}).fail(function() {\n\t});\n}\n\n/*==================================================*/\n/*=============== Cookie related functions ===============\n/*==================================================*/\nvar CookieModule = function() {};\n\n// method to get cookie by name\nCookieModule.prototype.getCookie = function(name) {\n\tvar cookie = document.cookie;\n\tcookie = cookie.split(';');\n\tname = name + '=';\n\tfor (var i = 0; i<cookie.length; i++) {\n\t\tvar cookieString = cookie[i].trim();\n\t\tif (cookieString.indexOf(name) === 0) {\n\t\t\treturn cookieString.substring(name.length, cookieString.length);\n\t\t}\n\t}\n\treturn \"\";\n}\n\n// method to set the cookie with name and value\nCookieModule.prototype.setCookie = function(name, value) {\n\tvar expireDate = new Date();\n\texpireDate.setMonth(expireDate.getMonth() + 2);\n\texpireDate = \"expires=\" + expireDate.toUTCString();\n\tdocument.cookie = name + \"=\" + value + \"; \" + expireDate + \"; path=/\";\n}\n\n// function for setting cookie on pages other than homepage\nfunction verticalsIconClick(hash, category, action) {\n\tvar cookie = new CookieModule();\n\tcookie.setCookie('verticals_active_tab', hash);\n\tpushEvent(category, action);\n}\n\n/*=============================================================*/\n/*=============== Mobile Responsive Related Functions ==========\n/*=============================================================*/\n\nfunction isMobile() {\n\tif ('matchMedia' in window && window.matchMedia('(max-width:768px)').matches) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n// Mobile Menu Drawer Code\n// $('.slider_menu_icon').on('click', function() {\n// \t$('.mobile_drawer_container').addClass('slidein');\n// \t$('.mobile_drawer_overlay').show();\n// \t$('html, body').addClass('scrollDisabled');\n// });\n\n$('.mobile_drawer_overlay').on('click', function() {\n\t$('.mobile_drawer_container').removeClass('slidein');\n\t$('.mobile_drawer_overlay').hide();\n\t$('html, body').removeClass('scrollDisabled');\n});\n\n$('.menu_list .menu_item').on('click', function(e) {\n\tvar cityImagesBlock = $('.cityCell');\n\tfor(var index = 0; index < cityImagesBlock.length; index++){\n\t\tvar cityName = $(cityImagesBlock[index]).data('link_name');\n\t\t$(cityImagesBlock[index]).find('.cityImage').css('background','url(/images/newHome/'+cityName[0].toUpperCase() + cityName.slice(1)+'.png)');\n\t}\n\tif ($(this).data('openable') === true) {\n\t\tif ($(this).next('.sub_menu').hasClass('open')) {\n\t\t\t$(this).next('.sub_menu').removeClass('open').addClass('closed');\n\t\t\t$(this).find('.arrow').removeClass('fa-caret-down').addClass('fa-caret-right');\n\t\t}\n\t\telse {\n\t\t\t$('.menu_list .menu_item').each(function() {\n\t\t\t\t$(this).find('.arrow').removeClass('fa-caret-down').addClass('fa-caret-right');\n\t\t\t});\n\t\t\t$('.menu_list .sub_menu').removeClass('open').addClass('closed');\n\t\t\t$(this).next('.sub_menu').addClass('open');\n\t\t\t$(this).find('.arrow').removeClass('fa-caret-right').addClass('fa-caret-down');\n\t\t}\n\t}\n});\n\n// remove the login div from DOM\nif((window.location.pathname.indexOf(\"login\") !== -1) && isMobile()) {\n\t$('#mobile_login_container').remove();\n}\n// remove the web search steps from DOM\nif (isMobile()) {\n\t// $('.mobile_container_hide').remove();\n\n\t// Selectively remove tooltips\n\t$('#CheckoutForm').append('<input type=\"hidden\" name=\"booking_medium\" value=\"mobileweb\" />');\n\n}\n\n// Remove profiler\nsetTimeout(function () {\n\tif (true) $('.profiler-results').remove();\n}, 2000);\n\n\n// payment accordion for mobile responsive\nfunction displayAccordion(id, panel_id) {\n\t$('.tab-pane').removeClass('active in');\n\t$(panel_id).addClass('active in');\n\n\t// Arrow indicator\n\t$('.mobile_accordion .fa-chevron-down')\n\t\t.removeClass('fa-chevron-down')\n\t\t.addClass('fa-chevron-right');\n\n\t// Arrow indicator\n\t$('#' + id)\n\t\t.find('.fa-chevron-right')\n\t\t.removeClass('fa-chevron-right')\n\t\t.addClass('fa-chevron-down');\n\n\t$('body').scrollTop( $('#' + id).offset().top - 50 ); // 40 is fixed header height\n}\n\n// Remove profiler\nsetTimeout(function () {\n\tif (isMobile()) $('.profiler-results').remove();\n}, 2000);\n\nvar setAppInfo = function() {\n  var cookieModule = new CookieModule();\n  var app_type, app_link;\n  if (isiDevice()) {\n    app_type = \"iOS\";\n    app_link = \"https://itunes.apple.com/us/app/zoomcar-self-drive-cars/id889910218?mt=8&utm_source=home%20page&utm_medium=header%20links&utm_content=iOS&utm_campaign=installs\";\n  }\n  else if (isAndroid()) {\n    app_type = \"Android\";\n    app_link = \"https://play.google.com/store/apps/details?id=com.zoomcar&referrer=utm_source%3Dhome%2520page%26utm_medium%3Dheader%2520links%26utm_content%3Dandroid%26utm_campaign%3Dinstalls\";\n  }\n  if (isiDevice() || isAndroid()) {\n    if ($('.app_download_section').length > 0 && (cookieModule.getCookie('app_section_seen') === '')) {\n      $('.app_download_section .platform').text(app_type);\n      $('.app_download_section .install_button').attr('href', app_link);\n      $('.app_download_section').show();\n    }\n    $('li.download_app a').attr('href', app_link);\n    $('li.download_app').show();\n  }\n}\n\n$(function() {\n\n\tif ($('.carousel .lazy').length > 0) {\n\t\t// for lazylaoding images on carousel slide event\n\t\t$(\".carousel\").on('slid.bs.carousel', function () {\n\t\t\tlazyLoadOnScroll();\n\t\t});\n\t}\n\n\t$('body').on('submit', '#SearchHDForm', function() {\n\t\tif ($('body #hdEnable').val() === '1') {\n\t\t\tvar status = initializeHdDatePicker();\n\t\t\tif (status == \"false\") {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ($('body #lat').val() === '' || $('body #long').val() === '') {\n\t\t\t\t$('.errorBox').hide();\n\t\t\t\t$('body #locationHDError').show();\n\t\t\t\t$('body #hdlocation #Locations').addClass('dateError');\n\t\t\t\t$('body #locationHDError').html('Please choose a location before searching');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else if($('body #airportConfirm').val() == \"true\") {\n\t\t\tAirportSearchNew(this);\n\t\t\treturn true;\n\t\t}\n\t\t// GA event for doorstep service\n\t\tif($('.item_drpdown').hasClass(\"show\")) {\n\t\t\tpushEvent('DS Monitoring', 'Pick My Car Switch','Search Bar');\n\t\t}\n\t\telse {\n\t\t\tpushEvent('DS Monitoring', 'Doorstep Service Switch','Search Bar');\n\t\t}\n    if (!isMobile()) {\n      return SearchSubmitForm(this,'/' + cityLinkName + '/search','SearchHDFormDiv');\n    } else {\n      return SearchSubmitForm(this,'/' + cityLinkName + '/search/nav','SearchHDFormDiv');\n    }\n\t});\n\n\t$('.noHDCarContainer #sitepickupButton').on('click', function() {\n\t\tselectPickup();\n\t\t$('#SearchHDForm').submit();\n\t})\n});\n\nvar AirportSearch = function(el) {\n\tvar id = $(el).attr('id');\n\tvar selectedCity = $('#' + id).find('.dropdownBox').next('ul').find('li.active');\n\tif (selectedCity.length === 0) {\n\t\t$(el).find('#CityVal').val('');\n\t\t$(el).find('#LocationVal').val('');\n\t\t$(el).find('#airportConfirm').val('');\n\t\t$(el).find('.dropdown-handler').find('[data-toggle=dropdown]').dropdown('toggle');\n\t\treturn false;\n\t}\n\telse {\n    // $(el).find('#airportLat').val($(selectedCity).find('a').data('lat'));\n    // $(el).find('#airportLng').val($(selectedCity).find('a').data('lng'));\n\t\t$(el).find('#CityVal').val($(selectedCity).find('a').data('cityname'));\n\t\t$(el).find('#LocationVal').val($(selectedCity).find('a').data('locid'));\n\t\t$(el).find('#airportTerminalId').val($(selectedCity).find('a').data('terminalid'));\n\t\t$(el).find('#airportConfirm').val(true);\n\t}\n\n\t// if(new CookieModule().getCookie('_vis_opt_exp_82_split') == \"2\") {\n\t// \tvar city = selectedCity.find('a').data('cityname').toLowerCase();\n\t// \tsubmitURL = '/' + city +'/search';\n\t// \tdivID = $(el).attr('id');\n\t// }\n\t// else\n\tif($(el).data(\"widget\") == 1) {\n\t\tvar city = selectedCity.find('a').data('cityname').toLowerCase();\n\t\tsubmitURL = '/' + city +'/search/nav';\n\t\tdivID = $(el).attr('id');\n\t}\n\tif(typeof submitURL == \"undefined\") {\n\t\tsubmitURL = '/' + cityLinkName + '/search/homepage';\n\t}\n\n\tSearchSubmitForm(el, submitURL, divID, 'Airport');\n}\n\nvar AirportSearchNew = function(el, cityName) {\n\tvar id = $(el).attr('id');\n\tvar selectedCity = $('#' + id).find('.dropdownBox').next('ul').find('li.active');\n\tvar startDate = $('#'+id).html();\n\tif (selectedCity.length === 0) {\n\t\t$(el).find('#CityVal').val('');\n\t\t$(el).find('#LocationVal').val('');\n\t\t$(el).find('#airportConfirm').val('');\n\t\t// $(el).find('#StartAirportDateVal').val();\n\t\t$(el).find('.dropdown-handler').find('[data-toggle=dropdown]').dropdown('toggle');\n\t\treturn false;\n\t}\n\telse {\n    \t// $(el).find('#airportLat').val($(selectedCity).find('a').data('lat'));\n    \t// $(el).find('#airportLng').val($(selectedCity).find('a').data('lng'));\n\t\t$(el).find('#CityVal').val($(selectedCity).find('a').data('cityname'));\n\t\t$(el).find('#LocationVal').val($(selectedCity).find('a').data('locid'));\n\t\t// $(el).find('#StartAirportDateVal').val($(startDate).find('a').data('search_start_time'));\n\t\t$(el).find('#airportTerminalId').val($(selectedCity).find('a').data('terminalid'));\n\t\t$(el).find('#airportConfirm').val(true);\n\t}\n\n\n\n    var params = '';\n   var values = $(\"#ZoomAirportSearchForm\").serializeArray();\n\n   \tvar start = $('#StartAirportDateVal').val();\n\tvar end = $('#EndAirportDateVal').val();\n\n\t$('.errorBox').hide();\n\n\tif (start == ($('#StartAirportDateVal').attr('dummy-title')) ) {\n\t\t// open the start datetime picker //\n\t\t$('#StartAirportDateVal').datetimepicker('show');\n\n\t\t// red border for the datebox if its empty //\n\t\t$('#StartAirportDate').addClass('dateError');\n\t\t$('#StartAirportDateVal').addClass('dateError');\n\t}\n\telse if (end == ($('#EndAirportDateVal').attr('dummy-title'))) {\n\t\t// open the end datetime picker //\n\t\t$('#EndAirportDateVal').datetimepicker('show');\n\n\t\t// red border for the datebox if its empty //\n\t\t$('#EndAirportDate').addClass('dateError');\n\t\t$('#EndAirportDateVal').addClass('dateError');\n\t}\n\telse{\n\t\tfor (i in values){\n        if(values[i].name === 'starts' || values[i].name === 'ends'){\n           values[i].value = (values[i].value.split(' ')[0].split(\"/\").reverse().join(\"-\")) + ' ' + values[i].value.split(' ')[1]\n           }\n  // checking if i is not the index of last element then append & sign\n  if (i==values.length-1){\n    params+=values[i].name+'='+values[i].value;\n\n    }\n  //  if i is index of last element then dont add & sign.\n  else{\n    params+=values[i].name+'='+values[i].value+'&';\n    }\n\n   }\n  if (cityName) {\n   \twindow.location =\"/\" + cityName + \"/search/query?type=zoom_air&\" + params;\n  }\n  else {\n  \twindow.location =\"/\" + cityLinkName + \"/search/query?type=zoom_air&\" + params;\n\t}\n  }\n}\n\nfunction showChauffeurModifyWidget() {\n\tpushEvent(\"Chauffeur Search\", \"Modify Search\", \"\");\n\t$(\".displayChauffeurBookingDetails\").hide();\n\t$(\"#ChauffeurSearchForm\").show();\n}\n\nvar ClassicSearch = function(el) {\n\tif ($('#hdEnable').val() === \"1\") {\n\t\tif (($('#lat').val() === '') || ($('#long').val() === '')) {\n\t\t\t$('#hdLocationError').show();\n\t\t\t$('#hdCheckbox').prop('checked', false);\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\t$('#hdLocationError').hide();\n\t\t}\n\t}\n  if (!isMobile()) {\n    SearchSubmitForm(el,'/' + cityLinkName + '/search',divID);\n  } else {\n    SearchSubmitForm(el,'/' + cityLinkName + '/search/homepage',divID);\n  }\n}\n\n/*============================================================*/\n/*==================verticals related code ===================*/\n/*============================================================*/\n\n$(function() {\n\t$('.dropdown-handler').on('click', function(e) {\n\t  $('.errorBox').hide();\n\t  $(this).find('.dropdownBox').removeClass('dateError');\n\t});\n\n\t$('.verticals-dropdown-menu').on('click', 'li', function(e) {\n\t  if ($(this).hasClass('disabled')) {\n\t    return false;\n\t  }\n\t  var html = $(this).find('a').html();\n\t  $(this).parent().parent().find('.dropdownBox .dropdownText').html(html);\n\t  $(this).parent().find('li').removeClass('active');\n\t  $(this).addClass('active');\n\t  $('input[data-label=\"#' + $(this).parent().attr('id') + '\"]').val($(this).text().replace(/\\s\\s+/g, ' ').trim());\n\t});\n});\n\n// click function for airport terminal on homepage //\nvar locationVal = $('#LocationVal');\nvar airportTerminalId = $('#airportTerminalId');\n\n$('body').on('click', '.airport-terminal li', function(e) {\n\tvar $this = $(this);\n\tvar $a = $('a', $this);\n\n\tlocationVal.val($a.data('locid'));\n\tairportTerminalId.val($a.data('terminalid'));\n\n\tvar html = $('a', this).data('cityname') + \" - \" + $('a', this).data('terminalcode');\n\t$this.parents('.dropdown-handler').find('.dropdownBox .dropdownText').html(html);\n\t$this.parents('form').find('#airportConfirm').val(true);\n\t$this.parents('.airportDropdownMenu').toggleClass('hide');\n\t$('.airport-terminal li').removeClass('active');\n\t$this.addClass('active');\n});\n\n$('body').on('click', '#terminalLocation', function(e) {\n\tvar location_id = $(this).data(\"locid\");\n\tvar terminal_id = $(this).data(\"terminalid\");\n\t$(this).parents('.dropdown').find('#LocationHtml1').html($(this).html());\n\t$(this).parents('form').find('#LocationVal1').val(location_id);\n\t$(this).parents('form').find('#TerminalVal').val(terminal_id);\n});\n\n$('body').on('click', '#terminal_location', function(e) {\n\tvar location_id = $(this).data(\"locid\");\n\tvar terminal_id = $(this).data(\"terminalid\");\n\t$(this).parents('.dropdown').find('#terminal_location_html').html($(this).html());\n\t$(this).parents('form').find('#drop_terminal_name').val($(this).html().trim());\n});\n\n\n/* ========================= Airport OneWay =========================*/\n\nfunction changeairLocation1(id,name,action) {\n\tif(id != 17) {\n\t\tchangeairLocation2(17,\"Airport\",\"nav\");\n\t\t$(\"#dropoffloc ~ul\").addClass(\"hide\");\n\t\t$(\"#dropoffloc .caret\").addClass(\"hide\");\n\t}\n\telse if(id==17){\n\t\t$(\"#dropoffloc ~ul\").removeClass(\"hide\");\n\t\t$(\"#dropoffloc .caret\").removeClass(\"hide\");\n\t\t$('#LocationHtmlAir2').html(\"Select Dropoff location\");\n\t\t$('#LocationHtmlAir2').addClass(\"lgrey\");\n\t\t$('#dropofflocval').val(\"\");\n\t}\n  $('#LocationValAir1').val(id);\n  $('#LocationHtmlAir1').html(name);\n  $('#LocationHtmlAir1').removeClass(\"lgrey\");\n  $('#pickuplocval').val(id);\n}\nfunction changeairLocation2(id,name,action) {\n  $('#LocationValAir2').val(id);\n  $('#LocationHtmlAir2').html(name);\n  $('#LocationHtmlAir2').removeClass(\"lgrey\");\n  $('#dropofflocval').val(id);\n}\n\n/*============================================================*/\n/*=================== Chauffeur related code =================*/\n/*============================================================*/\n\n$(function() {\n\t// function to show fare details animation\n\t$('.fare-details').on('click', function(){\n\t\tvar $el = $(this);\n\t\t$el.closest(\".chauffeur_card\").find(\".details_card\").toggleClass(\"details_card_animate\");\n\t\t$el.closest(\".chauffeur_card\").find(\".details_card\").toggleClass(\"details_card_noanimate\");\n\t});\n\n\t// function to hide fare details animation\n\t$('.fare-details-close').on('click', function(){\n\t\tvar $el = $(this);\n\t\t$el.closest(\".chauffeur_card\").find(\".details_card\").toggleClass(\"details_card_animate\");\n\t\t$el.closest(\".chauffeur_card\").find(\".details_card\").toggleClass(\"details_card_noanimate\");\n\t});\n});\n\nvar ChauffeurSearch = function(el) {\n\tvar startDate = $(el).find('#StartChauffeurDateVal').val();\n  if(!isMobile()) {\n    var duration = $(el).find('#DurationChauffeurType').find('ul li.active');\n  } else {\n    var duration = $(el).find('#chauffeurSelect').find('option:selected');\n  }\n\n  if (startDate == $(el).find('#StartChauffeurDateVal').attr('dummy-title'))  {\n    $(el).find('#StartChauffeurDateVal').datetimepicker(\"show\");\n    return false;\n  }\n  else {\n    // we need 5 hrs prep time for MVP\n    // trying to use existing HD code\n    // would be benefitial later on\n    var status = initializeHdDatePicker(\"Chauffeur\");\n    if(status == \"false\") {\n      return false;\n    }\n\n    if(duration.length == 0 || duration.val() == \"null\") {\n      $(el).find('.errorBox').hide();\n      $(el).find('#ChauffeurDurationError')\n      .show()\n      .text(\"Please select the Package\");\n      return false;\n    }\n    else {\n      if(!isMobile()) {\n        var $elem = $('#DurationChauffeurType').find('ul li.active');\n        var plan = $elem.attr(\"data-duration\");\n        var hours = $elem.attr(\"data-hours\");\n        var kms = $elem.attr(\"data-kms\");\n        var cd_id = $elem.attr(\"data-cd-id\");\n        $('#chauffeurPlan').val(plan);\n        $('#chauffeurHours').val(hours);\n        $('#chauffeurKms').val(kms);\n        $('#chauffeurId').val(cd_id);\n        $(\"a[data-toggle='tab']\").addClass('disabled');\n        pushEvent(\"Chauffeur Monitoring\", \"Homepage\", \"Chauffeur Search\");\n      }\n      $(el).find('.errorBox').hide();\n      $(el).find('span#ZoomChauffeurbook-now').hide();\n      $(el).find('span#ZoomChauffeurspinner').show();\n      return true;\n    }\n  }\n}\n\n// select Pick up from the dropdown of the search bar //\nfunction selectPickup() {\n\n\t$('#noHDLocation, #noHDLocationText, #noHDLocationMap').removeClass('hide').addClass('show');\n\t$('#CityDropdown').removeClass('show').addClass('hide');\n\t$('#hdEnable').val('0');\n\t$('.errorBox').hide();\n\t$('.datetimebox').removeClass('dateError');\n\t$('.datetimebox .datetime').removeClass('dateError');\n\n\t$('#hdModalLabel').text('Pickup Location');\n\t$('#hdModalTextbox').text('Please enter your pickup location in the text box');\n\t$('#hdModalLocationText').text(\"If you want to pickup at your current location, please enable your browser's location settings\");\n\n\t$('#noHDLocationMap #Locations').text(\"Choose your location\");\n\n\t$('#map_search_input').text('Enter Pickup Location');\n\n\t//disable lat-lng if neither HD nor any of the map based variants are selected\n\tif (isMobile()){\n\t\t$('#lat, #long').attr('disabled', true);\n\t\t$('#lat, #long').attr('readonly', false);\n\t}\n\n\t$('#airportConfirm').val('');\n\n}\n\n\n// airport related code\n$('body').on('click', '#AirportCityDropdown', function(){\n\t$(this).parent('.box_hd').find('.airportDropdownMenu').toggleClass('hide');\n\t$('.airport-terminal').addClass('hide');\n});\n$('body').on('click', '.airportDropdownMenu .airportDropdownSubMenu>a', function(){\n\t$('.airport-terminal').addClass('hide');\n\t$(this).parent('.airportDropdownSubMenu').find('.airport-terminal').toggleClass('hide');\n});\n\n\n\n// ****************************** ends here ******************************* //\n\n/*==================================================*/\n/*====== Segment Properties related functions ======*/\n/*==================================================*/\n/* ========================= Airport OneWay =========================*/\nfunction getThirdPartnerName() {\n  \tif (localStorage.getItem(\"ixigoClientId\") == \"iximaad\" || localStorage.getItem(\"ixigoClientId\") == \"iximaio\") {\n  \t\treturn \"Partner_Ixigo\"\n  \t} else if (window.navigator.userAgent.includes('phonepe-webview')) {\n  \t\treturn \"Partner_PhonePe\"\n  \t} else if (localStorage.getItem(\"marketplace_partner\") == \"flipkart\") {\n  \t\treturn \"Partner_FlipKart\"\n  \t} else {\n  \t\treturn \"No_Partner\"\n  \t}\n  }\n\nvar Segment = {\n\n// method to sanitize properties to be sent to segment\n  sanitize: function (obj) {\n    if (typeof obj != 'object') {\n      return {};\n    }\n    var sanitizedObj = {};\n    var sanityKeywords = ['password', 'authenticity_token', 'cvv', 'card_number', 'cnum', 'card_token', 'card_name', 'cexpmon', 'cexpyr', 'cmon', 'cyr'];\n    $.each(obj, function (key, value) {\n      var pass = true;\n      sanityKeywords.forEach(function (keyword) {\n        if (key.indexOf(keyword) > -1) {\n          pass = false;\n          return pass;\n        }\n      });\n      if (pass) {\n        sanitizedObj[key] = value;\n      }\n    });\n    return sanitizedObj;\n  },\n\n// method to recognize element\n  recognize: function (element) {\n    return element.getAttribute('title') || element.getAttribute('data-title') || element.getAttribute('data-original-title') || element.id || $(element).text() || element.innerHTML.trim() || 'Unrecognized';\n  },\n\n// method to track page load\n  trackPageLoad: function (cookieObject) {\n    var cityRegex = /bangalore|delhi|pune|hyderabad|chennai|mumbai|chandigarh/;\n    var pageName = 'home';\n    var props = {\n    \t'city': cityLinkName,\n    \t'cookies': document.cookie,\n    \t'partnerKey': getThirdPartnerName()\n\t};\n    window.location.pathname.split('/').filter(Boolean).forEach(function (val) {\n      if (pageName == 'home') {\n        if (cityRegex.test(val)) {\n          props.city = val\n        }\n        else {\n          pageName = val;\n          return true;\n        }\n      }\n    });\n    if (pageName == 'home') {\n      props.verticals_active_tab = cookieObject.getCookie('verticals_active_tab')\n    }\n    window.analytics.page(pageName, props);\n  },\n\n//method to get all input key values of the form\n  getFormProperties: function (form, obj) {\n    obj = obj || {};\n    $(form).find('input,select').each(function (index, element) {\n      var key = element.name || element.id,\n\t\t  datetime,\n\t\t  dateArray;\n      if (key != '' && element.value != '') {\n      \tobj[key] = element.value;\n      \tif (element.className.includes('datetime')) {\n\t\t  datetime = element.value.split(' ');\n\t\t  //datetime[0] is date and datetime[1] is time\n\t\t  dateArray  = datetime[0].split('/');\n\t\t  obj[key] = dateArray[2] + ':'\t+ dateArray[1] + ':'\t+dateArray[0] + ' '\t+ datetime[1];\n\t\t}\n      }\n    });\n    return obj;\n  },\n\n//method to append form specific properties\n  appendFormSpecificProperties: function (params, form) {\n    return params\n  },\n\n// method to return properties for booking page\n  getBookingProperties: function (carId, locId, pId, flexi_priority) {\n    var btn = $('#ButtonYes' + carId);\n    var onclickfunc = btn.attr('onClick') || \"\";\n    onclickfunc = onclickfunc.split(';')[0];\n    var segmentProps = onclickfunc.split(/this\\s*,\\s*/).pop().replace(')', '').replace(/'/g, '\"');\n    segmentProps = segmentProps == '' ? btn.attr('segmentProps') : segmentProps;\n    try {\n      segmentProps = JSON.parse(segmentProps);\n    } catch (err) {\n      segmentProps = {}\n    }\n    jQuery.extend(segmentProps, {car_id: carId, location_id: locId, pid: pId, flexi_priority: flexi_priority});\n    return JSON.stringify(segmentProps);\n  },\n\n\tgetSearchProperties: function(){\n\t\tvar start_time = $('.start_trip').attr('data-seldate'),\n\t\t\t\tend_time = $('.end_trip').attr('data-seldate');\n\n\t\tvar data_obj = {\n\t\t\tlocation: $('.user_map_location').text(),\n\t\t\tcargroup: $('.selected_result_outer_container .car_name').text().trim(),\n\t\t\thd: $('.doorstep_service').hasClass('active'),\n\t\t\tduration: $('.duration_container .duration').attr('data-duration'),\n\t\t\tlocation_id: $('.selected_location .location_name').attr('data-loc-id'),\n\t\t\tcity: $('.active_city_name').text().trim(),\n\t\t\tflexi_id: $('.flexi_container').attr('data-sel-flexi'),\n\t\t\tsearch: searchVersion()\n\t\t}\n\n\t\tdata_obj.start_time = getFormattedDate(parseInt(start_time));\n\t\tdata_obj.end_time = getFormattedDate(parseInt(end_time));\n\n\t\tfunction getFormattedDate(raw_date){\n\t\t\tvar formatted_date = new Date(raw_date);\n\t\t\tformatted_date = formatted_date.getFullYear() + \"-\" + addZero(formatted_date.getMonth() + 1) + \"-\" + addZero(formatted_date.getDate()) + \" \" + addZero(formatted_date.getHours()) + \":\" + addZero(formatted_date.getMinutes()) + \":00\";\n\t\t\treturn formatted_date;\n\t\t}\n\n\t\tfunction addZero(value){\n\t\t\tif (value < 10){\n\t\t\t\treturn \"0\" + value;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\n\t\tfunction searchVersion(){\n\t\t\tif (window.location.search.indexOf(\"new_search\") > 0){\n\t\t\t\treturn \"new\";\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn \"old\";\n\t\t\t}\n\t\t}\n\n\t\treturn data_obj;\n\t},\n\n  // method to check if some event shouldn't be tracked\n  ignoreEvent: function (eventName) {\n    var ignore = false;\n    return ignore;\n  },\n\n  //method to return form's group name\n  getFormGroupName: function (form_id){\n    var groupName = undefined;\n    switch(form_id) {\n      case \"ZoomClassicSearchForm\":\n      case \"SearchHDForm\":\n      case \"SearchForm\":\n      case \"ZoomDealSearchForm\":\n      case \"ZoomCommuteSearchForm\":\n      case \"ZoomAirportSearchForm\":\n      case \"ZoomChauffeurSearchForm\":\n      case \"ChauffeurSearchForm\":\n      case \"PromoForm\":\n      case \"CheckoutForm\":\n      case \"BookNow\":\n      case \"CorporateForm\":\n      case \"CreditForm\":\n      case \"CancelBookingForm\":\n      case \"HDCancelBookingForm\":\n      case \"RescheduleBookingForm\":\n      case \"TariffForm\":\n        groupName = 'Search Form';\n        break;\n      case \"LoginForm\":\n      case \"DetailsForm\":\n      case \"CwCreateForm\":\n      case \"CwValidateForm\":\n      case \"ForgotForm\":\n      case \"AccountsForm\":\n      case \"CwForgetForm\":\n      case \"DealSignUpForm\":\n        groupName = 'User Details Form';\n        break;\n    }\n    return groupName;\n  },\n  trackEvent: function(category, data_obj) {\n  \t$.extend(data_obj, {cookies: document.cookie});\n    function checkValidity(obj) {\n      return obj != undefined && obj != null && obj != '';\n    }\n    if (arguments.length > 1 && checkValidity(category) && typeof data_obj == 'object' && checkValidity(data_obj.id) && data_obj.id != 'Unrecognized' && !Segment.ignoreEvent(data_obj.id)) {\n      analytics.track(category, data_obj);\n      return true;\n    }\n    else {\n      // not capturing unlisted events.\n      return false;\n    }\n  },\n  trackFormEvent: function(form, prop) {\n    prop = prop || {};\n    prop.id = form.getAttribute('data-segment-id');\n    prop.form_id = form.id;\n    prop.current_url = window.location.href;\n    var groupName = Segment.getFormGroupName(prop.id);\n    prop = Segment.getFormProperties(form, prop);\n    prop = Segment.appendFormSpecificProperties(prop, form);\n    Segment.trackEvent(groupName, Segment.sanitize(prop));\n  }\n};\n\n/*==================================================*/\n/*================ Referral signup =================*/\n/*==================================================*/\n\nfunction ajaxCall(type, complete_url, data_obj, error_msg, beforeSend, complete) {\n return $.ajax({\n   type: type,\n   url: complete_url,\n   data: data_obj,\n   dataType: 'json',\n   ContentType: \"application/json\",\n   beforeSend:beforeSend||function(){},\n   complete:complete||function(){}\n })\n}\n\n/*====== Booking Timer related functions ======*/\n/*==================================================*/\n\nvar isCurrentPage = function(pageKey) {\n\treturn (window.location.pathname.indexOf(pageKey) !== -1 ? true : false);\n}\n\nvar BookingTimer = function() {\n\tvar self = this;\n\tvar timeRemainingSpan = $('.remaining_time');\n\tvar progressMeter = $('.timer_progress_bar');\n\tvar bookingTimerDiv = $('#booking_timer');\n\n\tthis.setInitialTime = function(time) {\n\t\t// stores the seconds\n\t\tthis.originalTime = this.remainingSeconds = time * 60;\n\t\tthis.startTime = new Date(); // for keeping track of timer start before every second\n\t}\n\n\t// returns the formatted time for the timer\n\tthis.formattedTime = function() {\n\t\tvar minutes = parseInt(this.remainingSeconds / 60);\n\t\tvar seconds = parseInt(this.remainingSeconds % 60);\n\t\treturn ((minutes < 10) ? '0' + minutes : minutes) + ':' + ((seconds < 10) ? '0' + seconds : seconds);\n\t}\n\n\tthis.setTimer = function(alertTime) {\n\n\t\t// time after alert to be shown\n\t\tthis.alertTime = alertTime * 60 || this.alertTime;\n\n\t\t// if the timer has expired show the modal\n\t\tif (this.remainingSeconds <= 0) {\n\t\t\tsessionTimeout = true;\n\t\t\tthis.showModal();\n\t\t\t// redirect to search page on session timeout\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tpushEvent('Booking Timer','TimedOut');\n\t\t\t\twindow.location = '/' + cityLinkName + '/resume?timedout=1';\n\t\t\t}, 5*60*1000);\n\t\t\treturn;\n\t\t}\n\n\t\t// set the interval of 1s for timer\n\t\tthis.timerInterval = window.setInterval(function() {\n\t\t\tself.remainingSeconds--;\n\n\t\t\t// verify if the interval is accurate\n\t\t\tself.verifyRemainingSeconds();\n\n\t\t\t// update the start time of interval\n\t\t\tself.startTime = new Date();\n\n\t\t\t// save state to retain state on page reload on payment page\n\t\t\tsessionStorage.removeItem('timerInfo');\n\t\t\tsessionStorage.setItem('timerInfo', JSON.stringify({\n\t\t\t\t'remainingTime' : self.remainingSeconds,\n\t\t\t\t'alertTime' : self.alertTime,\n\t\t\t\t'originalTime' : self.originalTime\n\t\t\t}));\n\n\t\t\tself.setTimerDisplay();\n\n\t\t\t// session timeout\n\t\t\tif (self.remainingSeconds <= 0) {\n\t\t\t\twindow.clearInterval(self.timerInterval);\n\t\t\t\tsessionTimeout = true;\n\n\t\t\t\tself.showModal();\n\n\t\t\t\t// redirect to search page on session timeout\n\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\tpushEvent(\"Booking Timer\",\"TimedOut\");\n\t\t\t\t\twindow.location = '/' + cityLinkName + '/resume?timedout=1';\n\t\t\t\t}, 5*60*1000);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\t// function to verify if the interval is accurate for 1s\n\tthis.verifyRemainingSeconds = function() {\n\t\tvar currTime = new Date();\n\t\tvar originalDiff = Math.round((currTime - this.startTime) / 1000);\n\t\tif (originalDiff > 1) {\n\t\t\tthis.remainingSeconds = this.remainingSeconds - (originalDiff - 1);\n\t\t}\n\t}\n\n\tthis.pauseTimer = function() {\n\t\tsessionStorage.removeItem('timerInfo');\n\t\t// saves the current state of timer\n\t\tsessionStorage.setItem('timerInfo', JSON.stringify({\n\t\t\t'remainingTime' : this.remainingSeconds,\n\t\t\t'alertTime' : this.alertTime,\n\t\t\t'originalTime' : this.originalTime\n\t\t}));\n\t\twindow.clearInterval(this.timerInterval);\n\t}\n\n\tthis.resumeTimer = function() {\n\t\twindow.clearInterval(this.timerInterval);\n\t\t// fetch the state from sessionStorage\n\t\tif (sessionStorage.getItem('timerInfo')) {\n\t\t\tvar timerInfo = JSON.parse(sessionStorage.getItem('timerInfo'));\n\t\t\tthis.remainingSeconds = parseInt(timerInfo['remainingTime']);\n\t\t\tthis.alertTime = parseInt(timerInfo['alertTime']);\n\t\t\tthis.originalTime = parseInt(timerInfo['originalTime']);\n\t\t\tthis.startTime = new Date();\n\t\t\tthis.setTimer();\n\t\t} else {\n\t\t}\n\t}\n\n\t// handle the display of timer\n\tthis.setTimerDisplay = function() {\n\t\ttimeRemainingSpan.text(this.formattedTime());\n\n\t\t// Round off the time to 2 decimal places for percentage\n\t\tvar percentTimePassed = Math.round( parseFloat(this.remainingSeconds / this.originalTime) * 10000 ) / 100;\n\n\t\t// Inculcate percentage into progress bar width\n\t\tprogressMeter.css('width', percentTimePassed + '%');\n\n\t\t// if 2 mins remaining\n\t\tif (this.remainingSeconds <= this.alertTime) {\n\t\t\tbookingTimerDiv.addClass('time_up_alert');\n\t\t}\n\t}\n\n\t// show modal\n\tthis.showModal = function() {\n\t\t$('#booking_timer_overlay, #booking_timer_modal').show();\n\t\t$('#checkOut, .make_payment').attr('disabled', 'true'); // disables the buttons to proceed to next page\n\n\t\t// call to clear booking session created on checkout\n\t}\n\n\t// hide modal\n\tthis.hideModal = function() {\n\t\t$('#booking_timer_overlay, #booking_timer_modal').hide();\n\t\tpushEvent(\"Booking Timer\",\"TimedOut\");\n\t\twindow.location = '/' + cityLinkName + '/resume?timedout=1';\n\t}\n\n\t// on blur event of window page, pause the timer and on focus resume the timer\n\tthis.bindWindowBlurFocus = function() {\n\t\tif (new CookieModule().getCookie('abtestch20') !== \"\" && (isCurrentPage('checkout') || isCurrentPage('payment'))) {\n\t\t\t// pause the timer on tab change\n\t\t\t$(window).on('blur focus', function(e) {\n\t\t\t\tvar oldTabEvent = $(this).data('oldTabEvent');\n\t\t\t\tif (oldTabEvent !== e.type) { // prevents double firing of same event\n\t\t\t\t\tswitch (e.type) {\n\t\t\t\t\t\tcase 'blur' :\n\t\t\t\t\t\t\t(!sessionTimeout) ? self.pauseTimer() : $.noop();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'focus' :\n\t\t\t\t\t\t\t(!sessionTimeout) ? self.resumeTimer() : $.noop();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t$(this).data('oldTabEvent', e.type);\n\t\t\t});\n\t\t}\n\t}\n}\n\n// outside click of modal\n$('#booking_timer_overlay, .timer_close, .start_again').on('click', function() {\n\tnew BookingTimer().hideModal();\n});\n\n////////////////// New Search Page get Request ///////////////////////\nfunction getSearchData(form, url, paramStr, successCB) {\n\n\t//keep only those params necessary for get request\n\n\t// appending the formattedAddress param for now, needed for the new search page\n\n  if (form.elements.namedItem('formattedAddress') == null) {\n    form.insertAdjacentHTML('beforeend', '<input type=\"hidden\" name=\"formattedAddress\" value=\"' + ($('#map_search_input').val() || '') + '\">');\n  } else {\n    if (form.elements.namedItem('formattedAddress').value == '') {\n      form.elements.namedItem('formattedAddress').value = $('#map_search_input').val();\n    }\n  }\n  form.insertAdjacentHTML('beforeend', '<input type=\"hidden\" name=\"new_search\" value=\"true\">');\n\n\tfor (var i=0; i< form.elements.length; i++) {\n\t\tif (form.elements[i].value == '') {\n\t\t\tform.elements[i].disabled = true;\n\t\t}\n\n    // replace the space with html encoded value to remove plus\n    form.elements[i].value = form.elements[i].value.replace(/\\//g, '-');\n\t}\n\n\tvar endValue = $('#ends-form').val();\n\tvar formatDate = moment(endValue).format(\"DD[-]MM[-]YYYY[+]HH:mm\");\n\t$('#ends-form').val(formatDate);\n\n\n  // simple form submission using get\n  form.setAttribute('action', url);\n  form.setAttribute('type', 'GET');\n\n  form.submit();\n}\n\nfunction getRequestParams(URLString) {\n\tif (URLString.charAt(0) == '?') {\n\t\tURLString = URLString.slice(1);\n\t}\n  var paramHash = {};\n  if (URLString !== \"\") {\n  \tvar getParams = URLString.split('&');\n  \tgetParams.forEach(function(param) {\n  \t\tparam = param.split('=');\n  \t\tparamHash[decodeURIComponent(param[0]).trim()] = decodeURIComponent(param[1].trim());\n  \t});\n  }\n\treturn paramHash;\n}\n\nfunction changeairLocation1(id,name,action) {\n\tif(id != 17) {\n\t\tchangeairLocation2(17,\"Airport (Free Pick-Up from Airport Terminal)\",\"nav\");\n\t\t$(\"#dropoffloc ~ul\").addClass(\"hide\");\n\t}\n\telse if(id==17){\n\t\t$(\"#dropoffloc ~ul\").removeClass(\"hide\");\n\t\t$('#LocationHtmlAir2').html(\"Select Dropoff location\");\n\t\t$('#LocationHtmlAir2').addClass(\"lgrey\");\n\t\t$('#dropofflocval').val(\"\");\n\t}\n  $('#LocationValAir1').val(id);\n  $('#LocationHtmlAir1').html(name);\n  $('#LocationHtmlAir1').removeClass(\"lgrey\");\n  $('#pickuplocval').val(id);\n}\nfunction changeairLocation2(id,name,action) {\n  $('#LocationValAir2').val(id);\n  $('#LocationHtmlAir2').html(name);\n  $('.LocationsMenuAir2').find('li').removeClass('active');\n  $('#LocationAir2'+id).addClass('active');\n  $('#LocationHtmlAir2').addClass(\"black\");\n  $('#LocationHtmlAir2').removeClass(\"lgrey\");\n  $('#dropofflocval').val(name);\n  $('#dropofflocval').val(id);\n}\n\nfunction bindChangeCity () {\n\tvar cities = $('ul.dropdown-menu.cityDropdown').data('cities'),\n\t\tisHdEnabled = $('ul.dropdown-menu.cityDropdown').data('hd_enabled'),\n\t\tcityElements = $('ul.dropdown-menu.cityDropdown .active_cities');\n\tfor (var cityElementId = 0 ; cityElementId < cityElements.length; cityElementId++) {\n\t\tvar cityElement = $(cityElements[cityElementId]);\n\t\tcityElement.bind('click', {'city':cityElement.data('name').toLowerCase()}, function(event) {\n\t\t\tchangeCity(event.data.city, cities, isHdEnabled);\n\t\t});\n\t}\n}\n\nfunction bindRemoveSearchBar () {\n\tvar elementsToBind = $('.modify_search, a.mobile_search_icon, .verticals_search_area #mobile_search_box');\n\telementsToBind.click(function() {\n\t\tremoveSearchBar(elementsToBind.data('page'), elementsToBind.data('header_text'));\n\t});\n}\nfunction convert24hrTimeTo12hr (time24) {\n\tvar hrIn24Format = parseInt(time24.split('-')[0]);\n\tif (hrIn24Format === 0) {\n\t\treturn 12 + ':' + time24.split('-')[1] + ' am';\n\t}\n\tif (hrIn24Format <= 12) {\n\t\treturn hrIn24Format + ':' + time24.split('-')[1] + ' am';\n\t}\n\treturn hrIn24Format - 12 + ':' + time24.split('-')[1] + ' pm';\n}\n\nfunction bindGaEvents () {\n\tvar elementToTrack = $('.ga_track'),\n\t\tnumberOfElements = elementToTrack.length,\n\t\tdataTotrack,\n\t\telementIndex,\n\t\telement;\n\tfor (elementIndex = 0; elementIndex < numberOfElements; elementIndex++) {\n\t\telement = $(elementToTrack[elementIndex]);\n\t\tdataTotrack = {\n\t\t\t'category': element.data('category'),\n\t\t\t'action': element.data('action'),\n\t\t\t'label': element.data('label')\n\t\t};\n\t\telement.bind('click', dataTotrack, function (dataTotrack) {\n\t\t\tpushEvent(dataTotrack.data.category, dataTotrack.data.action, dataTotrack.data.label);\n\t\t});\n\t}\n}\nfunction changeLoyaltyCarouselCycle (){\n\t$('#loyalty_carousel').each(function(){\n\n\t\t// find carousel\n\t\t$(this).carousel();\n\n\t\tvar carousel = $(this).data('bs.carousel');\n\n\t\t// pause the cycle\n\t\tcarousel.pause();\n\n\t\t// Override the bootstrap carousel prototype function, adding a different one won't work\n\t\tcarousel.cycle = function (e) {\n\t\t\tif (!e) this.paused = false\n\t\t\tif (this.interval) clearInterval(this.interval);\n\t\t\tthis.options.interval\n\t\t\t&& !this.paused\n\t\t\t&& (this.interval = setInterval($.proxy(this.prev, this), this.options.interval))\n\t\t\treturn this;\n\t\t};\n\n\t\t// begin the cycle again\n\t\tcarousel.cycle();\n\t});\n}\nfunction appendZapForm (callFrom,user_id,provider,conflictUserData='') {\n\tif(isMobile() && typeof(Airim) != 'undefined' && callFrom == 'AirimChat')\n\t\tAirim.closeWidget();\n\tif (callFrom)\n\t\tpushEvent('ZAP', 'Register', callFrom);\n\t// showNewModal('Sign Up', '/zap/zap_reg_form?' + window.location.search.replace('?','') + (user_id ? '&user_id=' + user_id : '') + (provider ? '&provider=' + provider : '') + conflictUserData);\n\twindow.location = '/zap-funnel/';\n\tvar airim_frame = $('iframe[src=\"https://www.airim.co/chat?&cuid=a9965d3e-8b16-0aaa-3089-a535b514134a\"]');\n\tif (airim_frame)\n\t\tairim_frame.css('z-index','1000');\n\t$('#newZapUser').addClass('hide');\n\t$('#registeredZapUser').removeClass('hide');\n}\nfunction populateFlexCarTypes() {\n\t$('#flex_car_type_id').html('<span class = \"light-grey\">Please wait...</span><span class = \"caret\"></span>');\n\t$('#flex_cargroups').html('<span class = \"light-grey\">Select car type</span><span class = \"caret\"></span>');\n\t$.ajax({\n\t\turl: '/zap/flex_cars?city_id=' + $('#zap_residence_city_id').val() + '&car_type_id=' + $('#zap_flex_car_type_id').val(),\n\t\ttype: 'GET'\n\t}).done(function (flexCars) {\n\t\tcarTypes = flexCars['types'];\n\t\tlet carType, inputCarType, tempLI, tempA, carGroups;\n\t\tinputCarType = $('#flex_input_car_type');\n\t\tinputCarType.html('');\n\t\tfor (i = 0; i< carTypes.length; i++)\n\t\t{\n\t\t\tcarGroups = flexCars['cars'][carTypes[i][0]]\n\t\t\ttempLI = document.createElement('li');\n\t\t\ttempA = document.createElement('a');\n\t\t\ttempA.setAttribute('flex_cars', carGroups);\n\t\t\ttempA.setAttribute('flex_car_type_id', carTypes[i][0]);\n\t\t\ttempA.onclick = function() {dropdownValue('flex_car_type_id',this.text,this.getAttribute('flex_car_type_id'));populateFlexCarGroups(this.getAttribute('flex_cars'))};\n\t\t\ttempA.text= carTypes[i][1];\n\t\t\ttempLI.append(tempA);\n\t\t\tinputCarType.append(tempLI);\n\t\t\t$('#zap_flex_car_type_id').val('');\n\t\t\t$('#flex_car_type_id').html('<span class = \"light-grey\">Car type interested in</span><span class = \"caret\"></span>');\n\t\t}\n\t});\n}\nfunction populateFlexCarGroups(cars) {\n\tcars = cars.split(',');\n\t$('#flex_cargroups').html('<span class = \"light-grey\">Please wait...</span><span class = \"caret\"></span>');\n\tlet carType, inputCarGroup, tempLI, tempA, text;\n\tinputCarGroup = $('#flex_input_cargroup');\n\tinputCarGroup.html('');\n\tfor (carType in cars) {\n\t\ttempLI = document.createElement('li');\n\t\ttempA = document.createElement('a');\n\t\ttempA.onclick = function() {dropdownValue('flex_cargroups',this.text)};\n\t\ttempA.text= cars[carType];\n\t\ttempLI.append(tempA);\n\t\tinputCarGroup.append(tempLI);\n\t}\n\t$('#zap_flex_cargroups').val('');\n\t$('#flex_cargroups').html('<span class = \"light-grey\">Select Car</span><span class = \"caret\"></span>');\n}\nfunction populateCarTypes () {\n\t$.ajax({\n\t\turl: '/zap/cars?city=' + $('#residence').text().trim().toLowerCase(),\n\t\ttype: 'GET'\n\t}).done(function (carTypes) {\n\t\tvar carTypeId, inputCarType, tempLI, tempA;\n\t\tinputCarType = $('#input_car_type');\n\t\tinputCarType.html('');\n\t\tfor (carTypeId in carTypes) {\n\t\t\ttempLI = document.createElement('li');\n\t\t\ttempA = document.createElement('a');\n\t\t\ttempA.setAttribute('zap_car_id', carTypes[carTypeId].id);\n\t\t\ttempA.onclick = function() {dropdownValue('cargroups',this.text,this.getAttribute('zap_car_id'))};\n\t\t\ttempA.text= carTypes[carTypeId].name;\n\t\t\ttempLI.append(tempA);\n\t\t\tinputCarType.append(tempLI);\n\t\t}\n\t\t$('#cargroups').html('<span class = \"light-grey\">Select Car</span><span class = \"caret\"></span>')\n\t\t$('#zap_cargroups').val('')\n\t});\n}\nvar carModels;\nfunction populateCarBrands () {\n\t$.ajax({\n\t\turl: '/zap/car_models?city=' + $('#residence').text().trim().toLowerCase(),\n\t\ttype: 'GET'\n\t}).done(function (carBrands) {\n\t\tvar carBrand, inputCarType, tempLI, tempA;\n\t\tcarModels = carBrands;\n\t\tinputCarType = $('#input_car_brand');\n\t\tinputCarType.html('');\n\t\tfor (carBrand in carBrands) {\n\t\t\ttempLI = document.createElement('li');\n\t\t\ttempA = document.createElement('a');\n\t\t\ttempA.onclick = function() {dropdownValue('brands',this.text);populateCarModels(this.text)};\n\t\t\ttempA.text = carBrand;\n\t\t\ttempLI.append(tempA);\n\t\t\tinputCarType.append(tempLI);\n\t\t}\n\t\t$('#brands').html('<span class = \"light-grey\">Select Brand</span><span class = \"caret\"></span>');\n\t\t$('#zap_brands').val('');\n\t\t$('#models').html('<span class = \"light-grey\">Select Model</span><span class = \"caret\"></span>');\n\t\t$('#zap_models').val('');\n\t});\n}\nfunction populateCarModels (brand) {\n\tvar carMakeId, inputCarType, tempLI, tempA;\n\tinputCarType = $('#input_car_model');\n\tinputCarType.html('');\n\tif(brand != \"Other\")\n\t{\n\t\tfor (carMakeId in carModels[brand]) {\n\t\t\ttempLI = document.createElement('li');\n\t\t\ttempA = document.createElement('a');\n\t\t\ttempA.setAttribute('car_type_id', carModels[brand][carMakeId]);\n\t\t\ttempA.onclick = function() {dropdownValue('models',this.text);dropdownValue('cargroups_25',this.getAttribute('car_type_id'))};\n\t\t\ttempA.text = carMakeId;\n\t\t\ttempLI.append(tempA);\n\t\t\tinputCarType.append(tempLI);\n\t\t}\n\t\ttempLI = document.createElement('li');\n\t\ttempA = document.createElement('a');\n\t\ttempA.setAttribute('car_type_id', 'Other');\n\t\ttempA.onclick = function() {dropdownValue('models',this.text);dropdownValue('cargroups_25',this.getAttribute('car_type_id'))};\n\t\ttempA.text = \"Other\";\n\t\ttempLI.append(tempA);\n\t\tinputCarType.append(tempLI);\n\t\t$('#models').html('<span class = \"light-grey\">Select Model</span><span class = \"caret\"></span>');\n\t\t$('#zap_models').val('');\n\t}\n\telse\n\t{\n\t\ttempLI = document.createElement('li');\n\t\ttempA = document.createElement('a');\n\t\tdropdownValue('models',this.text);\n\t\tdropdownValue('cargroups_25','Other');\n\t\ttempA.text = \"Other\";\n\t\ttempLI.append(tempA);\n\t\tinputCarType.append(tempLI);\n\t\t$('#models').html('<span class>Other</span><span class = \"caret\"></span>')\n\t\t$('#zap_models').val('Other')\n\t}\n\n}\n\nfunction checkRef() {\n\tdocument.cookie='ref=;domain=.zoomcar.com;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/'; // to remove old ref cookie\n\tdocument.cookie='ref=;domain=www.zoomcar.com;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/'; // to remove old ref cookie\n\tdocument.cookie='ref_initial=;domain=.zoomcar.com;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/'; // to remove old ref_initial cookie\n\tdocument.cookie='ref_initial=;domain=www.zoomcar.com;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/'; // to remove old ref_initial cookie\n\tlet oldRefs = decodeURIComponent((new CookieModule).getCookie('ref')).split(',').filter(Boolean), newRef = '-', index;\n\tif (window.location.search.match('ref=')) {\n\t\tnewRef = window.location.search.split('ref=').slice(-1)[0] || '-';\n\t}\n\t(new CookieModule).setCookie('ref_immediate',newRef.split('&')[0]);\n\tindex = oldRefs.indexOf(newRef);\n\tif (index > -1) {\n\t\toldRefs.splice(index, 1);\n\t}\n\tif (oldRefs.indexOf('-') > -1) {\n\t\toldRefs.splice(oldRefs.indexOf('-'), 1);\n\t}\n\tif (oldRefs.length > 0) {\n\t\tnewRef = oldRefs.splice(-4,4).toString() + ',' + newRef;\n\t}\n\t(new CookieModule).setCookie('ref_initial',newRef);\n\t(new CookieModule).setCookie('ref',newRef);\n}\n\nfunction getSubscribeCars(city = 1) {\n\tfetch(\n\t\twindow.globals.apiHostName + \"/zap_sales/zap_enabled_car/campaign_enabled_cargroup?campaign=prebook&city_id=\" + city,{\n\t\t\theaders: {\n\t\t\t\t\"auth-token\": getCookie('authToken')\n\t\t\t}\n\t\t}\n\t).then(\n\t\tr => r.json()\n\t).then(\n\t\tfunction (cars) {\n\t\t\tlet car, container, tempDiv, tempContent, tempImg, holderElement1, holderElement2;\n\t\t\tcontainers = [document.querySelector('#subscribeGallery1'),document.querySelector('#subscribeGallery2')];\n\t\t\tcontainers[0].innerHTML = '';\n\t\t\tcontainers[1].innerHTML = '';\n\t\t\tfor (index in cars) {\n\t\t\t\t// if (index > 11)\n\t\t\t\t// \tbreak\n\t\t\t\tcar = cars[index];\n\t\t\t\ttempDiv = document.createElement('a');\n\t\t\t\ttempDiv.href = '/zap/subscribe/selection?car=' + car.actual_cargroup_id;\n\t\t\t\ttempDiv.classList=\"carsInfo\";\n\n\t\t\t\ttempContent = document.createElement('div');\n\t\t\t\ttempContent.classList=\"carImg\";\n\n\t\t\t\t\ttempImg = document.createElement('img');\n\t\t\t\t\ttempImg.src = car.cargroup_image;\n\t\t\t\t\tholderElement1 = document.createElement('div');\n\t\t\t\t\tholderElement1.classList = 'carName';\n\t\t\t\t\tholderElement1.innerHTML = car.cargroup_name;\n\n\t\t\t\t\t\tholderElement2 = document.createElement('div');\n\t\t\t\t\t\tholderElement2.classList = 'seating';\n\t\t\t\t\t\tholderElement2.innerText = car.seating + ' SEATER';\n\t\t\t\t\t\tholderElement1.append(holderElement2);\n\n\t\t\t\t\ttempContent.append(tempImg);\n\t\t\t\t\ttempContent.append(holderElement1);\n\n\t\t\t\ttempDiv.append(tempContent);\n\n\t\t\t\ttempContent = document.createElement('div');\n\t\t\t\ttempContent.classList=\"carDesc\";\n\n\t\t\t\t\tholderElement1 = document.createElement('div');\n\t\t\t\t\tholderElement1.classList=\"carPrice\";\n\t\t\t\t\tholderElement1.innerText = 'Monthly Fee';\n\n\t\t\t\t\t\tholderElement2 = document.createElement('strike');\n\t\t\t\t\t\tholderElement2.classList = 'white';\n\t\t\t\t\t\tholderElement2.innerText = '' + car.actual_rental.formatMoney(0, '.', ',');\n\t\t\t\t\t\tholderElement1.append(holderElement2);\n\n\t\t\t\t\t\tholderElement2 = document.createElement('div');\n\t\t\t\t\t\tholderElement2.classList = 'size-24 white';\n\t\t\t\t\t\tholderElement2.innerText = '' + car.rental.formatMoney(0, '.', ',');\n\t\t\t\t\t\tholderElement1.append(holderElement2);\n\n\t\t\t\t\ttempContent.append(holderElement1);\n\t\t\t\t\tholderElement1 = document.createElement('div');\n\t\t\t\t\tholderElement1.classList=\"carPrice\";\n\t\t\t\t\tholderElement1.innerText = 'Security Desposit: ' + car.deposit.formatMoney(0, '.', ',');\n\t\t\t\t\ttempContent.append(holderElement1);\n\n\t\t\t\ttempDiv.append(tempContent);\n\t\t\t\tcontainers[(parseInt(index) + 1) * 5 / ((cars.length) * 2) <= 1 ? 0 : 1].append(tempDiv);\n\t\t\t}\n\t\t\tif(window.location.search.includes('zapVideo'))\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\twindow.scrollTo(0,document.querySelector('#zapVideo').offsetTop - document.querySelector('#zap_floating_header').offsetHeight)\n\t\t\t\t}, 100);\n\t\t}\n\t);\n}\n\n// smooth scroll top to bottom function\nfunction ScrollTo(name) {\n\tScrollToResolver(document.getElementById(name));\n}\nfunction ScrollToResolver(elem) {\n\tvar jump = parseInt(elem.getBoundingClientRect().top * .2);\n\tdocument.body.scrollTop += jump;\n\tdocument.documentElement.scrollTop += jump;\n\t//lastjump detects anchor unreachable, also manual scrolling to cancel animation if scroll > jump\n\tif (!elem.lastjump || elem.lastjump > Math.abs(jump)) {\n\t\telem.lastjump = Math.abs(jump);\n\t\tsetTimeout(function() {\n\t\t\tScrollToResolver(elem);\n\t\t}, \"20\");\n\t} else {\n\t\telem.lastjump = null;\n\t}\n}\n\nfunction openZapSubscribeForm (data = {}, showHelp = false) {\n\tvar auth_token = getCookie('authToken');\n\t\tif (showHelp) {\n\t\t\tsaleForm.$children[0].setHelpScreen(showHelp);\n\t\t}\n\t\tif (auth_token) {\n\t\t\tsetZapRequestID(data, 'flex')\n\t\t} else {\n\t\t\t// showing <subscribe-sale-form component/>>\n\t\t\t$('#newModal').modal('show');\n\t\t}\n}\nfunction setZapRequestID (data, version='2.0') {\n\tfetch(`//${window.globals.apiHostName}/v4/zaps/zap_requests/find_zap_request`,{\n\t\tmethod: 'POST',\n\t\theaders:{\n\t\t\t'Content-Type': 'application/json',\n\t\t\t'auth-token': getCookie('authToken')\n\t\t  },\n\t\tbody:JSON.stringify({\n\t\t\tzap_version : version\n\t\t})\n\t  })\n\t.then(r => {\n\t\tif (r.status === 200) {\n\t\t\treturn r.json();\n\t\t} else if (r.status === 400){\n\t\t\treturn Promise.reject(r.json());\n\t\t}\n\t})\n\t.then(response => {\n\t\t// if user already has zap request ID\n\t\tgetZapRequestData(response.zap_request_id, version)\n\t})\n\t.catch(error => {\n\t\t// if user don't have zaprequest ID\n\t\tif(version === '2.0') {\n\t\t\twindow.location = '/zap-funnel'\n\t\t} else {\n\t\t\t$('#newModal').modal('show');\n\t\t}\n\t})\n}\nfunction getZapRequestData(zapRequestId, version = '2.0') {\n\tfetch(`//${window.globals.apiHostName}/v4/zaps/zap_requests/${zapRequestId}`,{\n\t\theaders: {\n\t\t\t\"auth-token\": getCookie('authToken')\n\t\t}\n\t})\n\t.then((r) => {\n\t\tif (r.status == 403) {\n\t\t\twipeCookies();\n\t\t}\n\t\treturn r.json();\n\t})\n\t.then((response) => {\n\t\tdocument.cookie='zapRequest='+JSON.stringify(response)+\";path=/zap;domain=.\" + window.location.host.replace('www.','');\n\t\tdocument.cookie='zapRequestId='+response.zap_request.id+\";path=/zap;domain=.\" + window.location.host.replace('www.','');\n\t\tdocument.cookie='zapSubscribeSalePayment='+response.zap_request.is_prebook_payment_done+\";path=/zap;domain=.\" + window.location.host.replace('www.','');\n\t\tvar subscribeStep = response.zap_request.post_prebook_status == 'delivery_address_updated' ? 1 : response.zap_request.post_prebook_status == 'agreement_acknowledged' ? 2 : response.zap_request.post_prebook_status == 'payment_done' ? 3 : response.zap_request.post_prebook_status == 'slot_selected' ? 4 : 0;\n\t\tdocument.cookie='zapSubscribeStep='+subscribeStep+\";path=/zap;domain=.\" + window.location.host.replace('www.','');\n\t\tif (window.location.href.match('/zap/subscribe/onboarding'))\n\t\t\tif (version != '2.0')\n\t\t\t\t$('#newModal').modal('show')\n\t\t\telse\n\t\t\t\twindow.location = version != '2.0' ? '/zap/subscribe/onboarding' : '/zap-funnel/dashboard'\n\t})\n}\n\nfunction initializeZAPDatepicker () {\n\tserverTime = serverTime.setDate(serverTime.getDate() + 0); //modifying serverTime to skip days\n\tvar now = new Date(serverTime), last = new Date(now);\n\tlast.setDate(last.getDate() + 3); //number of days in the future to show\n\tif (now.getHours() >= 18)\n\t\tnow.setDate(now.getDate() + 1);\n\t$(\"#zap_date\").datetimepicker({\n        format: \"D, d M, yyyy\",\n        defaultDate: now,\n        startDate: now,\n        endDate: last,\n        startView: 2,\n        minView: 2,\n        autoclose: true\n    });\n    $('#zap_date').datetimepicker('setDate', now);\n    populateCallSlots();\n}\nfunction populateCallSlots () {\n\tvar now = new Date($(\"#zap_date\").val()) > serverTime ? new Date($(\"#zap_date\").val()) : new Date(serverTime),\n\thour = now.getHours(),\n\tslot = 1,\n\tminSlot = 1,\n\tcallSlots = $('#callSlots'),\n\tday,\n\ttempLI,\n\ttempA;\n\tcallSlots.html('');\n\tif (now.getHours() >= 18)\n\t{\n\t\tnow.setDate(now.getDate() + 1);\n\t\tday = now.toLocaleDateString('en-IN',{weekday:'short', day:'numeric', month:'long'})\n\t}\n\telse\n\t{\n\t\tday = now.toLocaleDateString('en-IN',{weekday:'short', day:'numeric', month:'long'})\n\t\tminSlot = hour >= 13 ? 7 : ( hour >= 11 ? 6 : ( hour >= 9 ? 5 : ( hour >= 7 ? 4 : ( hour >= 5 ? 3 : ( hour >= 3 ? 2 : ( hour >= 1 ? 1 : 0 ) ) ) ) ) )\n\t\tslot = Math.max(1, minSlot - 1);\n\t}\n\t$('#callslot').html('<span class=\"light-grey\">Time<span class=\"caret\"></span>');\n\t$('#zap_calldate').val('');\n\t// Uncomment to enable call me now\n\tif (new Date($(\"#zap_date\").val()) <= serverTime && now.getHours() < 18 && now.getHours() >= 9)\n\t{\n\t\tvar immediateTime = new Date(serverTime);\n\t\timmediateTime.setMinutes(immediateTime.getMinutes() + 15 % immediateTime.getMinutes());\n\t\timmediateTime.toLocaleDateString('en-IN',{weekday:'short', day:'numeric', month:'long'});\n\t\ttempLI = document.createElement('li');\n\t\ttempA = document.createElement('a');\n\t\ttempA.setAttribute('call_date', immediateTime);\n\t\ttempA.setAttribute('call_year', now.getFullYear());\n\t\ttempA.setAttribute('call_slot', 0);\n\t\ttempA.text = ('Call Me Now');\n\t\ttempA.onclick = function() {setCallSlot(this.getAttribute('call_date'),this.getAttribute('call_year'),this.getAttribute('call_slot'),this.text)};\n\t\ttempLI.append(tempA);\n\t\tcallSlots.append(tempLI);\n\t}\n\tfor(slot; slot < 7; slot++)\n\t{\n\t\ttempLI = document.createElement('li');\n\t\ttempA = document.createElement('a');\n\t\tif (slot < minSlot)\n\t\t{\n\t\t\ttempLI.setAttribute('class', 'disabled');\n\t\t\ttempA.text = (((slot - 1) * 2 + 9) + ':00 - ' + (slot * 2 + 9) + ':00 (Slot full)');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttempA.setAttribute('call_date', day);\n\t\t\ttempA.setAttribute('call_year', now.getFullYear());\n\t\t\ttempA.setAttribute('call_slot', slot);\n\t\t\ttempA.text = (((slot - 1) * 2 + 9) + ':00 - ' + (slot * 2 + 9) + ':00');\n\t\t\ttempA.onclick = function() {setCallSlot(this.getAttribute('call_date'),this.getAttribute('call_year'),this.getAttribute('call_slot'),this.text)};\n\t\t}\n\t\ttempLI.append(tempA);\n\t\tcallSlots.append(tempLI);\n\t}\n}\n\nbindChangeCity();\nbindRemoveSearchBar();\nbindGaEvents();\nchangeLoyaltyCarouselCycle();\nif (location.search.indexOf('oauth') !== -1 &&\n\tsessionStorage.zapHomePageOauth !== \"true\") {\n\tappendZapForm();\n\tsessionStorage.zapHomePageOauth = \"true\";\n}\n\n$(window).load(function () {\n\tvar currentPath = window.location.pathname;\n\tswitch (currentPath) {\n\t\tcase '/users/profile/':\n\t\tcase '/users/profile':\n\t\t\tLoyaltyProgram.loadDefaultContent();\n\t\t\tif (window.location.hash === '#loyalty')\n\t\t\t$(window).scrollTop(100);\n\t\t\tbreak;\n\t\tcase '/app_buddy':\n\t\tcase '/app_buddy/':\n\t\t\tAppBuddy.loadAppBuddy();\n\t\t\tbreak;\n\t\tcase '/app_buddy/bills':\n\t\tcase '/app_buddy/bills/':\n\t\t\tAppBuddy.loadBills();\n\t\t\tbreak;\n\t}\n})\n\n// this function updates the browser session with the latest selected zap location data\nfunction updateZapSession(el) {\n\tvar radius = parseFloat($(el).attr(\"data-radius\"))\n\t\t, allocation_info = JSON.parse($(el).attr(\"data-allocation_info\"));\n\n\tsessionStorage.setItem('locationInfo', JSON.stringify(\n\t\t{\n\t\t\tradius: radius,\n\t\t\tallocation_info: allocation_info\n\t\t}\n\t));\n}\n\n// called when the help icon in the search item is clicked\n// opens the zapLocationModal\nfunction initZapMapModal(el, start_date) {\n\n\tvar $this = $(el)\n\t\t, lat = parseFloat($this.attr('data-lat'))\n\t\t, lng = parseFloat($this.attr('data-lng'))\n\t\t, radius = parseFloat($this.attr('data-radius'))\n\t\t, allocation_info = $this.attr('data-allocation_info')\n\t\t, allocation_time\n\t\t, date_now\n\t\t, date_alloc\n\t\t, bookingPageText = $this.attr('data-text')\n\t\t, text\n\t\t, zoom;\n\n\t// Change the text depending on the time the modal is opened\n\tif (allocation_info){\n\t\tallocation_info = JSON.parse(allocation_info);\n\t\tallocation_time = allocation_info.allocation_time;\n\t\tdate_now = Date.now();\n\t\tdate_alloc = new Date(date_now + allocation_time);\n\t\tif(start_date > date_alloc){\n\t\t\ttext = allocation_info.text;\n\t\t}\n\t\telse{\n\t\t\ttext = allocation_info.text_jit;\n\t\t}\n\t}\n\tif(bookingPageText){\n\t\ttext = bookingPageText;\n\t}\n\n\t// set zoom level depending on radius\n\tif (radius <= 0.5) {\n\t\tzoom = 15;\n\t}\n\telse if (radius > 0.5 && radius <= 1) {\n\t\tzoom = 14;\n\t}\n\telse if (radius > 1 && radius <= 2) {\n\t\tzoom = 13;\n\t}\n\telse {\n\t\tzoom = 12;\n\t}\n\n\t// update the car allocation text in the placeholder of the zapLocationModal\n\t$('.zapModalText').text(text);\n\n\t$('#zapLocModal').on('shown.bs.modal', function() {\n\t\t// Create the map.\n\t\tvar map = new google.maps.Map(document.getElementById('zapModalMap'), {\n\t\t\tzoom: zoom,\n\t\t\tcenter: {lat: lat, lng: lng},\n\t\t\tzoomControl: false,\n\t\t\tstreetViewControl: false,\n\t\t\tmapTypeControl: false,\n\t\t\tscrollwheel: false,\n\t\t\tfullscreenControl: false,\n\t\t\tdisableDoubleClickZoom: true,\n\t\t\tdraggable: false\n\t\t});\n\n\t\tif (radius && radius > 0){\n\t\t\t// Construct the circle if there is a zap radius available.\n\t\t\tnew google.maps.Circle({\n\t\t\t\tstrokeColor: '#3F51B5',\n\t\t\t\tstrokeOpacity: 0.3,\n\t\t\t\tstrokeWeight: 1,\n\t\t\t\tfillColor: '#3F51B5',\n\t\t\t\tfillOpacity: 0.25,\n\t\t\t\tmap: map,\n\t\t\t\tcenter: {lat: lat, lng: lng},\n\t\t\t\tradius: radius * 1000\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\t// Add a marker if there is an exact location available\n\t\t\tnew google.maps.Marker({\n\t\t\t\tposition: {lat: lat, lng: lng},\n\t\t\t\tmap: map\n\t\t\t});\n\t\t\t$('.zapModalAllocInfo').text('Car has been allocated to you at the below address : ');\n\t\t}\n\t});\n\t// open the zapLocationModal\n\t$('#zapLocModal').modal('show');\n}\n\n// callback function for google maps script load for checkout and payment, on pageload\nfunction initZapMapSnippet() {\n\tvar mapElement\n\t\t, locationInfo = sessionStorage.getItem('locationInfo');\n\n\tvar Sessionradius\n\t\t, allocation_info\n\t\t, isJitBooking = $(\"input[name='isJitBooking']\").val()\n\t\t, lat = parseFloat($(\"input[name='zap_lat']\").val())\n\t\t, lng = parseFloat($(\"input[name='zap_lng']\").val())\n\t\t, radius = parseFloat($(\"input[name='zap_radius']\").val());\n\n\tif (locationInfo) {\n\t\tlocationInfo = JSON.parse(locationInfo);\n\t\tSessionradius = parseFloat(locationInfo.radius);\n\t\tallocation_info = locationInfo.allocation_info\n\t}\n\n\tif(isNaN(radius)) {\n\t\tradius = Sessionradius;\n\t}\n\n\t// check if mobile, change the element to be initialized with map depending on device\n\tif(isMobile()){\n\t\tmapElement = 'snippetMapAreaMobile';\n\t}\n\telse{\n\t\tmapElement = 'snippetMapAreaWeb';\n\t}\n\tif (!isNaN(lat) && !isNaN(lng)) {\n\t\t// Create the map.\n\t\tvar map = new google.maps.Map(document.getElementById(mapElement), {\n\t\t\tzoom: 11,\n\t\t\tcenter: {lat: lat, lng: lng},\n\t\t\tzoomControl: false,\n\t\t\tstreetViewControl: false,\n\t\t\tmapTypeControl: false,\n\t\t\tscrollwheel: false,\n\t\t\tfullscreenControl: false,\n\t\t\tdisableDoubleClickZoom: true,\n\t\t\tdraggable: false\n\t\t});\n\n\t\tif (radius && radius > 0){\n\t\t\t// Construct the circle if there is a zap radius available.\n\t\t\tnew google.maps.Circle({\n\t\t\t\tstrokeColor: '#428bca',\n\t\t\t\tstrokeOpacity: 0.3,\n\t\t\t\tstrokeWeight: 1,\n\t\t\t\tfillColor: '#428bca',\n\t\t\t\tfillOpacity: 0.25,\n\t\t\t\tmap: map,\n\t\t\t\tcenter: {lat: lat, lng: lng},\n\t\t\t\tradius: radius * 1000\n\t\t\t});\n\n\t\t\t// set the data attributes of the help icon, which will be used in the map modal\n\t\t\t$('.helpIcon').attr({\n\t\t\t\t\"data-radius\": radius,\n\t\t\t\t\"data-allocation_info\": JSON.stringify(allocation_info)\n\t\t\t})\n\t\t}\n\t\telse{\n\t\t\t// Add a marker if there is an exact location available\n\t\t\tnew google.maps.Marker({\n\t\t\t\tposition: {lat: lat, lng: lng},\n\t\t\t\tmap: map\n\t\t\t});\n\n\t\t\t// hide the help icon for non zap items\n\t\t\t$('.helpIcon').addClass('hide');\n\t\t\t$('.snippetText').css({'width': '100%'});\n\t\t}\n\t}\n}\nfunction getGoogleKey() {\n \tvar googleMapsKey = window.location.hostname.match(/zoomcarstaging.com|zoomcar.com|zoomaws.com/) ? 'AIzaSyDvwYfKKdchtJ2zoATMzZM4h5CIZxlFf0k' : 'AIzaSyCELeHlO29vK37mobIILQbgSMY72XB7F98'\n    return googleMapsKey\n}\nfunction getDateObject(date) {\n  var datetimeArr = date.split(' ');\n  var dateArr = datetimeArr[0].split(/\\//g); //splits the first half of time separated by slash character\n  var timeArr = datetimeArr[1].split(':');\n  //Uses the Javascript Date format of Date(year,month,date,hour,minute,second,microsecond);\n  return new Date(parseInt(dateArr[2]), parseInt(dateArr[1]) - 1, parseInt(dateArr[0]), parseInt(timeArr[0]), parseInt(timeArr[1]), 0, 0);\n}\n\n$('body').click(function(event){\n    if (!event.target.classList.contains('arrow_down') &&\n        !event.target.classList.contains('header_avatar') &&\n        !event.target.classList.contains('user_name_header')){\n        $('.right_options .dropdown').css({'display':'none'});\n    } else {\n    \t$(this).find('.user_block .dropdown').css({'display':'block'});\n    }\n});\n\n\n$('.new_home_page_header .option').hover(\n    function (event) {\n        var dropdown = $(event.currentTarget).find('.dropdown');\n        $('.right_options .dropdown').css({'display': 'none'});\n        dropdown.css({'display': 'block'});\n    },\n    function () {\n        $('.right_options .dropdown').css({'display': 'none'});\n    }\n);\n\n"},706:function(t,e){t.exports="$(function() {\n  if (isMobile()) {\n    $('.old-search-loc-drop, .loc-name').removeAttr('data-toggle');\n    $('.modal.fade').removeClass('fade');\n    if (window.location.pathname.indexOf('checkout') !== -1) {\n      $('#mobile_promo').remove();\n    }\n\n    $('#faqs-tabs a').on('click', function() {\n      $('html, body').animate({\n        scrollTop: $(\"#faqs-body\").offset().top - 30\n      },100);\n    });\n\n    // prevents the repositioning of input field in mobile devices such that datetimepicker can be opened\n    $('body').on('click', '.datetime', function(e) {\n      e.preventDefault();\n      var $el = $($(this));\n        var shiftedTop = $el.offset().top + $el.outerHeight();\n        $('.datetimepicker').offset({top: shiftedTop - 1});\n    });\n\n    if (isiDevice()) {\n      var viewport = document.querySelector(\"meta[name=viewport]\");\n      viewport.setAttribute('content', 'width=device-width, initial-scale=1, user-scalable=no');\n\n      // for iphone make the checkout button 20px from bottom so that it is clickable\n      if (window.location.pathname.indexOf('login') !== -1 || window.location.pathname.indexOf('checkout') !== -1) {\n        $('.checkoutButton').css('bottom', '20px');\n      }\n    }\n\n    setAppInfo();\n  }\n\n  $('#newModalBodyRight').on('input', '.autocomplete_search', function() {\n    // code for AUTOcomplete\n    var locationQuery = $(this).val();\n    $('.location_list li').remove();\n    var ulElement = $('.location_list');\n    if (locationQuery.length >= 2) {\n      locationNames.forEach(function(location) {\n        if (location['searchable_location_name'].toLowerCase().indexOf(locationQuery.toLowerCase()) !== -1) {\n          var locItem = $('<li class = \"location_item\" data-id = \"' + location['location_id'] + '\"><a href = \"javascript:void(0)\"></a></li>');\n          locItem.find('a').text(location['complete_location_name']);\n          $(ulElement).append(locItem);\n        }\n      });\n    }\n    else {\n      $('.location_list').html(actualLocationList);\n    }\n  });\n\n  $('#newModalBodyRight').on('click', '.location_item', function() {\n    $('#LocationVal').val($(this).data('id'));\n    $('#mobileLocationSelect').find('.location_name').text($(this).find('a').text());\n    $('#newModal').modal('hide');\n  });\n});\n\nfunction isiDevice() {\n  return /ipad|iphone|ipod/i.test(navigator.userAgent.toLowerCase());\n}\n\nfunction isAndroid() {\n  return /android/i.test(navigator.userAgent.toLowerCase());\n}\n\nvar updateCarId = function(el) {\n  $('#CarsVal').val($(el).val());\n}\n\nvar changeSearchType = function(el) {\n  if ($(el).val() == \"hd\" || $(el).val() == \"site\") {\n    $('#mobileLocationSelect').removeClass('show').addClass('hide');\n    $('#hdlocation').removeClass('hide').addClass('show');\n    $('#airportMobileDropdown').parent('.item_hd').removeClass('show').addClass('hide');\n    if($(el).val() == \"hd\"){\n      $('#hdEnable').val(1);\n    }\n    else{\n      $('#hdEnable').val(0);\n    }\n\n    // lat lng attributes are re-enabled for HD\n    $('#lat, #long').removeAttr('disabled');\n    $('#lat, #long').attr('readonly', true);\n  }\n  else {\n    if($(el).val() == \"airport\") {\n      $('#airportMobileDropdown').parent('.item_hd').removeClass('hide').addClass('show');\n      $('#mobileLocationSelect').removeClass('show').addClass('hide');\n      $('#hdlocation').removeClass('show').addClass('hide');\n    } else {\n      $('#airportMobileDropdown').parent('.item_hd').removeClass('show').addClass('hide');\n      $('#mobileLocationSelect').removeClass('hide').addClass('show');\n      $('#hdlocation').removeClass('show').addClass('hide');\n    }\n    //disable lat-lng if mobile mode\n    if (isMobile()){\n      $('#lat, #long').attr('disabled', true);\n      $('#lat, #long').attr('readonly', false);\n    }\n    $('#hdlocation').removeClass('show').addClass('hide');\n\n    $('#hdEnable').val(0);\n  }\n}\n\n// uses the ul li list in each search item to populate the locations modal for mweb\nvar renderLocationList = function(el) {\n  var locationList = $($(el).parents('.location_container').children('.dropdown-menu').clone());\n  locationList.removeClass('dropdown-menu').addClass('location_list');\n  locationList.find('li').addClass('location_item');\n  $('#newModalBodyRight .list_container').append(locationList);\n}\n\nvar removeSearchBar = function(page, title) {\n  if (page === 'homepage') {\n    $('.verticals_search #search_div').remove();\n    $('.verticals_search .search_box').remove();\n  }\n  else if (page === 'otherpage') {\n    $('.mobileModalTitle').text(title);\n    $('#SearchHDFormDiv .mobile_remove_widget, #SearchFormDiv .mobile_remove_widget').remove();\n  }\n}\n\nvar setMobileAppCookie = function() {\n  var cookieModule = new CookieModule();\n  cookieModule.setCookie('app_section_seen', 'seen');\n  $('.app_download_section').hide();\n  $('.verticals_search_wrapper').offset({'top': $('.mobile_header_container').height()})\n}\n"},707:function(t,e){t.exports='  if(isMobile()){\n    $( "#zoom_airport" ).remove();\n  }\n  else{\n    $( "#mobile_search_box" ).remove();\n  }\n  $(\'#ZoomAirportSearchForm\').on(\'submit\', function(e) {\n      e.preventDefault();\n      var cityName = $("#starts-form").val().toLowerCase();\n      AirportSearchNew(this, cityName);\n  });\n\n'},913:function(t,e,n){n(297),n(298),n(304),t.exports=n(303)}},[913]);